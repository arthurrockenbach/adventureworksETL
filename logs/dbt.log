2021-06-03 17:58:28.951846 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ACEF5C9C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ACEF61C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ACEF68148>]}
2021-06-03 17:58:42.534892 (MainThread): Partial parsing not enabled
2021-06-03 17:58:42.534892 (MainThread): Parsing macros\adapters.sql
2021-06-03 17:58:42.544959 (MainThread): Parsing macros\catalog.sql
2021-06-03 17:58:42.560640 (MainThread): Parsing macros\etc.sql
2021-06-03 17:58:42.560640 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 17:58:42.560640 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 17:58:42.576264 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 17:58:42.576264 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 17:58:42.576264 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 17:58:42.591883 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 17:58:42.591883 (MainThread): Parsing macros\core.sql
2021-06-03 17:58:42.591883 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 17:58:42.645310 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 17:58:42.645310 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 17:58:42.645310 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 17:58:42.645310 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 17:58:42.645310 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 17:58:42.645310 (MainThread): Parsing macros\etc\query.sql
2021-06-03 17:58:42.645310 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 17:58:42.661613 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 17:58:42.677314 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 17:58:42.677314 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 17:58:42.692865 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 17:58:42.708488 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 17:58:42.739790 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 17:58:42.745346 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 17:58:42.761026 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 17:58:42.761026 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 17:58:42.761026 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 17:58:42.776647 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 17:58:42.776647 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 17:58:42.776647 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 17:58:42.776647 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 17:58:42.776647 (MainThread): Partial parsing not enabled
2021-06-03 17:58:42.807895 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 17:58:42.807895 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 17:58:42.823522 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 17:58:42.823522 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 17:58:42.823522 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 17:58:42.823522 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 17:58:42.839148 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 17:58:42.839148 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 17:58:42.845721 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 17:58:42.847780 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 17:58:42.847780 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 17:58:42.857984 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 17:58:42.857984 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 17:58:42.857984 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 17:58:42.868115 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 17:58:42.868115 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 17:58:42.868115 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 17:58:42.878400 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 17:58:42.879450 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 17:58:42.879450 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 17:58:42.888606 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 17:58:42.888606 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 17:58:42.898801 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 17:58:43.060585 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3743ed52-36a6-424d-9209-0afc106c87d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD2B99048>]}
2021-06-03 17:58:43.068658 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3743ed52-36a6-424d-9209-0afc106c87d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ACEF16188>]}
2021-06-03 17:58:43.068658 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 17:58:43.075911 (MainThread): 
2021-06-03 17:58:43.076931 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 17:58:43.078894 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 17:58:43.078894 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 17:58:43.616313 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 17:58:43.617991 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 17:58:43.623327 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 17:58:44.722704 (MainThread): 14:58:44 | Concurrency: 1 threads (target='dev')
2021-06-03 17:58:44.722704 (MainThread): 14:58:44 | 
2021-06-03 17:58:44.733768 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 17:58:44.735025 (Thread-1): 14:58:44 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 17:58:44.735517 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 17:58:44.735517 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 17:58:44.738510 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 17:58:44.740503 (Thread-1): finished collecting timing info
2021-06-03 17:58:44.761480 (Thread-1): Opening a new connection, currently in state init
2021-06-03 17:58:44.768450 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 17:58:45.858551 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 17:58:45.874171 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select 
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct
            salesorderheadersalesreason.salesreasonid			
            ,salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select 
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from salesorderheadersalesreason
  );
    
2021-06-03 17:58:48.871870 (Thread-1): finished collecting timing info
2021-06-03 17:58:48.871870 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3743ed52-36a6-424d-9209-0afc106c87d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ACE7F7288>]}
2021-06-03 17:58:48.871870 (Thread-1): 14:58:48 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (27.6k rows, 432.0 KB processed) in 4.14s]
2021-06-03 17:58:48.871870 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 17:58:48.950405 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 17:58:48.950405 (MainThread): 14:58:48 | 
2021-06-03 17:58:48.951735 (MainThread): 14:58:48 | Finished running 1 table model in 5.87s.
2021-06-03 17:58:48.952736 (MainThread): Connection 'master' was properly closed.
2021-06-03 17:58:48.952736 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 17:58:48.952736 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 17:58:48.952736 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 17:58:48.965702 (MainThread): 
2021-06-03 17:58:48.965702 (MainThread): Completed successfully
2021-06-03 17:58:48.966770 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 17:58:48.967847 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ACEF370C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ACEF37748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ACEF37F08>]}
2021-06-03 17:58:48.968766 (MainThread): Flushing usage events
2021-06-03 17:59:06.299995 (MainThread): Running with dbt=0.19.1
2021-06-03 17:59:06.638521 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 17:59:06.638521 (MainThread): Tracking: tracking
2021-06-03 17:59:06.638521 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002706BC3F908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002706C391A48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002706C3918C8>]}
2021-06-03 17:59:06.648980 (MainThread): Partial parsing not enabled
2021-06-03 17:59:06.648980 (MainThread): Parsing macros\adapters.sql
2021-06-03 17:59:06.669758 (MainThread): Parsing macros\catalog.sql
2021-06-03 17:59:06.680145 (MainThread): Parsing macros\etc.sql
2021-06-03 17:59:06.680145 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 17:59:06.680145 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 17:59:06.698695 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 17:59:06.700905 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 17:59:06.700905 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 17:59:06.711368 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 17:59:06.711368 (MainThread): Parsing macros\core.sql
2021-06-03 17:59:06.721716 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 17:59:06.761141 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 17:59:06.763360 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 17:59:06.771594 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 17:59:06.773672 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 17:59:06.773814 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 17:59:06.773814 (MainThread): Parsing macros\etc\query.sql
2021-06-03 17:59:06.773814 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 17:59:06.784175 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 17:59:06.794612 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 17:59:06.802699 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 17:59:06.804830 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 17:59:06.825067 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 17:59:06.855409 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 17:59:06.865741 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 17:59:06.876152 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 17:59:06.886501 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 17:59:06.886501 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 17:59:06.897017 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 17:59:06.897017 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 17:59:06.897017 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 17:59:06.905168 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 17:59:06.907354 (MainThread): Partial parsing not enabled
2021-06-03 17:59:06.928105 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 17:59:06.938305 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 17:59:06.948519 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 17:59:06.948519 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 17:59:06.956640 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 17:59:06.958737 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 17:59:06.958737 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 17:59:06.968930 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 17:59:06.968930 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 17:59:06.977047 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 17:59:06.979140 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 17:59:06.979140 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 17:59:06.987274 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 17:59:06.989375 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 17:59:06.989375 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 17:59:06.999574 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 17:59:06.999574 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 17:59:07.007731 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 17:59:07.009824 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 17:59:07.009824 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 17:59:07.020048 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 17:59:07.020048 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 17:59:07.030283 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 17:59:07.212856 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3622cfd8-7120-4b63-b440-e3ae7893560e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002706FFC5E48>]}
2021-06-03 17:59:07.223043 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3622cfd8-7120-4b63-b440-e3ae7893560e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002706FFA8108>]}
2021-06-03 17:59:07.223043 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 17:59:07.230994 (MainThread): 
2021-06-03 17:59:07.230994 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 17:59:07.233983 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 17:59:07.234980 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 17:59:08.352342 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 17:59:08.352838 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 17:59:08.359825 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 17:59:09.435557 (MainThread): 14:59:09 | Concurrency: 1 threads (target='dev')
2021-06-03 17:59:09.435557 (MainThread): 14:59:09 | 
2021-06-03 17:59:09.448539 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 17:59:09.448539 (Thread-1): 14:59:09 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 17:59:09.450528 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 17:59:09.450528 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 17:59:09.455508 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 17:59:09.456547 (Thread-1): finished collecting timing info
2021-06-03 17:59:09.480588 (Thread-1): Opening a new connection, currently in state init
2021-06-03 17:59:09.485516 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 17:59:10.590883 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 17:59:10.590883 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct
            salesorderheadersalesreason.salesreasonid			
            ,salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select 
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from salesorderheadersalesreason
  );
    
2021-06-03 17:59:13.852922 (Thread-1): finished collecting timing info
2021-06-03 17:59:13.852922 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3622cfd8-7120-4b63-b440-e3ae7893560e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002706C350FC8>]}
2021-06-03 17:59:13.852922 (Thread-1): 14:59:13 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (27.6k rows, 432.0 KB processed) in 4.40s]
2021-06-03 17:59:13.852922 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 17:59:13.963931 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 17:59:13.963931 (MainThread): 14:59:13 | 
2021-06-03 17:59:13.964909 (MainThread): 14:59:13 | Finished running 1 table model in 6.73s.
2021-06-03 17:59:13.965909 (MainThread): Connection 'master' was properly closed.
2021-06-03 17:59:13.965909 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 17:59:13.965909 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 17:59:13.966903 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 17:59:13.974880 (MainThread): 
2021-06-03 17:59:13.975366 (MainThread): Completed successfully
2021-06-03 17:59:13.976207 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 17:59:13.977227 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002706FE461C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002706FE46988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002706DDC59C8>]}
2021-06-03 17:59:13.978203 (MainThread): Flushing usage events
2021-06-03 18:06:34.907346 (MainThread): Running with dbt=0.19.1
2021-06-03 18:06:35.252018 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:06:35.252018 (MainThread): Tracking: tracking
2021-06-03 18:06:35.252018 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E04863CDC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E048643B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0486480C8>]}
2021-06-03 18:06:35.262145 (MainThread): Partial parsing not enabled
2021-06-03 18:06:35.262145 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:06:35.282487 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:06:35.292843 (MainThread): Parsing macros\etc.sql
2021-06-03 18:06:35.292843 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:06:35.303004 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:06:35.313099 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:06:35.317926 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:06:35.317926 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:06:35.323004 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:06:35.333073 (MainThread): Parsing macros\core.sql
2021-06-03 18:06:35.333073 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:06:35.379361 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:06:35.384251 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:06:35.384251 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:06:35.392337 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:06:35.394428 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:06:35.394428 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:06:35.394428 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:06:35.404637 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:06:35.414811 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:06:35.422923 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:06:35.424998 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:06:35.445259 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:06:35.475782 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:06:35.483843 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:06:35.496049 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:06:35.506264 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:06:35.514369 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:06:35.516491 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:06:35.524579 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:06:35.524579 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:06:35.526660 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:06:35.526660 (MainThread): Partial parsing not enabled
2021-06-03 18:06:35.555217 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:06:35.567452 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:06:35.567452 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:06:35.575554 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:06:35.577643 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:06:35.577643 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:06:35.587792 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:06:35.587792 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:06:35.597915 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:06:35.597915 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:06:35.605948 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:06:35.607974 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:06:35.607974 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:06:35.616209 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:06:35.618222 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:06:35.618222 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:06:35.628399 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:06:35.628399 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:06:35.628399 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:06:35.639756 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:06:35.643254 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:06:35.646908 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:06:35.657104 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:06:35.842552 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8feed01d-fb60-452a-a2a9-64b36fab89a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E04865FE08>]}
2021-06-03 18:06:35.852648 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8feed01d-fb60-452a-a2a9-64b36fab89a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0485F6A08>]}
2021-06-03 18:06:35.852648 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:06:35.862758 (MainThread): 
2021-06-03 18:06:35.863750 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:06:35.865740 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:06:35.866567 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:06:37.101539 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:06:37.101539 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:06:37.107576 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:06:37.618991 (MainThread): 15:06:37 | Concurrency: 1 threads (target='dev')
2021-06-03 18:06:37.618991 (MainThread): 15:06:37 | 
2021-06-03 18:06:37.630485 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 18:06:37.631482 (Thread-1): 15:06:37 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 18:06:37.633476 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:06:37.633476 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 18:06:37.635469 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:06:37.636464 (Thread-1): finished collecting timing info
2021-06-03 18:06:37.657216 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:06:37.662244 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:06:38.814264 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:06:38.814264 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct
            salesorderheadersalesreason.salesreasonid			
            ,salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select 
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
  );
    
2021-06-03 18:06:42.607746 (Thread-1): finished collecting timing info
2021-06-03 18:06:42.607746 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8feed01d-fb60-452a-a2a9-64b36fab89a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E048620208>]}
2021-06-03 18:06:42.607746 (Thread-1): 15:06:42 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (27.6k rows, 432.7 KB processed) in 4.98s]
2021-06-03 18:06:42.607746 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 18:06:42.624597 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:06:42.624597 (MainThread): 15:06:42 | 
2021-06-03 18:06:42.625607 (MainThread): 15:06:42 | Finished running 1 table model in 6.76s.
2021-06-03 18:06:42.626549 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:06:42.626549 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:06:42.626549 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:06:42.626549 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 18:06:42.637509 (MainThread): 
2021-06-03 18:06:42.638505 (MainThread): Completed successfully
2021-06-03 18:06:42.638882 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:06:42.639882 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E04A46CA48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E04C0CA0C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E048672A08>]}
2021-06-03 18:06:42.639882 (MainThread): Flushing usage events
2021-06-03 18:10:39.379254 (MainThread): Running with dbt=0.19.1
2021-06-03 18:10:39.703337 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:10:39.703337 (MainThread): Tracking: tracking
2021-06-03 18:10:39.703337 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF6500888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF6500A88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF6508508>]}
2021-06-03 18:10:39.713582 (MainThread): Partial parsing not enabled
2021-06-03 18:10:39.713582 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:10:39.734033 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:10:39.734033 (MainThread): Parsing macros\etc.sql
2021-06-03 18:10:39.742163 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:10:39.744292 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:10:39.754561 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:10:39.754561 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:10:39.762677 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:10:39.772957 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:10:39.775064 (MainThread): Parsing macros\core.sql
2021-06-03 18:10:39.775064 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:10:39.816305 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:10:39.826562 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:10:39.826562 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:10:39.834940 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:10:39.836687 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:10:39.836687 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:10:39.836687 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:10:39.846965 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:10:39.857244 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:10:39.857244 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:10:39.867466 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:10:39.888039 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:10:39.918707 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:10:39.918707 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:10:39.939223 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:10:39.947362 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:10:39.949477 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:10:39.957615 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:10:39.959732 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:10:39.959732 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:10:39.959732 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:10:39.969991 (MainThread): Partial parsing not enabled
2021-06-03 18:10:39.990564 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:10:40.000856 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:10:40.000856 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:10:40.011074 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:10:40.011074 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:10:40.019110 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:10:40.021245 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:10:40.029368 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:10:40.031459 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:10:40.031459 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:10:40.041870 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:10:40.041870 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:10:40.049895 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:10:40.051979 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:10:40.051979 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:10:40.060008 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:10:40.062087 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:10:40.062087 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:10:40.072285 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:10:40.072285 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:10:40.080378 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:10:40.082488 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:10:40.092689 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:10:40.274916 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '300fe9d7-abc0-47de-b965-a595c86b384d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF6530708>]}
2021-06-03 18:10:40.277020 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '300fe9d7-abc0-47de-b965-a595c86b384d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AFA164908>]}
2021-06-03 18:10:40.277020 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:10:40.292540 (MainThread): 
2021-06-03 18:10:40.293533 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:10:40.296531 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:10:40.296531 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:10:41.835512 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:10:41.836010 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:10:41.842111 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:10:42.934251 (MainThread): 15:10:42 | Concurrency: 1 threads (target='dev')
2021-06-03 18:10:42.934251 (MainThread): 15:10:42 | 
2021-06-03 18:10:42.952014 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 18:10:42.953011 (Thread-1): 15:10:42 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 18:10:42.954007 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:10:42.955025 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 18:10:42.958049 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:10:42.960004 (Thread-1): finished collecting timing info
2021-06-03 18:10:42.989931 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:10:42.995878 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:10:44.105541 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:10:44.105541 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct
            salesorderheadersalesreason.salesreasonid			
            ,salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select 
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
where salereason = 'Price' or 'Promotion'
  );
    
2021-06-03 18:10:44.922198 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/adventureworks-314121/queries/afaa4b22-612d-410c-8f98-ca64e232a992?maxResults=0&location=US&prettyPrint=false: No matching signature for operator OR for argument types: BOOL, STRING. Supported signature: BOOL OR ([BOOL, ...]) at [39:7]')
2021-06-03 18:10:46.790819 (Thread-1): finished collecting timing info
2021-06-03 18:10:46.790819 (Thread-1): Database Error in model dim_salesreason (models\marts\dim_salesreason.sql)
  No matching signature for operator OR for argument types: BOOL, STRING. Supported signature: BOOL OR ([BOOL, ...]) at [39:7]
  compiled SQL at target\run\adventureworks\models\marts\dim_salesreason.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/adventureworks-314121/queries/cfbeb904-9df5-408d-b73b-52a5c218e14a?maxResults=0&location=US&prettyPrint=false: No matching signature for operator OR for argument types: BOOL, STRING. Supported signature: BOOL OR ([BOOL, ...]) at [39:7]

(job ID: cfbeb904-9df5-408d-b73b-52a5c218e14a)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */
   2:
   3:
   4:  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with 
  10:    sourcesalesreason as (
  11:        select 
  12:         salesreasonid 
  13:         ,salereason
  14:        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
  15:    )
  16:    , salesorderheadersalesreason as (
  17:        select distinct
  18:            salesorderid
  19:            ,salesreasonid
  20:    
  21:        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
  22:    )   
  23:    , selected as (
  24:        select distinct
  25:            salesorderheadersalesreason.salesreasonid			
  26:            ,salesorderheadersalesreason.salesorderid
  27:            ,sourcesalesreason.salereason			
  28:          
  29:        from salesorderheadersalesreason
  30:        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
  31:    )
  32:    , transformedsalesreason as (
  33:        select 
  34:        row_number() over(order by salesreasonid) as salesreason_sk
  35:        , * 
  36:        from selected
  37:    )
  38:select distinct * from transformedsalesreason
  39:where salereason = 'Price' or 'Promotion'
  40:  );
  41:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_salesreason (models\marts\dim_salesreason.sql)
  No matching signature for operator OR for argument types: BOOL, STRING. Supported signature: BOOL OR ([BOOL, ...]) at [39:7]
  compiled SQL at target\run\adventureworks\models\marts\dim_salesreason.sql
2021-06-03 18:10:46.809620 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '300fe9d7-abc0-47de-b965-a595c86b384d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF6546748>]}
2021-06-03 18:10:46.809620 (Thread-1): 15:10:46 | 1 of 1 ERROR creating table model dbt_arthur.dim_salesreason......... [ERROR in 3.86s]
2021-06-03 18:10:46.809620 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 18:10:46.821180 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:10:46.822249 (MainThread): 15:10:46 | 
2021-06-03 18:10:46.823244 (MainThread): 15:10:46 | Finished running 1 table model in 6.53s.
2021-06-03 18:10:46.823940 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:10:46.823940 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:10:46.823940 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:10:46.823940 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 18:10:46.834623 (MainThread): 
2021-06-03 18:10:46.835619 (MainThread): Completed with 1 error and 0 warnings:
2021-06-03 18:10:46.836613 (MainThread): 
2021-06-03 18:10:46.837611 (MainThread): Database Error in model dim_salesreason (models\marts\dim_salesreason.sql)
2021-06-03 18:10:46.838608 (MainThread):   No matching signature for operator OR for argument types: BOOL, STRING. Supported signature: BOOL OR ([BOOL, ...]) at [39:7]
2021-06-03 18:10:46.839615 (MainThread):   compiled SQL at target\run\adventureworks\models\marts\dim_salesreason.sql
2021-06-03 18:10:46.840601 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-06-03 18:10:46.841599 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AFA0F3F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AFA0F3948>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AFA0F3508>]}
2021-06-03 18:10:46.841599 (MainThread): Flushing usage events
2021-06-03 18:11:08.392671 (MainThread): Running with dbt=0.19.1
2021-06-03 18:11:08.715470 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:11:08.716618 (MainThread): Tracking: tracking
2021-06-03 18:11:08.716717 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F2ADFF88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F2B00CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F2B08148>]}
2021-06-03 18:11:08.725074 (MainThread): Partial parsing not enabled
2021-06-03 18:11:08.725074 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:11:08.737727 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:11:08.748258 (MainThread): Parsing macros\etc.sql
2021-06-03 18:11:08.748258 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:11:08.756330 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:11:08.766713 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:11:08.768989 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:11:08.768989 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:11:08.779247 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:11:08.779247 (MainThread): Parsing macros\core.sql
2021-06-03 18:11:08.789782 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:11:08.829273 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:11:08.831588 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:11:08.831588 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:11:08.839657 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:11:08.841917 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:11:08.841917 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:11:08.841917 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:11:08.852519 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:11:08.862885 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:11:08.862885 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:11:08.873484 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:11:08.892070 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:11:08.923300 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:11:08.925536 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:11:08.936009 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:11:08.946105 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:11:08.954199 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:11:08.956565 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:11:08.956565 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:11:08.956565 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:11:08.966406 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:11:08.974309 (MainThread): Partial parsing not enabled
2021-06-03 18:11:08.995851 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:11:09.006223 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:11:09.008340 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:11:09.008340 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:11:09.018660 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:11:09.018660 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:11:09.028875 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:11:09.028875 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:11:09.036983 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:11:09.039067 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:11:09.039067 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:11:09.047215 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:11:09.049294 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:11:09.049294 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:11:09.059471 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:11:09.059471 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:11:09.069619 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:11:09.069619 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:11:09.077729 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:11:09.079824 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:11:09.079824 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:11:09.090068 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:11:09.100268 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:11:09.263397 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd58dfcc3-f875-45ea-a9bd-ed965d44eb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F2B3B4C8>]}
2021-06-03 18:11:09.273562 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd58dfcc3-f875-45ea-a9bd-ed965d44eb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F2AB6248>]}
2021-06-03 18:11:09.273562 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:11:09.285394 (MainThread): 
2021-06-03 18:11:09.286394 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:11:09.288389 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:11:09.288389 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:11:10.405397 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:11:10.405893 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:11:10.412163 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:11:10.954368 (MainThread): 15:11:10 | Concurrency: 1 threads (target='dev')
2021-06-03 18:11:10.954368 (MainThread): 15:11:10 | 
2021-06-03 18:11:10.962496 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 18:11:10.962496 (Thread-1): 15:11:10 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 18:11:10.964435 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:11:10.964435 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 18:11:10.970415 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:11:10.971472 (Thread-1): finished collecting timing info
2021-06-03 18:11:10.992391 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:11:10.997363 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:11:12.120873 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:11:12.120873 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct
            salesorderheadersalesreason.salesreasonid			
            ,salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select 
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
where salereason = 'Price' or salereason = 'Promotion'
  );
    
2021-06-03 18:11:15.712870 (Thread-1): finished collecting timing info
2021-06-03 18:11:15.712870 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd58dfcc3-f875-45ea-a9bd-ed965d44eb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F657F388>]}
2021-06-03 18:11:15.712870 (Thread-1): 15:11:15 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (17.5k rows, 432.7 KB processed) in 4.75s]
2021-06-03 18:11:15.712870 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 18:11:15.753523 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:11:15.753523 (MainThread): 15:11:15 | 
2021-06-03 18:11:15.754530 (MainThread): 15:11:15 | Finished running 1 table model in 6.47s.
2021-06-03 18:11:15.755520 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:11:15.755520 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:11:15.755520 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:11:15.755520 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 18:11:15.764491 (MainThread): 
2021-06-03 18:11:15.765489 (MainThread): Completed successfully
2021-06-03 18:11:15.766694 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:11:15.767706 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3EFCE7308>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F6639108>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3F66390C8>]}
2021-06-03 18:11:15.768696 (MainThread): Flushing usage events
2021-06-03 18:12:20.571343 (MainThread): Running with dbt=0.19.1
2021-06-03 18:12:20.918880 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:12:20.918880 (MainThread): Tracking: tracking
2021-06-03 18:12:20.918880 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C9F8147C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C9F8149C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C9F817488>]}
2021-06-03 18:12:20.928968 (MainThread): Partial parsing not enabled
2021-06-03 18:12:20.937039 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:12:20.957300 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:12:20.959361 (MainThread): Parsing macros\etc.sql
2021-06-03 18:12:20.959361 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:12:20.969548 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:12:20.979671 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:12:20.979671 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:12:20.979671 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:12:20.989863 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:12:21.000051 (MainThread): Parsing macros\core.sql
2021-06-03 18:12:21.000051 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:12:21.041198 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:12:21.056799 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:12:21.057802 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:12:21.059791 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:12:21.061784 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:12:21.063778 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:12:21.064773 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:12:21.072283 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:12:21.086068 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:12:21.090815 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:12:21.093021 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:12:21.113834 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:12:21.144945 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:12:21.144945 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:12:21.165814 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:12:21.174051 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:12:21.176253 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:12:21.184432 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:12:21.186679 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:12:21.186679 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:12:21.186679 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:12:21.197121 (MainThread): Partial parsing not enabled
2021-06-03 18:12:21.217857 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:12:21.228246 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:12:21.228246 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:12:21.238706 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:12:21.238706 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:12:21.238706 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:12:21.248937 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:12:21.257184 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:12:21.259417 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:12:21.259417 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:12:21.269847 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:12:21.269847 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:12:21.278131 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:12:21.280338 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:12:21.280338 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:12:21.288526 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:12:21.290714 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:12:21.290714 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:12:21.301164 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:12:21.301164 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:12:21.309359 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:12:21.311559 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:12:21.321986 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:12:21.494548 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c97cb1d7-a2e2-4554-83e0-48dd8e8850d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C9F83A288>]}
2021-06-03 18:12:21.506821 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c97cb1d7-a2e2-4554-83e0-48dd8e8850d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA3427088>]}
2021-06-03 18:12:21.506821 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:12:21.516259 (MainThread): 
2021-06-03 18:12:21.517262 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:12:21.519253 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:12:21.520247 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:12:22.702814 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:12:22.703310 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:12:22.709735 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:12:23.788480 (MainThread): 15:12:23 | Concurrency: 1 threads (target='dev')
2021-06-03 18:12:23.788480 (MainThread): 15:12:23 | 
2021-06-03 18:12:23.797645 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 18:12:23.798683 (Thread-1): 15:12:23 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 18:12:23.799652 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:12:23.800632 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 18:12:23.803710 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:12:23.805719 (Thread-1): finished collecting timing info
2021-06-03 18:12:23.824652 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:12:23.831630 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:12:24.938023 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:12:24.938023 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct
            salesorderheadersalesreason.salesreasonid			
            ,salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select 
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
where count(salesorderid) = 1
  );
    
2021-06-03 18:12:25.940663 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/adventureworks-314121/queries/d1a2944f-89e0-4da1-9bbe-e41acb3bf7e8?maxResults=0&location=US&prettyPrint=false: Aggregate function COUNT not allowed in WHERE clause at [39:7]')
2021-06-03 18:12:27.766273 (Thread-1): finished collecting timing info
2021-06-03 18:12:27.766273 (Thread-1): Database Error in model dim_salesreason (models\marts\dim_salesreason.sql)
  Aggregate function COUNT not allowed in WHERE clause at [39:7]
  compiled SQL at target\run\adventureworks\models\marts\dim_salesreason.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/adventureworks-314121/queries/a5b3881f-8188-41ac-8478-2b3d884a5d87?maxResults=0&location=US&prettyPrint=false: Aggregate function COUNT not allowed in WHERE clause at [39:7]

(job ID: a5b3881f-8188-41ac-8478-2b3d884a5d87)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */
   2:
   3:
   4:  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with 
  10:    sourcesalesreason as (
  11:        select 
  12:         salesreasonid 
  13:         ,salereason
  14:        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
  15:    )
  16:    , salesorderheadersalesreason as (
  17:        select distinct
  18:            salesorderid
  19:            ,salesreasonid
  20:    
  21:        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
  22:    )   
  23:    , selected as (
  24:        select distinct
  25:            salesorderheadersalesreason.salesreasonid			
  26:            ,salesorderheadersalesreason.salesorderid
  27:            ,sourcesalesreason.salereason			
  28:          
  29:        from salesorderheadersalesreason
  30:        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
  31:    )
  32:    , transformedsalesreason as (
  33:        select 
  34:        row_number() over(order by salesreasonid) as salesreason_sk
  35:        , * 
  36:        from selected
  37:    )
  38:select distinct * from transformedsalesreason
  39:where count(salesorderid) = 1
  40:  );
  41:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_salesreason (models\marts\dim_salesreason.sql)
  Aggregate function COUNT not allowed in WHERE clause at [39:7]
  compiled SQL at target\run\adventureworks\models\marts\dim_salesreason.sql
2021-06-03 18:12:27.781910 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c97cb1d7-a2e2-4554-83e0-48dd8e8850d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA3418748>]}
2021-06-03 18:12:27.781910 (Thread-1): 15:12:27 | 1 of 1 ERROR creating table model dbt_arthur.dim_salesreason......... [ERROR in 3.98s]
2021-06-03 18:12:27.791876 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 18:12:27.797560 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:12:27.797560 (MainThread): 15:12:27 | 
2021-06-03 18:12:27.799565 (MainThread): 15:12:27 | Finished running 1 table model in 6.28s.
2021-06-03 18:12:27.799565 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:12:27.800562 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:12:27.800562 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:12:27.800562 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 18:12:27.807539 (MainThread): 
2021-06-03 18:12:27.808544 (MainThread): Completed with 1 error and 0 warnings:
2021-06-03 18:12:27.809541 (MainThread): 
2021-06-03 18:12:27.810580 (MainThread): Database Error in model dim_salesreason (models\marts\dim_salesreason.sql)
2021-06-03 18:12:27.812522 (MainThread):   Aggregate function COUNT not allowed in WHERE clause at [39:7]
2021-06-03 18:12:27.814577 (MainThread):   compiled SQL at target\run\adventureworks\models\marts\dim_salesreason.sql
2021-06-03 18:12:27.814577 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-06-03 18:12:27.815560 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C9F7E0248>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C9F7E0B08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C9F7E05C8>]}
2021-06-03 18:12:27.816926 (MainThread): Flushing usage events
2021-06-03 18:14:47.979083 (MainThread): Running with dbt=0.19.1
2021-06-03 18:14:48.345273 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_sales_order'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:14:48.345273 (MainThread): Tracking: tracking
2021-06-03 18:14:48.345273 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002670CBF3848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002670CBEADC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002670CBF7A08>]}
2021-06-03 18:14:48.355323 (MainThread): Partial parsing not enabled
2021-06-03 18:14:48.355323 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:14:48.375465 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:14:48.383491 (MainThread): Parsing macros\etc.sql
2021-06-03 18:14:48.385560 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:14:48.385560 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:14:48.405784 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:14:48.405784 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:14:48.405784 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:14:48.415843 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:14:48.425931 (MainThread): Parsing macros\core.sql
2021-06-03 18:14:48.425931 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:14:48.466297 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:14:48.476529 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:14:48.476529 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:14:48.476529 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:14:48.484586 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:14:48.486666 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:14:48.486666 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:14:48.496846 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:14:48.506957 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:14:48.506957 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:14:48.517142 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:14:48.542060 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:14:48.568458 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:14:48.576657 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:14:48.597116 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:14:48.599182 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:14:48.609348 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:14:48.609348 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:14:48.617438 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:14:48.619508 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:14:48.619508 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:14:48.629997 (MainThread): Partial parsing not enabled
2021-06-03 18:14:48.650602 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:14:48.660870 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:14:48.660870 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:14:48.669029 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:14:48.671163 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:14:48.671163 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:14:48.681414 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:14:48.681414 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:14:48.689553 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:14:48.691656 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:14:48.691656 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:14:48.701908 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:14:48.701908 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:14:48.701908 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:14:48.712187 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:14:48.720329 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:14:48.727071 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:14:48.732038 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:14:48.736029 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:14:48.741013 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:14:48.745985 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:14:48.750979 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:14:48.763930 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:14:48.937756 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd700bce-9f98-4ae3-84c3-7fbe86c88eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002670CC124C8>]}
2021-06-03 18:14:48.947958 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd700bce-9f98-4ae3-84c3-7fbe86c88eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026710883448>]}
2021-06-03 18:14:48.947958 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:14:48.954016 (MainThread): 
2021-06-03 18:14:48.954960 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:14:48.956957 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:14:48.956957 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:14:50.100411 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:14:50.100905 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:14:50.107527 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:14:51.243068 (MainThread): 15:14:51 | Concurrency: 1 threads (target='dev')
2021-06-03 18:14:51.243068 (MainThread): 15:14:51 | 
2021-06-03 18:14:51.258884 (Thread-1): Began running node model.adventureworks.fact_sales_order
2021-06-03 18:14:51.259880 (Thread-1): 15:14:51 | 1 of 1 START table model dbt_arthur.fact_sales_order................. [RUN]
2021-06-03 18:14:51.260839 (Thread-1): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:14:51.260839 (Thread-1): Compiling model.adventureworks.fact_sales_order
2021-06-03 18:14:51.267814 (Thread-1): Writing injected SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:14:51.268810 (Thread-1): finished collecting timing info
2021-06-03 18:14:51.291785 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:14:51.295770 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:14:52.434565 (Thread-1): Writing runtime SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:14:52.434565 (Thread-1): On model.adventureworks.fact_sales_order: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.fact_sales_order"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
  
  
  OPTIONS()
  as (
    with 
    salesreason as ( 
        select distinct * from  `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    )
    ,creditcard as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    )
    ,customers as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    )
    , localization as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    )
    , products as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    )
    , sales_orders_sk as (
          select 
            orderheader.salesorderid  
            ,customers.customer_sk as customer_fk		
            ,creditcard.creditcard_sk as creditcard_fk
            ,localization.address_sk as address_fk
            ,orderheader.status	
            ,orderheader.totaldue
            ,orderheader.orderdate						
          from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheader` as orderheader
          left join localization on orderheader.addressid = localization.addressid
          left join customers on orderheader.customerid = customers.customerid
          left join creditcard on orderheader.creditcardid = creditcard.creditcardid

    )
    , sales_orders_details_sk as (
        select 
         orderdetail.salesorderdetailid
         ,orderdetail.salesorderid
         ,products.product_sk as product_fk
         ,orderdetail.specialofferid
         ,orderdetail.orderqty			
         ,orderdetail.unitprice			
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderdetail` as orderdetail
        left join products on orderdetail.productid = products.productid
    )
    , final as (
        select 
            sales_orders_sk.salesorderid 
            ,sales_orders_sk.customer_fk
            ,sales_orders_sk.creditcard_fk
            ,sales_orders_details_sk.product_fk
            ,sales_orders_sk.address_fk
            ,sales_orders_sk.status	
            ,sales_orders_sk.orderdate						
            ,sales_orders_details_sk.orderqty			
            ,sales_orders_details_sk.unitprice
						
        from sales_orders_sk 
        left join sales_orders_details_sk on sales_orders_sk.salesorderid = sales_orders_details_sk.salesorderid
        left join salesreason on sales_orders_sk.salesorderid = salesreason.salesorderid		
    )

select  distinct * from final
  );
    
2021-06-03 18:14:57.304596 (Thread-1): finished collecting timing info
2021-06-03 18:14:57.304596 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd700bce-9f98-4ae3-84c3-7fbe86c88eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002670EBA9308>]}
2021-06-03 18:14:57.304596 (Thread-1): 15:14:57 | 1 of 1 OK created table model dbt_arthur.fact_sales_order............ [CREATE TABLE (121.3k rows, 7.5 MB processed) in 6.04s]
2021-06-03 18:14:57.313131 (Thread-1): Finished running node model.adventureworks.fact_sales_order
2021-06-03 18:14:57.377170 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:14:57.378173 (MainThread): 15:14:57 | 
2021-06-03 18:14:57.379163 (MainThread): 15:14:57 | Finished running 1 table model in 8.42s.
2021-06-03 18:14:57.380158 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:14:57.380158 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:14:57.380158 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:14:57.380158 (MainThread): Connection 'model.adventureworks.fact_sales_order' was properly closed.
2021-06-03 18:14:57.391129 (MainThread): 
2021-06-03 18:14:57.392180 (MainThread): Completed successfully
2021-06-03 18:14:57.394113 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:14:57.395109 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026710681B08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002671070DA08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002671070DD48>]}
2021-06-03 18:14:57.395109 (MainThread): Flushing usage events
2021-06-03 18:15:59.732960 (MainThread): Running with dbt=0.19.1
2021-06-03 18:16:00.068726 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_sales_order'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:16:00.068726 (MainThread): Tracking: tracking
2021-06-03 18:16:00.068726 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BD1A3E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BD1A3A88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BD1A41C8>]}
2021-06-03 18:16:00.079317 (MainThread): Partial parsing not enabled
2021-06-03 18:16:00.079317 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:16:00.099780 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:16:00.110045 (MainThread): Parsing macros\etc.sql
2021-06-03 18:16:00.110045 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:16:00.120110 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:16:00.137494 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:16:00.138532 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:16:00.138532 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:16:00.150958 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:16:00.159040 (MainThread): Parsing macros\core.sql
2021-06-03 18:16:00.159040 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:16:00.201639 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:16:00.211902 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:16:00.211902 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:16:00.211902 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:16:00.211902 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:16:00.211902 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:16:00.220017 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:16:00.222115 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:16:00.242570 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:16:00.242570 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:16:00.250697 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:16:00.271117 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:16:00.304038 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:16:00.314352 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:16:00.324483 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:16:00.337714 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:16:00.344800 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:16:00.344800 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:16:00.352876 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:16:00.354924 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:16:00.354924 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:16:00.362962 (MainThread): Partial parsing not enabled
2021-06-03 18:16:00.385209 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:16:00.395427 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:16:00.395427 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:16:00.405902 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:16:00.405902 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:16:00.405902 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:16:00.416441 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:16:00.424683 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:16:00.426886 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:16:00.426886 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:16:00.437258 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:16:00.437258 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:16:00.437258 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:16:00.447709 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:16:00.447709 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:16:00.456492 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:16:00.460546 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:16:00.465513 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:16:00.469507 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:16:00.474494 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:16:00.479498 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:16:00.481734 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:16:00.489172 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:16:00.674595 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2557ae6-cc3c-4ce4-b8fe-7f68ba7b18fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BCE37608>]}
2021-06-03 18:16:00.684731 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2557ae6-cc3c-4ce4-b8fe-7f68ba7b18fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145C0E7D108>]}
2021-06-03 18:16:00.684731 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:16:00.695902 (MainThread): 
2021-06-03 18:16:00.696927 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:16:00.699866 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:16:00.699866 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:16:01.874478 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:16:01.874478 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:16:01.882936 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:16:02.961164 (MainThread): 15:16:02 | Concurrency: 1 threads (target='dev')
2021-06-03 18:16:02.961164 (MainThread): 15:16:02 | 
2021-06-03 18:16:02.979880 (Thread-1): Began running node model.adventureworks.fact_sales_order
2021-06-03 18:16:02.979880 (Thread-1): 15:16:02 | 1 of 1 START table model dbt_arthur.fact_sales_order................. [RUN]
2021-06-03 18:16:02.981876 (Thread-1): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:16:02.981876 (Thread-1): Compiling model.adventureworks.fact_sales_order
2021-06-03 18:16:02.987899 (Thread-1): Writing injected SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:16:02.988848 (Thread-1): finished collecting timing info
2021-06-03 18:16:03.009823 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:16:03.016765 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:16:04.132927 (Thread-1): Writing runtime SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:16:04.132927 (Thread-1): On model.adventureworks.fact_sales_order: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.fact_sales_order"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
  
  
  OPTIONS()
  as (
    with 
    salesreason as ( 
        select distinct * from  `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    )
    ,creditcard as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    )
    ,customers as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    )
    , localization as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    )
    , products as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    )
    , sales_orders_sk as (
          select 
            orderheader.salesorderid  
            ,customers.customer_sk as customer_fk		
            ,creditcard.creditcard_sk as creditcard_fk
            ,localization.address_sk as address_fk
            ,orderheader.status	
            ,orderheader.totaldue
            ,orderheader.orderdate						
          from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheader` as orderheader
          left join localization on orderheader.addressid = localization.addressid
          left join customers on orderheader.customerid = customers.customerid
          left join creditcard on orderheader.creditcardid = creditcard.creditcardid

    )
    , sales_orders_details_sk as (
        select 
         orderdetail.salesorderdetailid
         ,orderdetail.salesorderid
         ,products.product_sk as product_fk
         ,orderdetail.specialofferid
         ,orderdetail.orderqty			
         ,orderdetail.unitprice			
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderdetail` as orderdetail
        left join products on orderdetail.productid = products.productid
    )
    , final as (
        select 
            sales_orders_sk.salesorderid 
            ,sales_orders_sk.customer_fk
            ,sales_orders_sk.creditcard_fk
            ,sales_orders_details_sk.product_fk
            ,sales_orders_sk.address_fk
            ,sales_orders_sk.status	
            ,sales_orders_sk.orderdate						
            ,sales_orders_details_sk.orderqty			
            ,sales_orders_details_sk.unitprice
            ,salesreason.salesreason_sk as salesreason_fk
						
        from sales_orders_sk 
        left join sales_orders_details_sk on sales_orders_sk.salesorderid = sales_orders_details_sk.salesorderid
        left join salesreason on sales_orders_sk.salesorderid = salesreason.salesorderid		
    )

select  distinct * from final
  );
    
2021-06-03 18:16:09.692166 (Thread-1): finished collecting timing info
2021-06-03 18:16:09.692166 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2557ae6-cc3c-4ce4-b8fe-7f68ba7b18fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BD1B88C8>]}
2021-06-03 18:16:09.692166 (Thread-1): 15:16:09 | 1 of 1 OK created table model dbt_arthur.fact_sales_order............ [CREATE TABLE (121.3k rows, 7.5 MB processed) in 6.71s]
2021-06-03 18:16:09.706712 (Thread-1): Finished running node model.adventureworks.fact_sales_order
2021-06-03 18:16:09.786416 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:16:09.786416 (MainThread): 15:16:09 | 
2021-06-03 18:16:09.787786 (MainThread): 15:16:09 | Finished running 1 table model in 9.09s.
2021-06-03 18:16:09.788787 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:16:09.788787 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:16:09.788787 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:16:09.788787 (MainThread): Connection 'model.adventureworks.fact_sales_order' was properly closed.
2021-06-03 18:16:09.797801 (MainThread): 
2021-06-03 18:16:09.799077 (MainThread): Completed successfully
2021-06-03 18:16:09.800076 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:16:09.801342 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BD154EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BD19D9C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145C0C2FE88>]}
2021-06-03 18:16:09.801342 (MainThread): Flushing usage events
2021-06-03 18:22:06.865577 (MainThread): Running with dbt=0.19.1
2021-06-03 18:22:07.230996 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:22:07.230996 (MainThread): Tracking: tracking
2021-06-03 18:22:07.230996 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263BC81AC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263BC7CA08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263BC6A948>]}
2021-06-03 18:22:07.241188 (MainThread): Partial parsing not enabled
2021-06-03 18:22:07.241188 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:22:07.261527 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:22:07.261527 (MainThread): Parsing macros\etc.sql
2021-06-03 18:22:07.269557 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:22:07.271635 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:22:07.281835 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:22:07.281835 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:22:07.289943 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:22:07.300123 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:22:07.302221 (MainThread): Parsing macros\core.sql
2021-06-03 18:22:07.302221 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:22:07.343107 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:22:07.353304 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:22:07.353304 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:22:07.361379 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:22:07.363456 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:22:07.363456 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:22:07.363456 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:22:07.373549 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:22:07.383722 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:22:07.391807 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:22:07.393896 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:22:07.414299 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:22:07.453404 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:22:07.455815 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:22:07.466031 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:22:07.476305 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:22:07.484548 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:22:07.486758 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:22:07.486758 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:22:07.494909 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:22:07.497114 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:22:07.497114 (MainThread): Partial parsing not enabled
2021-06-03 18:22:07.526213 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:22:07.536603 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:22:07.538791 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:22:07.538791 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:22:07.549169 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:22:07.549169 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:22:07.559411 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:22:07.559411 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:22:07.567489 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:22:07.569552 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:22:07.569552 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:22:07.579735 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:22:07.587834 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:22:07.589963 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:22:07.600129 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:22:07.600129 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:22:07.610142 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:22:07.610142 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:22:07.620279 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:22:07.620279 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:22:07.630321 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:22:07.630321 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:22:07.648616 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:22:07.824794 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263BCBB5C8>]}
2021-06-03 18:22:07.832376 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263BC359C8>]}
2021-06-03 18:22:07.832376 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:22:07.840354 (MainThread): 
2021-06-03 18:22:07.840354 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:22:07.844348 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:22:07.845335 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:22:08.437966 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:22:08.437966 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:22:08.444328 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:22:09.527101 (MainThread): 15:22:09 | Concurrency: 1 threads (target='dev')
2021-06-03 18:22:09.527101 (MainThread): 15:22:09 | 
2021-06-03 18:22:09.538443 (Thread-1): Began running node model.adventureworks.stg_address
2021-06-03 18:22:09.538443 (Thread-1): 15:22:09 | 1 of 22 START view model dbt_arthur.stg_address...................... [RUN]
2021-06-03 18:22:09.538443 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:22:09.538443 (Thread-1): Compiling model.adventureworks.stg_address
2021-06-03 18:22:09.544797 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_address"
2021-06-03 18:22:09.544797 (Thread-1): finished collecting timing info
2021-06-03 18:22:09.579921 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_address"
2021-06-03 18:22:09.580913 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:22:09.585912 (Thread-1): On model.adventureworks.stg_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_address"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_address`
  OPTIONS()
  as with 
    source as (
        select 
         stateprovinceid
         ,postalcode
         ,addressid		
         ,city			
         ,addressline2			
         ,modifieddate 
         ,_sdc_batched_at	
         ,_sdc_extracted_at as last_etl_run
         ,_sdc_table_version
         ,_sdc_received_at	
         ,_sdc_sequence						
        from `adventureworks-314121`.`adventureworks`.`address`
    )
select * from source;


2021-06-03 18:22:11.744774 (Thread-1): finished collecting timing info
2021-06-03 18:22:11.744774 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263BC5A888>]}
2021-06-03 18:22:11.745772 (Thread-1): 15:22:11 | 1 of 22 OK created view model dbt_arthur.stg_address................. [OK in 2.21s]
2021-06-03 18:22:11.747158 (Thread-1): Finished running node model.adventureworks.stg_address
2021-06-03 18:22:11.748129 (Thread-1): Began running node model.adventureworks.stg_businessentitycontact
2021-06-03 18:22:11.748129 (Thread-1): 15:22:11 | 2 of 22 START view model dbt_arthur.stg_businessentitycontact........ [RUN]
2021-06-03 18:22:11.749125 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:22:11.749125 (Thread-1): Compiling model.adventureworks.stg_businessentitycontact
2021-06-03 18:22:11.750124 (Thread-1): unclosed <socket.socket fd=1240, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64078), raddr=('216.58.202.10', 443)>
2021-06-03 18:22:11.751119 (Thread-1): unclosed <socket.socket fd=1248, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64079), raddr=('172.217.162.106', 443)>
2021-06-03 18:22:11.754774 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_businessentitycontact"
2021-06-03 18:22:11.755770 (Thread-1): finished collecting timing info
2021-06-03 18:22:11.757766 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_businessentitycontact"
2021-06-03 18:22:11.759757 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:11.763794 (Thread-1): On model.adventureworks.stg_businessentitycontact: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_businessentitycontact"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_businessentitycontact`
  OPTIONS()
  as with 
    source as (
        select 
            personid
            ,businessentityid			
            ,modifieddate			
            ,rowguid			
            ,contacttypeid
            ,_sdc_batched_at	
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence							
         from `adventureworks-314121`.`adventureworks`.`businessentitycontact`
    )
select * from source;


2021-06-03 18:22:13.237318 (Thread-1): finished collecting timing info
2021-06-03 18:22:13.237318 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263F789A48>]}
2021-06-03 18:22:13.237318 (Thread-1): 15:22:13 | 2 of 22 OK created view model dbt_arthur.stg_businessentitycontact... [OK in 1.49s]
2021-06-03 18:22:13.249231 (Thread-1): Finished running node model.adventureworks.stg_businessentitycontact
2021-06-03 18:22:13.249231 (Thread-1): Began running node model.adventureworks.stg_creditcard
2021-06-03 18:22:13.250474 (Thread-1): 15:22:13 | 3 of 22 START view model dbt_arthur.stg_creditcard................... [RUN]
2021-06-03 18:22:13.251473 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:22:13.251473 (Thread-1): Compiling model.adventureworks.stg_creditcard
2021-06-03 18:22:13.254497 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_creditcard"
2021-06-03 18:22:13.255493 (Thread-1): finished collecting timing info
2021-06-03 18:22:13.257499 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_creditcard"
2021-06-03 18:22:13.258446 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:13.262483 (Thread-1): On model.adventureworks.stg_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_creditcard"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_creditcard`
  OPTIONS()
  as with 
    source as (
        select * from `adventureworks-314121`.`adventureworks`.`creditcard`
    )
select * from source;


2021-06-03 18:22:13.374617 (Thread-1): unclosed <socket.socket fd=836, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64080), raddr=('216.58.202.10', 443)>
2021-06-03 18:22:13.374617 (Thread-1): unclosed <socket.socket fd=1300, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64081), raddr=('172.217.162.106', 443)>
2021-06-03 18:22:14.793565 (Thread-1): finished collecting timing info
2021-06-03 18:22:14.793565 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263F8214C8>]}
2021-06-03 18:22:14.793565 (Thread-1): 15:22:14 | 3 of 22 OK created view model dbt_arthur.stg_creditcard.............. [OK in 1.54s]
2021-06-03 18:22:14.808902 (Thread-1): Finished running node model.adventureworks.stg_creditcard
2021-06-03 18:22:14.810106 (Thread-1): Began running node model.adventureworks.stg_customer
2021-06-03 18:22:14.810106 (Thread-1): 15:22:14 | 4 of 22 START view model dbt_arthur.stg_customer..................... [RUN]
2021-06-03 18:22:14.811103 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:22:14.811103 (Thread-1): Compiling model.adventureworks.stg_customer
2021-06-03 18:22:14.815088 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_customer"
2021-06-03 18:22:14.816085 (Thread-1): finished collecting timing info
2021-06-03 18:22:14.819078 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_customer"
2021-06-03 18:22:14.828339 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:14.834322 (Thread-1): On model.adventureworks.stg_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_customer"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_customer`
  OPTIONS()
  as with 
    source as (
        select 
            customerid
            ,personid	
            ,modifieddate	
            ,rowguid		
            ,territoryid		
            ,storeid		
            ,_sdc_batched_at	
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence	
        
        from `adventureworks-314121`.`adventureworks`.`customer`
    )
select * from source;


2021-06-03 18:22:16.972361 (Thread-1): finished collecting timing info
2021-06-03 18:22:16.973360 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263F7D7EC8>]}
2021-06-03 18:22:16.973360 (Thread-1): 15:22:16 | 4 of 22 OK created view model dbt_arthur.stg_customer................ [OK in 2.16s]
2021-06-03 18:22:16.975266 (Thread-1): Finished running node model.adventureworks.stg_customer
2021-06-03 18:22:16.975266 (Thread-1): Began running node model.adventureworks.stg_person
2021-06-03 18:22:16.976266 (Thread-1): 15:22:16 | 5 of 22 START view model dbt_arthur.stg_person....................... [RUN]
2021-06-03 18:22:16.977260 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:22:16.977260 (Thread-1): Compiling model.adventureworks.stg_person
2021-06-03 18:22:16.978257 (Thread-1): unclosed <socket.socket fd=1160, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64084), raddr=('216.58.202.10', 443)>
2021-06-03 18:22:16.979254 (Thread-1): unclosed <socket.socket fd=1256, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64085), raddr=('172.217.162.106', 443)>
2021-06-03 18:22:16.982244 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_person"
2021-06-03 18:22:16.983240 (Thread-1): finished collecting timing info
2021-06-03 18:22:16.987742 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_person"
2021-06-03 18:22:16.989735 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:16.994717 (Thread-1): On model.adventureworks.stg_person: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_person"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_person`
  OPTIONS()
  as with 
    source as (
        select 
            businessentityid
            ,firstname 
            ,lastname
            ,persontype
            ,namestyle
            ,suffix	
            ,modifieddate
            ,rowguid
            ,emailpromotion			
            ,middlename
            ,_sdc_batched_at			
            ,_sdc_extracted_at as last_etl_run           			
            ,_sdc_received_at			
            ,_sdc_sequence
            ,_sdc_table_version	        
        from `adventureworks-314121`.`adventureworks`.`person`
    )
select * from source;


2021-06-03 18:22:18.848556 (Thread-1): finished collecting timing info
2021-06-03 18:22:18.848556 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263BD42F48>]}
2021-06-03 18:22:18.848556 (Thread-1): 15:22:18 | 5 of 22 OK created view model dbt_arthur.stg_person.................. [OK in 1.87s]
2021-06-03 18:22:18.853293 (Thread-1): Finished running node model.adventureworks.stg_person
2021-06-03 18:22:18.853293 (Thread-1): Began running node model.adventureworks.stg_personcreditcard
2021-06-03 18:22:18.853293 (Thread-1): 15:22:18 | 6 of 22 START view model dbt_arthur.stg_personcreditcard............. [RUN]
2021-06-03 18:22:18.854935 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:22:18.854935 (Thread-1): Compiling model.adventureworks.stg_personcreditcard
2021-06-03 18:22:18.858924 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_personcreditcard"
2021-06-03 18:22:18.859920 (Thread-1): finished collecting timing info
2021-06-03 18:22:18.862987 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_personcreditcard"
2021-06-03 18:22:18.863968 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:18.869925 (Thread-1): On model.adventureworks.stg_personcreditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_personcreditcard"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_personcreditcard`
  OPTIONS()
  as with 
    source as (
        select * from `adventureworks-314121`.`adventureworks`.`personcreditcard`
    )
select * from source;


2021-06-03 18:22:20.905840 (Thread-1): finished collecting timing info
2021-06-03 18:22:20.905840 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263F7CFC08>]}
2021-06-03 18:22:20.905840 (Thread-1): 15:22:20 | 6 of 22 OK created view model dbt_arthur.stg_personcreditcard........ [OK in 2.05s]
2021-06-03 18:22:20.921542 (Thread-1): Finished running node model.adventureworks.stg_personcreditcard
2021-06-03 18:22:20.921542 (Thread-1): Began running node model.adventureworks.stg_product
2021-06-03 18:22:20.922937 (Thread-1): 15:22:20 | 7 of 22 START view model dbt_arthur.stg_product...................... [RUN]
2021-06-03 18:22:20.922937 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:22:20.923983 (Thread-1): Compiling model.adventureworks.stg_product
2021-06-03 18:22:20.926924 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_product"
2021-06-03 18:22:20.929927 (Thread-1): finished collecting timing info
2021-06-03 18:22:20.931907 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_product"
2021-06-03 18:22:20.932968 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:20.937945 (Thread-1): On model.adventureworks.stg_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_product"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_product`
  OPTIONS()
  as with 
    source as (
        select 
            productid
            ,productsubcategoryid		
            ,productmodelid   
            ,name as productname         
            ,safetystocklevel			
            ,class						
            ,productnumber						
            ,modifieddate			
            ,rowguid						
            ,weightunitmeasurecode			
            ,standardcost									
            ,sizeunitmeasurecode										
            ,listprice						
            ,productline			
            ,size							
            ,weight
            ,_sdc_batched_at			
            ,_sdc_extracted_at as last_etl_run           			
            ,_sdc_received_at			
            ,_sdc_sequence
            ,_sdc_table_version	                   
        from `adventureworks-314121`.`adventureworks`.`product`
    )
select * from source;


2021-06-03 18:22:22.340361 (Thread-1): finished collecting timing info
2021-06-03 18:22:22.340361 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263F69B7C8>]}
2021-06-03 18:22:22.340361 (Thread-1): 15:22:22 | 7 of 22 OK created view model dbt_arthur.stg_product................. [OK in 1.42s]
2021-06-03 18:22:22.340361 (Thread-1): Finished running node model.adventureworks.stg_product
2021-06-03 18:22:22.345758 (Thread-1): Began running node model.adventureworks.stg_salesorderheadersalesreason
2021-06-03 18:22:22.346771 (Thread-1): 15:22:22 | 8 of 22 START view model dbt_arthur.stg_salesorderheadersalesreason.. [RUN]
2021-06-03 18:22:22.347357 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:22:22.347357 (Thread-1): Compiling model.adventureworks.stg_salesorderheadersalesreason
2021-06-03 18:22:22.351345 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_salesorderheadersalesreason"
2021-06-03 18:22:22.353343 (Thread-1): finished collecting timing info
2021-06-03 18:22:22.354372 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_salesorderheadersalesreason"
2021-06-03 18:22:22.355379 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:22.361410 (Thread-1): On model.adventureworks.stg_salesorderheadersalesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_salesorderheadersalesreason"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason`
  OPTIONS()
  as with 
    source as (
        select distinct * from `adventureworks-314121`.`adventureworks`.`salesorderheadersalesreason`
    )
select * from source;


2021-06-03 18:22:24.428151 (Thread-1): finished collecting timing info
2021-06-03 18:22:24.428151 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263F69B848>]}
2021-06-03 18:22:24.428151 (Thread-1): 15:22:24 | 8 of 22 OK created view model dbt_arthur.stg_salesorderheadersalesreason [OK in 2.08s]
2021-06-03 18:22:24.428151 (Thread-1): Finished running node model.adventureworks.stg_salesorderheadersalesreason
2021-06-03 18:22:24.436078 (Thread-1): Began running node model.adventureworks.stg_salesreason
2021-06-03 18:22:24.436078 (Thread-1): 15:22:24 | 9 of 22 START view model dbt_arthur.stg_salesreason.................. [RUN]
2021-06-03 18:22:24.437073 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:22:24.438071 (Thread-1): Compiling model.adventureworks.stg_salesreason
2021-06-03 18:22:24.441096 (Thread-1): unclosed <socket.socket fd=1288, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64086), raddr=('216.58.202.10', 443)>
2021-06-03 18:22:24.442095 (Thread-1): unclosed <socket.socket fd=1360, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64087), raddr=('172.217.162.106', 443)>
2021-06-03 18:22:24.442095 (Thread-1): unclosed <socket.socket fd=1348, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64088), raddr=('216.58.202.10', 443)>
2021-06-03 18:22:24.442725 (Thread-1): unclosed <socket.socket fd=1396, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64089), raddr=('172.217.162.106', 443)>
2021-06-03 18:22:24.442725 (Thread-1): unclosed <socket.socket fd=1400, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64090), raddr=('216.58.202.10', 443)>
2021-06-03 18:22:24.442725 (Thread-1): unclosed <socket.socket fd=1432, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64091), raddr=('172.217.162.106', 443)>
2021-06-03 18:22:24.442725 (Thread-1): unclosed <socket.socket fd=1192, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64092), raddr=('216.58.202.10', 443)>
2021-06-03 18:22:24.442725 (Thread-1): unclosed <socket.socket fd=136, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64093), raddr=('172.217.162.106', 443)>
2021-06-03 18:22:24.442725 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_salesreason"
2021-06-03 18:22:24.442725 (Thread-1): finished collecting timing info
2021-06-03 18:22:24.458384 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_salesreason"
2021-06-03 18:22:24.462939 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:24.464170 (Thread-1): On model.adventureworks.stg_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_salesreason"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
  OPTIONS()
  as with 
    source as (
        select distinct 
         salesreasonid			
         ,name as salereason			
         ,modifieddate			
         ,_sdc_batched_at			
         ,_sdc_extracted_at as last_etl_run           			
         ,_sdc_received_at			
         ,_sdc_sequence
         ,_sdc_table_version			
         from `adventureworks-314121`.`adventureworks`.`salesreason`
    )
select * from source;


2021-06-03 18:22:26.650253 (Thread-1): finished collecting timing info
2021-06-03 18:22:26.650253 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263F990488>]}
2021-06-03 18:22:26.650253 (Thread-1): 15:22:26 | 9 of 22 OK created view model dbt_arthur.stg_salesreason............. [OK in 2.21s]
2021-06-03 18:22:26.650253 (Thread-1): Finished running node model.adventureworks.stg_salesreason
2021-06-03 18:22:26.658861 (Thread-1): Began running node model.adventureworks.stg_salesterritory
2021-06-03 18:22:26.658861 (Thread-1): 15:22:26 | 10 of 22 START view model dbt_arthur.stg_salesterritory.............. [RUN]
2021-06-03 18:22:26.660902 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:22:26.660902 (Thread-1): Compiling model.adventureworks.stg_salesterritory
2021-06-03 18:22:26.661901 (Thread-1): unclosed <socket.socket fd=1476, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64094), raddr=('216.58.202.10', 443)>
2021-06-03 18:22:26.662888 (Thread-1): unclosed <socket.socket fd=752, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64095), raddr=('172.217.162.106', 443)>
2021-06-03 18:22:26.666312 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_salesterritory"
2021-06-03 18:22:26.667349 (Thread-1): finished collecting timing info
2021-06-03 18:22:26.669351 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_salesterritory"
2021-06-03 18:22:26.670296 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:26.676332 (Thread-1): On model.adventureworks.stg_salesterritory: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_salesterritory"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_salesterritory`
  OPTIONS()
  as with 
    source as (
        select *
         from `adventureworks-314121`.`adventureworks`.`salesterritory`
    )
select * from source;


2021-06-03 18:22:28.120127 (Thread-1): finished collecting timing info
2021-06-03 18:22:28.120875 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002264099B848>]}
2021-06-03 18:22:28.120875 (Thread-1): 15:22:28 | 10 of 22 OK created view model dbt_arthur.stg_salesterritory......... [OK in 1.46s]
2021-06-03 18:22:28.123347 (Thread-1): Finished running node model.adventureworks.stg_salesterritory
2021-06-03 18:22:28.123347 (Thread-1): Began running node model.adventureworks.stg_stateprovince
2021-06-03 18:22:28.123347 (Thread-1): 15:22:28 | 11 of 22 START view model dbt_arthur.stg_stateprovince............... [RUN]
2021-06-03 18:22:28.124989 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:22:28.125394 (Thread-1): Compiling model.adventureworks.stg_stateprovince
2021-06-03 18:22:28.127618 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_stateprovince"
2021-06-03 18:22:28.127618 (Thread-1): finished collecting timing info
2021-06-03 18:22:28.127618 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_stateprovince"
2021-06-03 18:22:28.127618 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:28.137787 (Thread-1): On model.adventureworks.stg_stateprovince: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_stateprovince"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_stateprovince`
  OPTIONS()
  as with 
    source as (
        select 
         stateprovinceid
         ,territoryid
         ,name as statename 			
         ,countryregioncode as countryregionid		
         ,modifieddate			
         ,rowguid									
         ,isonlystateprovinceflag			
         ,stateprovincecode			
         ,_sdc_batched_at	
         ,_sdc_extracted_at as last_etl_run
         ,_sdc_table_version
         ,_sdc_received_at	
         ,_sdc_sequence					
        from `adventureworks-314121`.`adventureworks`.`stateprovince`
    )
select * from source;


2021-06-03 18:22:30.233516 (Thread-1): finished collecting timing info
2021-06-03 18:22:30.233516 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226409CD748>]}
2021-06-03 18:22:30.233516 (Thread-1): 15:22:30 | 11 of 22 OK created view model dbt_arthur.stg_stateprovince.......... [OK in 2.11s]
2021-06-03 18:22:30.233516 (Thread-1): Finished running node model.adventureworks.stg_stateprovince
2021-06-03 18:22:30.233516 (Thread-1): Began running node model.adventureworks.stg_salesorderdetail
2021-06-03 18:22:30.243138 (Thread-1): 15:22:30 | 12 of 22 START view model dbt_arthur.stg_salesorderdetail............ [RUN]
2021-06-03 18:22:30.243138 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:22:30.244135 (Thread-1): Compiling model.adventureworks.stg_salesorderdetail
2021-06-03 18:22:30.244529 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_salesorderdetail"
2021-06-03 18:22:30.244529 (Thread-1): finished collecting timing info
2021-06-03 18:22:30.244529 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_salesorderdetail"
2021-06-03 18:22:30.250079 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:30.255062 (Thread-1): On model.adventureworks.stg_salesorderdetail: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_salesorderdetail"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_salesorderdetail`
  OPTIONS()
  as with 
    source as (
        select 
         salesorderdetailid
         ,salesorderid
         ,specialofferid
         ,orderqty			
         ,unitprice			
		 ,modifieddate			
         ,rowguid			
         ,productid			
         ,carriertrackingnumber			
         ,unitpricediscount
         ,_sdc_batched_at	
         ,_sdc_extracted_at as last_etl_run
         ,_sdc_table_version
         ,_sdc_received_at	
         ,_sdc_sequence		
         from `adventureworks-314121`.`adventureworks`.`salesorderdetail`
    )
    , source1 as (
        select 
         salesorderdetailid
         ,salesorderid
         ,specialofferid
         ,orderqty			
         ,unitprice					
         ,productid	
        from source
        )		
select * from source1;


2021-06-03 18:22:32.365655 (Thread-1): finished collecting timing info
2021-06-03 18:22:32.366725 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226409F9948>]}
2021-06-03 18:22:32.367694 (Thread-1): 15:22:32 | 12 of 22 OK created view model dbt_arthur.stg_salesorderdetail....... [OK in 2.12s]
2021-06-03 18:22:32.369638 (Thread-1): Finished running node model.adventureworks.stg_salesorderdetail
2021-06-03 18:22:32.369638 (Thread-1): Began running node model.adventureworks.stg_salesorderheader
2021-06-03 18:22:32.370675 (Thread-1): 15:22:32 | 13 of 22 START view model dbt_arthur.stg_salesorderheader............ [RUN]
2021-06-03 18:22:32.371628 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:22:32.371628 (Thread-1): Compiling model.adventureworks.stg_salesorderheader
2021-06-03 18:22:32.376679 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_salesorderheader"
2021-06-03 18:22:32.377640 (Thread-1): finished collecting timing info
2021-06-03 18:22:32.380739 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_salesorderheader"
2021-06-03 18:22:32.382592 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:32.388691 (Thread-1): On model.adventureworks.stg_salesorderheader: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_salesorderheader"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheader`
  OPTIONS()
  as with 
    source as (
        select 
            salesorderid  
            ,customerid				
            ,shipmethodid
            ,shiptoaddressid as addressid					
            ,billtoaddressid			
            ,salespersonid
            ,territoryid					
            ,currencyrateid	            
            ,status	
            ,totaldue
            ,orderdate			
            ,modifieddate			
            ,rowguid
            ,purchaseordernumber			
            ,taxamt						
            ,onlineorderflag														
            ,creditcardapprovalcode			
            ,subtotal			
            ,creditcardid						
            ,freight			
            ,duedate													
            ,_sdc_batched_at			
            ,_sdc_extracted_at as last_etl_run           			
            ,_sdc_received_at			
            ,_sdc_sequence
            ,_sdc_table_version			
        from `adventureworks-314121`.`adventureworks`.`salesorderheader`
    )
select * from source;


2021-06-03 18:22:34.681713 (Thread-1): finished collecting timing info
2021-06-03 18:22:34.681713 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022640A202C8>]}
2021-06-03 18:22:34.681713 (Thread-1): 15:22:34 | 13 of 22 OK created view model dbt_arthur.stg_salesorderheader....... [OK in 2.31s]
2021-06-03 18:22:34.681713 (Thread-1): Finished running node model.adventureworks.stg_salesorderheader
2021-06-03 18:22:34.686999 (Thread-1): Began running node model.adventureworks.stg_countryregion
2021-06-03 18:22:34.686999 (Thread-1): 15:22:34 | 14 of 22 START view model dbt_arthur.stg_countryregion............... [RUN]
2021-06-03 18:22:34.688030 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:22:34.688030 (Thread-1): Compiling model.adventureworks.stg_countryregion
2021-06-03 18:22:34.691982 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_countryregion"
2021-06-03 18:22:34.692977 (Thread-1): finished collecting timing info
2021-06-03 18:22:34.694971 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_countryregion"
2021-06-03 18:22:34.696968 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:34.702944 (Thread-1): On model.adventureworks.stg_countryregion: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_countryregion"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_countryregion`
  OPTIONS()
  as with 
    source as (
        select 
         name as country						
         ,countryregioncode as countryregionid
         ,modifieddate			
         ,_sdc_batched_at	
         ,_sdc_extracted_at as last_etl_run
         ,_sdc_table_version
         ,_sdc_received_at	
         ,_sdc_sequence			
        from `adventureworks-314121`.`adventureworks`.`countryregion`
    )
select * from source;


2021-06-03 18:22:34.706931 (Thread-1): unclosed <socket.socket fd=1512, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64097), raddr=('172.217.162.106', 443)>
2021-06-03 18:22:34.707927 (Thread-1): unclosed <socket.socket fd=732, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64096), raddr=('216.58.202.10', 443)>
2021-06-03 18:22:34.707927 (Thread-1): unclosed <socket.socket fd=1204, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64098), raddr=('216.58.202.10', 443)>
2021-06-03 18:22:34.707927 (Thread-1): unclosed <socket.socket fd=1508, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64099), raddr=('172.217.162.106', 443)>
2021-06-03 18:22:34.707927 (Thread-1): unclosed <socket.socket fd=1504, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64100), raddr=('216.58.202.10', 443)>
2021-06-03 18:22:34.707927 (Thread-1): unclosed <socket.socket fd=1520, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64101), raddr=('172.217.162.106', 443)>
2021-06-03 18:22:34.707927 (Thread-1): unclosed <socket.socket fd=1576, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64102), raddr=('216.58.202.10', 443)>
2021-06-03 18:22:34.707927 (Thread-1): unclosed <socket.socket fd=1616, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64103), raddr=('172.217.162.106', 443)>
2021-06-03 18:22:36.819784 (Thread-1): finished collecting timing info
2021-06-03 18:22:36.819784 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022640A3F388>]}
2021-06-03 18:22:36.819784 (Thread-1): 15:22:36 | 14 of 22 OK created view model dbt_arthur.stg_countryregion.......... [OK in 2.13s]
2021-06-03 18:22:36.819784 (Thread-1): Finished running node model.adventureworks.stg_countryregion
2021-06-03 18:22:36.822641 (Thread-1): Began running node model.adventureworks.stg_productlistpricehistory
2021-06-03 18:22:36.822641 (Thread-1): 15:22:36 | 15 of 22 START view model dbt_arthur.stg_productlistpricehistory..... [RUN]
2021-06-03 18:22:36.823638 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:22:36.823638 (Thread-1): Compiling model.adventureworks.stg_productlistpricehistory
2021-06-03 18:22:36.826348 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_productlistpricehistory"
2021-06-03 18:22:36.827354 (Thread-1): finished collecting timing info
2021-06-03 18:22:36.830362 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_productlistpricehistory"
2021-06-03 18:22:36.832327 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:36.836360 (Thread-1): On model.adventureworks.stg_productlistpricehistory: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_productlistpricehistory"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_productlistpricehistory`
  OPTIONS()
  as with 
    source as (
        select * from `adventureworks-314121`.`adventureworks`.`productlistpricehistory`
    )
select * from source;


2021-06-03 18:22:38.955863 (Thread-1): finished collecting timing info
2021-06-03 18:22:38.955863 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022640A3F388>]}
2021-06-03 18:22:38.955863 (Thread-1): 15:22:38 | 15 of 22 OK created view model dbt_arthur.stg_productlistpricehistory [OK in 2.13s]
2021-06-03 18:22:38.955863 (Thread-1): Finished running node model.adventureworks.stg_productlistpricehistory
2021-06-03 18:22:38.965606 (Thread-1): Began running node model.adventureworks.stg_store
2021-06-03 18:22:38.965606 (Thread-1): 15:22:38 | 16 of 22 START view model dbt_arthur.stg_store....................... [RUN]
2021-06-03 18:22:38.966632 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:22:38.966632 (Thread-1): Compiling model.adventureworks.stg_store
2021-06-03 18:22:38.970589 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_store"
2021-06-03 18:22:38.972669 (Thread-1): finished collecting timing info
2021-06-03 18:22:38.975624 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_store"
2021-06-03 18:22:38.977569 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:38.983596 (Thread-1): On model.adventureworks.stg_store: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_store"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_store`
  OPTIONS()
  as with 
    source as (
        select * from `adventureworks-314121`.`adventureworks`.`store`
    )
select * from source;


2021-06-03 18:22:41.297008 (Thread-1): finished collecting timing info
2021-06-03 18:22:41.297008 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022640ABC888>]}
2021-06-03 18:22:41.297008 (Thread-1): 15:22:41 | 16 of 22 OK created view model dbt_arthur.stg_store.................. [OK in 2.33s]
2021-06-03 18:22:41.297008 (Thread-1): Finished running node model.adventureworks.stg_store
2021-06-03 18:22:41.297008 (Thread-1): Began running node model.adventureworks.dim_customer
2021-06-03 18:22:41.309103 (Thread-1): 15:22:41 | 17 of 22 START table model dbt_arthur.dim_customer................... [RUN]
2021-06-03 18:22:41.310163 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:22:41.310163 (Thread-1): Compiling model.adventureworks.dim_customer
2021-06-03 18:22:41.312133 (Thread-1): unclosed <socket.socket fd=796, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64108), raddr=('216.58.202.10', 443)>
2021-06-03 18:22:41.312133 (Thread-1): unclosed <socket.socket fd=1672, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64109), raddr=('172.217.162.106', 443)>
2021-06-03 18:22:41.315085 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_customer"
2021-06-03 18:22:41.317076 (Thread-1): finished collecting timing info
2021-06-03 18:22:41.333071 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:41.337059 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:22:42.439831 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_customer"
2021-06-03 18:22:42.439831 (Thread-1): On model.adventureworks.dim_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_customer"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_customer`
  
  
  OPTIONS()
  as (
    with 
    sourcecustomer as (
        select 
            customerid
 
        from `adventureworks-314121`.`dbt_arthur`.`stg_customer`       
    )
    , transformed as (
        select
         row_number () over (order by customerid) as customer_sk 
         ,*
        from sourcecustomer
    )
select distinct * from transformed
  );
    
2021-06-03 18:22:45.440556 (Thread-1): finished collecting timing info
2021-06-03 18:22:45.440556 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022640AD9748>]}
2021-06-03 18:22:45.440556 (Thread-1): 15:22:45 | 17 of 22 OK created table model dbt_arthur.dim_customer.............. [CREATE TABLE (19.8k rows, 154.8 KB processed) in 4.13s]
2021-06-03 18:22:45.440556 (Thread-1): Finished running node model.adventureworks.dim_customer
2021-06-03 18:22:45.450951 (Thread-1): Began running node model.adventureworks.dim_creditcard
2021-06-03 18:22:45.450951 (Thread-1): 15:22:45 | 18 of 22 START table model dbt_arthur.dim_creditcard................. [RUN]
2021-06-03 18:22:45.452697 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:22:45.452697 (Thread-1): Compiling model.adventureworks.dim_creditcard
2021-06-03 18:22:45.458714 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_creditcard"
2021-06-03 18:22:45.467767 (Thread-1): finished collecting timing info
2021-06-03 18:22:45.470793 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:45.476795 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:22:45.998039 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_creditcard"
2021-06-03 18:22:45.998039 (Thread-1): On model.adventureworks.dim_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_creditcard"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
  
  
  OPTIONS()
  as (
    with 
    sourceperson as (
        select 
            businessentityid
            ,firstname 
            ,lastname
            ,persontype
            ,namestyle
            ,suffix	
            ,modifieddate
            ,rowguid
            ,emailpromotion			
            ,middlename       
        from `adventureworks-314121`.`dbt_arthur`.`stg_person`  
    )
    ,sourcebusinessentitycontact as (
        select 
            personid
            ,businessentityid			
            ,modifieddate			
            ,rowguid			
            ,contacttypeid
        from `adventureworks-314121`.`dbt_arthur`.`stg_businessentitycontact`
    )
    ,sourcecreditcard as (
        select 
            creditcardid
            ,cardtype	
            ,expyear	
            ,modifieddate	
            ,cardnumber	
            ,expmonth	

        from `adventureworks-314121`.`dbt_arthur`.`stg_creditcard` 
    ) 
    , sourcepersoncreditcard as (
        select 
            businessentityid
            ,creditcardid	 	 	
            ,modifieddate		 		

        from `adventureworks-314121`.`dbt_arthur`.`stg_personcreditcard` 
    )  
    , selected as (
        select 
         sourceperson.businessentityid,
         sourceperson.firstname,
         sourceperson.lastname, 
         sourcecreditcard.cardtype,
         sourcepersoncreditcard.creditcardid

        from sourceperson 
        left join sourcepersoncreditcard on sourceperson.businessentityid = sourcepersoncreditcard.businessentityid
        left join sourcecreditcard on sourcepersoncreditcard.creditcardid = sourcecreditcard.creditcardid
        
     )
    , transformed as (
        select 
           row_number() over (order by creditcardid) as creditcard_sk
           , *
        from selected
    )
select distinct * from transformed
  );
    
2021-06-03 18:22:50.328265 (Thread-1): finished collecting timing info
2021-06-03 18:22:50.328265 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022640AFDF48>]}
2021-06-03 18:22:50.328265 (Thread-1): 15:22:50 | 18 of 22 OK created table model dbt_arthur.dim_creditcard............ [CREATE TABLE (20.0k rows, 1.1 MB processed) in 4.88s]
2021-06-03 18:22:50.328265 (Thread-1): Finished running node model.adventureworks.dim_creditcard
2021-06-03 18:22:50.343002 (Thread-1): Began running node model.adventureworks.dim_product
2021-06-03 18:22:50.344042 (Thread-1): 15:22:50 | 19 of 22 START table model dbt_arthur.dim_product.................... [RUN]
2021-06-03 18:22:50.344995 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:22:50.344995 (Thread-1): Compiling model.adventureworks.dim_product
2021-06-03 18:22:50.351276 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_product"
2021-06-03 18:22:50.361237 (Thread-1): finished collecting timing info
2021-06-03 18:22:50.363271 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:50.370205 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:22:50.372270 (Thread-1): unclosed <socket.socket fd=1208, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64107), raddr=('172.217.162.106', 443)>
2021-06-03 18:22:50.372270 (Thread-1): unclosed <socket.socket fd=1520, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64106), raddr=('216.58.202.10', 443)>
2021-06-03 18:22:50.373252 (Thread-1): unclosed <socket.socket fd=1696, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64111), raddr=('172.217.162.106', 443)>
2021-06-03 18:22:50.374256 (Thread-1): unclosed <socket.socket fd=1688, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64110), raddr=('216.58.202.10', 443)>
2021-06-03 18:22:50.374256 (Thread-1): unclosed <socket.socket fd=1232, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64112), raddr=('216.58.202.10', 443)>
2021-06-03 18:22:50.374256 (Thread-1): unclosed <socket.socket fd=1752, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 64113), raddr=('172.217.162.106', 443)>
2021-06-03 18:22:51.453422 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_product"
2021-06-03 18:22:51.453422 (Thread-1): On model.adventureworks.dim_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_product"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_product`
  
  
  OPTIONS()
  as (
    with 
    sourceproduct as (
        select distinct
            productid 
            ,productname       				
        from `adventureworks-314121`.`dbt_arthur`.`stg_product` 
    )
    , transformedproduct as (
        select
          row_number() over(order by productid) as product_sk 
           , *
        from sourceproduct
    )
select * from transformedproduct
  );
    
2021-06-03 18:22:54.110656 (Thread-1): finished collecting timing info
2021-06-03 18:22:54.110656 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022641B3D248>]}
2021-06-03 18:22:54.110656 (Thread-1): 15:22:54 | 19 of 22 OK created table model dbt_arthur.dim_product............... [CREATE TABLE (504.0 rows, 14.0 KB processed) in 3.77s]
2021-06-03 18:22:54.110656 (Thread-1): Finished running node model.adventureworks.dim_product
2021-06-03 18:22:54.119733 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 18:22:54.119733 (Thread-1): 15:22:54 | 20 of 22 START table model dbt_arthur.dim_salesreason................ [RUN]
2021-06-03 18:22:54.121508 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:22:54.121508 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 18:22:54.126936 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:22:54.127945 (Thread-1): finished collecting timing info
2021-06-03 18:22:54.129986 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:54.135942 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:22:55.225103 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:22:55.225103 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct
            salesorderheadersalesreason.salesreasonid			
            ,salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select 
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
where salereason = 'Price' or salereason ='On Promotion'
  );
    
2021-06-03 18:22:58.786371 (Thread-1): finished collecting timing info
2021-06-03 18:22:58.786371 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022640B40308>]}
2021-06-03 18:22:58.786371 (Thread-1): 15:22:58 | 20 of 22 OK created table model dbt_arthur.dim_salesreason........... [CREATE TABLE (21.0k rows, 432.7 KB processed) in 4.67s]
2021-06-03 18:22:58.786371 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 18:22:58.792413 (Thread-1): Began running node model.adventureworks.dim_localization
2021-06-03 18:22:58.792413 (Thread-1): 15:22:58 | 21 of 22 START table model dbt_arthur.dim_localization............... [RUN]
2021-06-03 18:22:58.793408 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:22:58.793408 (Thread-1): Compiling model.adventureworks.dim_localization
2021-06-03 18:22:58.797395 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_localization"
2021-06-03 18:22:58.798391 (Thread-1): finished collecting timing info
2021-06-03 18:22:58.801383 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:22:58.809357 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:22:59.934730 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_localization"
2021-06-03 18:22:59.936712 (Thread-1): On model.adventureworks.dim_localization: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_localization"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_localization`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesterritory as (
            select *
              ,name as countryname
            from `adventureworks-314121`.`dbt_arthur`.`stg_salesterritory`       
    )   
    ,sourceaddress as (
            select 
             postalcode
             ,stateprovinceid
             ,addressid			
             ,city	
            from `adventureworks-314121`.`dbt_arthur`.`stg_address` 
    ) 
    , sourcestateprovince as (
            select 
                stateprovinceid
                ,countryregionid
                ,territoryid
                ,statename 	
            from `adventureworks-314121`.`dbt_arthur`.`stg_stateprovince`		
    )
    , selected as (
            select 
              sourceaddress.addressid
              ,sourcestateprovince.statename
              ,sourcesalesterritory.countryname
              ,sourceaddress.city
              ,sourceaddress.postalcode
            from sourceaddress
            left join sourcestateprovince on sourceaddress.stateprovinceid = sourcestateprovince.stateprovinceid 
            left join sourcesalesterritory on sourcestateprovince.territoryid =  sourcesalesterritory.territoryid 
    )
    , transformed as (
            select 
              row_number() over (order by addressid) as address_sk,
              * 
            from selected
    )

select distinct * from transformed
  );
    
2021-06-03 18:23:03.512173 (Thread-1): finished collecting timing info
2021-06-03 18:23:03.512173 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022641B58388>]}
2021-06-03 18:23:03.512173 (Thread-1): 15:23:03 | 21 of 22 OK created table model dbt_arthur.dim_localization.......... [CREATE TABLE (19.6k rows, 650.7 KB processed) in 4.72s]
2021-06-03 18:23:03.512173 (Thread-1): Finished running node model.adventureworks.dim_localization
2021-06-03 18:23:03.523982 (Thread-1): Began running node model.adventureworks.fact_sales_order
2021-06-03 18:23:03.525028 (Thread-1): 15:23:03 | 22 of 22 START table model dbt_arthur.fact_sales_order............... [RUN]
2021-06-03 18:23:03.526767 (Thread-1): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:23:03.526767 (Thread-1): Compiling model.adventureworks.fact_sales_order
2021-06-03 18:23:03.533798 (Thread-1): Writing injected SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:23:03.535730 (Thread-1): finished collecting timing info
2021-06-03 18:23:03.536798 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:23:03.542749 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:23:04.635448 (Thread-1): Writing runtime SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:23:04.637404 (Thread-1): On model.adventureworks.fact_sales_order: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.fact_sales_order"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
  
  
  OPTIONS()
  as (
    with 
    salesreason as ( 
        select distinct * from  `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    )
    ,creditcard as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    )
    ,customers as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    )
    , localization as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    )
    , products as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    )
    , sales_orders_sk as (
          select 
            orderheader.salesorderid  
            ,customers.customer_sk as customer_fk		
            ,creditcard.creditcard_sk as creditcard_fk
            ,localization.address_sk as address_fk
            ,orderheader.status	
            ,orderheader.totaldue
            ,orderheader.orderdate						
          from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheader` as orderheader
          left join localization on orderheader.addressid = localization.addressid
          left join customers on orderheader.customerid = customers.customerid
          left join creditcard on orderheader.creditcardid = creditcard.creditcardid

    )
    , sales_orders_details_sk as (
        select 
         orderdetail.salesorderdetailid
         ,orderdetail.salesorderid
         ,products.product_sk as product_fk
         ,orderdetail.specialofferid
         ,orderdetail.orderqty			
         ,orderdetail.unitprice			
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderdetail` as orderdetail
        left join products on orderdetail.productid = products.productid
    )
    , final as (
        select 
            sales_orders_sk.salesorderid 
            ,sales_orders_sk.customer_fk
            ,sales_orders_sk.creditcard_fk
            ,sales_orders_details_sk.product_fk
            ,sales_orders_sk.address_fk
            ,sales_orders_sk.status	
            ,sales_orders_sk.orderdate						
            ,sales_orders_details_sk.orderqty			
            ,sales_orders_details_sk.unitprice
            ,salesreason.salesreason_sk as salesreason_fk
						
        from sales_orders_sk 
        left join sales_orders_details_sk on sales_orders_sk.salesorderid = sales_orders_details_sk.salesorderid
        left join salesreason on sales_orders_sk.salesorderid = salesreason.salesorderid		
    )

select  distinct * from final
  );
    
2021-06-03 18:23:09.370076 (Thread-1): finished collecting timing info
2021-06-03 18:23:09.370076 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d304d-1611-454b-a4e7-c7ae120ec45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022641B785C8>]}
2021-06-03 18:23:09.370076 (Thread-1): 15:23:09 | 22 of 22 OK created table model dbt_arthur.fact_sales_order.......... [CREATE TABLE (126.7k rows, 7.6 MB processed) in 5.84s]
2021-06-03 18:23:09.370076 (Thread-1): Finished running node model.adventureworks.fact_sales_order
2021-06-03 18:23:09.463494 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:23:09.464490 (MainThread): 15:23:09 | 
2021-06-03 18:23:09.465127 (MainThread): 15:23:09 | Finished running 16 view models, 6 table models in 61.62s.
2021-06-03 18:23:09.466132 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:23:09.466132 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:23:09.466132 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:23:09.466132 (MainThread): Connection 'model.adventureworks.fact_sales_order' was properly closed.
2021-06-03 18:23:09.476097 (MainThread): 
2021-06-03 18:23:09.477093 (MainThread): Completed successfully
2021-06-03 18:23:09.478089 (MainThread): 
Done. PASS=22 WARN=0 ERROR=0 SKIP=0 TOTAL=22
2021-06-03 18:23:09.478089 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022641B7B6C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022641B7B888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022641B78FC8>]}
2021-06-03 18:23:09.479085 (MainThread): Flushing usage events
2021-06-03 18:23:22.280625 (MainThread): Running with dbt=0.19.1
2021-06-03 18:23:22.628020 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-03 18:23:22.628020 (MainThread): Tracking: tracking
2021-06-03 18:23:22.628020 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194253D948>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021942541A48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021942541DC8>]}
2021-06-03 18:23:22.638447 (MainThread): Partial parsing not enabled
2021-06-03 18:23:22.638447 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:23:22.659200 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:23:22.659200 (MainThread): Parsing macros\etc.sql
2021-06-03 18:23:22.667374 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:23:22.669556 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:23:22.686387 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:23:22.689083 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:23:22.690171 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:23:22.700460 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:23:22.708520 (MainThread): Parsing macros\core.sql
2021-06-03 18:23:22.710589 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:23:22.750999 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:23:22.761162 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:23:22.761162 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:23:22.761162 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:23:22.769236 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:23:22.771303 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:23:22.771303 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:23:22.781484 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:23:22.791691 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:23:22.791691 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:23:22.801865 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:23:22.822234 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:23:22.852827 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:23:22.852827 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:23:22.873300 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:23:22.873300 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:23:22.883429 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:23:22.891523 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:23:22.893601 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:23:22.893601 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:23:22.893601 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:23:22.904400 (MainThread): Partial parsing not enabled
2021-06-03 18:23:22.924493 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:23:22.934693 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:23:22.934693 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:23:22.944932 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:23:22.944932 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:23:22.953048 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:23:22.955140 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:23:22.963283 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:23:22.965399 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:23:22.965399 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:23:22.973528 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:23:22.975618 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:23:22.975618 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:23:22.985864 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:23:22.985864 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:23:22.994004 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:23:22.996124 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:23:22.996124 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:23:23.004159 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:23:23.006253 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:23:23.006253 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:23:23.016460 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:23:23.028087 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:23:23.199385 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0c3fe49-9c65-48c8-993b-121d6df17c9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021942570388>]}
2021-06-03 18:23:23.209505 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0c3fe49-9c65-48c8-993b-121d6df17c9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219461FFF08>]}
2021-06-03 18:23:23.209505 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:23:23.226122 (MainThread): 
2021-06-03 18:23:23.227068 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:23:23.230056 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:23:23.230056 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:23:23.237033 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:23:24.371511 (MainThread): 15:23:24 | Concurrency: 1 threads (target='dev')
2021-06-03 18:23:24.372008 (MainThread): 15:23:24 | 
2021-06-03 18:23:24.378667 (Thread-1): Began running node test.adventureworks.not_null_dim_creditcard_creditcard_sk
2021-06-03 18:23:24.378667 (Thread-1): 15:23:24 | 1 of 17 START test not_null_dim_creditcard_creditcard_sk............. [RUN]
2021-06-03 18:23:24.380167 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_creditcard_creditcard_sk".
2021-06-03 18:23:24.380167 (Thread-1): Compiling test.adventureworks.not_null_dim_creditcard_creditcard_sk
2021-06-03 18:23:24.393743 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_creditcard_creditcard_sk"
2021-06-03 18:23:24.395739 (Thread-1): finished collecting timing info
2021-06-03 18:23:24.395739 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:23:24.404346 (Thread-1): On test.adventureworks.not_null_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
where creditcard_sk is null



2021-06-03 18:23:27.199998 (Thread-1): finished collecting timing info
2021-06-03 18:23:27.199998 (Thread-1): 15:23:27 | 1 of 17 PASS not_null_dim_creditcard_creditcard_sk................... [PASS in 2.82s]
2021-06-03 18:23:27.205374 (Thread-1): Finished running node test.adventureworks.not_null_dim_creditcard_creditcard_sk
2021-06-03 18:23:27.205374 (Thread-1): Began running node test.adventureworks.not_null_dim_customer_customer_sk
2021-06-03 18:23:27.205374 (Thread-1): 15:23:27 | 2 of 17 START test not_null_dim_customer_customer_sk................. [RUN]
2021-06-03 18:23:27.206370 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_customer_customer_sk".
2021-06-03 18:23:27.207366 (Thread-1): Compiling test.adventureworks.not_null_dim_customer_customer_sk
2021-06-03 18:23:27.208363 (Thread-1): unclosed <socket.socket fd=1156, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 60218), raddr=('216.58.202.10', 443)>
2021-06-03 18:23:27.208363 (Thread-1): unclosed <socket.socket fd=692, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 60219), raddr=('172.217.162.106', 443)>
2021-06-03 18:23:27.213346 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_customer_customer_sk"
2021-06-03 18:23:27.216354 (Thread-1): finished collecting timing info
2021-06-03 18:23:27.216354 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:23:27.222352 (Thread-1): On test.adventureworks.not_null_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
where customer_sk is null



2021-06-03 18:23:29.940962 (Thread-1): finished collecting timing info
2021-06-03 18:23:29.944726 (Thread-1): 15:23:29 | 2 of 17 PASS not_null_dim_customer_customer_sk....................... [PASS in 2.74s]
2021-06-03 18:23:29.946698 (Thread-1): Finished running node test.adventureworks.not_null_dim_customer_customer_sk
2021-06-03 18:23:29.946698 (Thread-1): Began running node test.adventureworks.not_null_dim_localization_address_sk
2021-06-03 18:23:29.946698 (Thread-1): 15:23:29 | 3 of 17 START test not_null_dim_localization_address_sk.............. [RUN]
2021-06-03 18:23:29.947690 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_localization_address_sk".
2021-06-03 18:23:29.948687 (Thread-1): Compiling test.adventureworks.not_null_dim_localization_address_sk
2021-06-03 18:23:29.954737 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_localization_address_sk"
2021-06-03 18:23:29.958297 (Thread-1): finished collecting timing info
2021-06-03 18:23:29.958297 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:23:29.966062 (Thread-1): On test.adventureworks.not_null_dim_localization_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_localization_address_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
where address_sk is null



2021-06-03 18:23:32.627186 (Thread-1): finished collecting timing info
2021-06-03 18:23:32.627186 (Thread-1): 15:23:32 | 3 of 17 PASS not_null_dim_localization_address_sk.................... [PASS in 2.68s]
2021-06-03 18:23:32.627186 (Thread-1): Finished running node test.adventureworks.not_null_dim_localization_address_sk
2021-06-03 18:23:32.640804 (Thread-1): Began running node test.adventureworks.not_null_dim_product_product_sk
2021-06-03 18:23:32.640804 (Thread-1): 15:23:32 | 4 of 17 START test not_null_dim_product_product_sk................... [RUN]
2021-06-03 18:23:32.641800 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_product_product_sk".
2021-06-03 18:23:32.641800 (Thread-1): Compiling test.adventureworks.not_null_dim_product_product_sk
2021-06-03 18:23:32.647493 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_product_product_sk"
2021-06-03 18:23:32.657441 (Thread-1): finished collecting timing info
2021-06-03 18:23:32.657441 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:23:32.663438 (Thread-1): On test.adventureworks.not_null_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_product`
where product_sk is null



2021-06-03 18:23:35.550922 (Thread-1): finished collecting timing info
2021-06-03 18:23:35.551921 (Thread-1): 15:23:35 | 4 of 17 PASS not_null_dim_product_product_sk......................... [PASS in 2.91s]
2021-06-03 18:23:35.552963 (Thread-1): Finished running node test.adventureworks.not_null_dim_product_product_sk
2021-06-03 18:23:35.553914 (Thread-1): Began running node test.adventureworks.not_null_dim_salesreason_salesreason_sk
2021-06-03 18:23:35.553914 (Thread-1): 15:23:35 | 5 of 17 START test not_null_dim_salesreason_salesreason_sk........... [RUN]
2021-06-03 18:23:35.554910 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_salesreason_salesreason_sk".
2021-06-03 18:23:35.554910 (Thread-1): Compiling test.adventureworks.not_null_dim_salesreason_salesreason_sk
2021-06-03 18:23:35.554910 (Thread-1): unclosed <socket.socket fd=784, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 60224), raddr=('216.58.202.10', 443)>
2021-06-03 18:23:35.555927 (Thread-1): unclosed <socket.socket fd=1304, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 60225), raddr=('172.217.162.106', 443)>
2021-06-03 18:23:35.558389 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_salesreason_salesreason_sk"
2021-06-03 18:23:35.559440 (Thread-1): finished collecting timing info
2021-06-03 18:23:35.559440 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:23:35.564410 (Thread-1): On test.adventureworks.not_null_dim_salesreason_salesreason_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_salesreason_salesreason_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
where salesreason_sk is null



2021-06-03 18:23:38.392311 (Thread-1): finished collecting timing info
2021-06-03 18:23:38.393308 (Thread-1): 15:23:38 | 5 of 17 PASS not_null_dim_salesreason_salesreason_sk................. [PASS in 2.84s]
2021-06-03 18:23:38.394637 (Thread-1): Finished running node test.adventureworks.not_null_dim_salesreason_salesreason_sk
2021-06-03 18:23:38.395680 (Thread-1): Began running node test.adventureworks.not_null_fact_sales_order_salesorderid
2021-06-03 18:23:38.395680 (Thread-1): 15:23:38 | 6 of 17 START test not_null_fact_sales_order_salesorderid............ [RUN]
2021-06-03 18:23:38.396675 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_fact_sales_order_salesorderid".
2021-06-03 18:23:38.397672 (Thread-1): Compiling test.adventureworks.not_null_fact_sales_order_salesorderid
2021-06-03 18:23:38.404730 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_fact_sales_order_salesorderid"
2021-06-03 18:23:38.406323 (Thread-1): finished collecting timing info
2021-06-03 18:23:38.406323 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:23:38.411346 (Thread-1): On test.adventureworks.not_null_fact_sales_order_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_fact_sales_order_salesorderid"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
where salesorderid is null



2021-06-03 18:23:38.414338 (Thread-1): unclosed <socket.socket fd=1204, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 60220), raddr=('216.58.202.10', 443)>
2021-06-03 18:23:38.414338 (Thread-1): unclosed <socket.socket fd=1208, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 60221), raddr=('172.217.162.106', 443)>
2021-06-03 18:23:38.415337 (Thread-1): unclosed <socket.socket fd=764, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 60223), raddr=('172.217.162.106', 443)>
2021-06-03 18:23:38.415337 (Thread-1): unclosed <socket.socket fd=956, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 60222), raddr=('216.58.202.10', 443)>
2021-06-03 18:23:38.416331 (Thread-1): unclosed <socket.socket fd=1252, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 60226), raddr=('216.58.202.10', 443)>
2021-06-03 18:23:38.417329 (Thread-1): unclosed <socket.socket fd=1172, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 60227), raddr=('172.217.162.106', 443)>
2021-06-03 18:23:41.345572 (Thread-1): finished collecting timing info
2021-06-03 18:23:41.346611 (Thread-1): 15:23:41 | 6 of 17 PASS not_null_fact_sales_order_salesorderid.................. [PASS in 2.95s]
2021-06-03 18:23:41.349124 (Thread-1): Finished running node test.adventureworks.not_null_fact_sales_order_salesorderid
2021-06-03 18:23:41.349124 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_
2021-06-03 18:23:41.350146 (Thread-1): 15:23:41 | 7 of 17 START test relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_ [RUN]
2021-06-03 18:23:41.351175 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_".
2021-06-03 18:23:41.352137 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_
2021-06-03 18:23:41.366122 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_"
2021-06-03 18:23:41.368016 (Thread-1): finished collecting timing info
2021-06-03 18:23:41.368016 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:23:41.372098 (Thread-1): On test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_"} */

    
    




select count(*) as validation_errors
from (
    select address_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select address_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 18:23:44.034997 (Thread-1): finished collecting timing info
2021-06-03 18:23:44.034997 (Thread-1): 15:23:44 | 7 of 17 PASS relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_ [PASS in 2.68s]
2021-06-03 18:23:44.034997 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_
2021-06-03 18:23:44.047147 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-06-03 18:23:44.047147 (Thread-1): 15:23:44 | 8 of 17 START test relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [RUN]
2021-06-03 18:23:44.048901 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_".
2021-06-03 18:23:44.048901 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-06-03 18:23:44.056885 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_"
2021-06-03 18:23:44.066746 (Thread-1): finished collecting timing info
2021-06-03 18:23:44.066746 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:23:44.072820 (Thread-1): On test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_"} */

    
    




select count(*) as validation_errors
from (
    select creditcard_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select creditcard_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 18:23:46.479812 (Thread-1): finished collecting timing info
2021-06-03 18:23:46.479812 (Thread-1): 15:23:46 | 8 of 17 PASS relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [PASS in 2.43s]
2021-06-03 18:23:46.481752 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-06-03 18:23:46.481752 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_
2021-06-03 18:23:46.482744 (Thread-1): 15:23:46 | 9 of 17 START test relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_ [RUN]
2021-06-03 18:23:46.483819 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_".
2021-06-03 18:23:46.483819 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_
2021-06-03 18:23:46.485861 (Thread-1): unclosed <socket.socket fd=788, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 62343), raddr=('216.58.202.10', 443)>
2021-06-03 18:23:46.485861 (Thread-1): unclosed <socket.socket fd=808, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 62344), raddr=('172.217.162.106', 443)>
2021-06-03 18:23:46.491849 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_"
2021-06-03 18:23:46.493851 (Thread-1): finished collecting timing info
2021-06-03 18:23:46.494865 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:23:46.499818 (Thread-1): On test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_"} */

    
    




select count(*) as validation_errors
from (
    select customer_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select customer_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 18:23:49.204942 (Thread-1): finished collecting timing info
2021-06-03 18:23:49.204942 (Thread-1): 15:23:49 | 9 of 17 PASS relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_ [PASS in 2.72s]
2021-06-03 18:23:49.204942 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_
2021-06-03 18:23:49.217005 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_
2021-06-03 18:23:49.217005 (Thread-1): 15:23:49 | 10 of 17 START test relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_ [RUN]
2021-06-03 18:23:49.219039 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_".
2021-06-03 18:23:49.219039 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_
2021-06-03 18:23:49.227989 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_"
2021-06-03 18:23:49.228964 (Thread-1): finished collecting timing info
2021-06-03 18:23:49.230002 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:23:49.233996 (Thread-1): On test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_"} */

    
    




select count(*) as validation_errors
from (
    select product_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select product_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_product`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 18:23:51.932513 (Thread-1): finished collecting timing info
2021-06-03 18:23:51.932513 (Thread-1): 15:23:51 | 10 of 17 PASS relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_ [PASS in 2.71s]
2021-06-03 18:23:51.932513 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_
2021-06-03 18:23:51.947290 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_
2021-06-03 18:23:51.947290 (Thread-1): 15:23:51 | 11 of 17 START test relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_ [RUN]
2021-06-03 18:23:51.949284 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_".
2021-06-03 18:23:51.949284 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_
2021-06-03 18:23:51.951276 (Thread-1): unclosed <socket.socket fd=1484, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 54845), raddr=('216.58.202.10', 443)>
2021-06-03 18:23:51.952273 (Thread-1): unclosed <socket.socket fd=1508, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 54846), raddr=('172.217.162.106', 443)>
2021-06-03 18:23:51.959250 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_"
2021-06-03 18:23:51.960269 (Thread-1): finished collecting timing info
2021-06-03 18:23:51.960269 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:23:51.966240 (Thread-1): On test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_"} */

    
    




select count(*) as validation_errors
from (
    select salesreason_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select salesreason_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 18:23:54.663246 (Thread-1): finished collecting timing info
2021-06-03 18:23:54.663246 (Thread-1): 15:23:54 | 11 of 17 PASS relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_ [PASS in 2.71s]
2021-06-03 18:23:54.663246 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_
2021-06-03 18:23:54.668379 (Thread-1): Began running node test.adventureworks.sum_qty_test
2021-06-03 18:23:54.668379 (Thread-1): 15:23:54 | 12 of 17 START test sum_qty_test..................................... [RUN]
2021-06-03 18:23:54.670413 (Thread-1): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:23:54.670413 (Thread-1): Compiling test.adventureworks.sum_qty_test
2021-06-03 18:23:54.682377 (Thread-1): Writing injected SQL for node "test.adventureworks.sum_qty_test"
2021-06-03 18:23:54.691476 (Thread-1): finished collecting timing info
2021-06-03 18:23:54.691476 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:23:54.696454 (Thread-1): On test.adventureworks.sum_qty_test: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.sum_qty_test"} */

with dbt__CTE__INTERNAL_test as (
with 
   validation as (
    select sum(orderqty) as sum_qty
    from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order` 
   )
select * from validation where sum_qty != 274914
)select count(*) from dbt__CTE__INTERNAL_test
2021-06-03 18:23:57.599030 (Thread-1): finished collecting timing info
2021-06-03 18:23:57.599030 (Thread-1): 15:23:57 | 12 of 17 FAIL 1 sum_qty_test......................................... [FAIL 1 in 2.93s]
2021-06-03 18:23:57.615874 (Thread-1): Finished running node test.adventureworks.sum_qty_test
2021-06-03 18:23:57.616863 (Thread-1): Began running node test.adventureworks.unique_dim_creditcard_creditcard_sk
2021-06-03 18:23:57.616863 (Thread-1): 15:23:57 | 13 of 17 START test unique_dim_creditcard_creditcard_sk.............. [RUN]
2021-06-03 18:23:57.617862 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_creditcard_creditcard_sk".
2021-06-03 18:23:57.618856 (Thread-1): Compiling test.adventureworks.unique_dim_creditcard_creditcard_sk
2021-06-03 18:23:57.628821 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_creditcard_creditcard_sk"
2021-06-03 18:23:57.629817 (Thread-1): finished collecting timing info
2021-06-03 18:23:57.629817 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:23:57.635798 (Thread-1): On test.adventureworks.unique_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        creditcard_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    where creditcard_sk is not null
    group by creditcard_sk
    having count(*) > 1

) validation_errors



2021-06-03 18:24:00.431684 (Thread-1): finished collecting timing info
2021-06-03 18:24:00.431684 (Thread-1): 15:24:00 | 13 of 17 PASS unique_dim_creditcard_creditcard_sk.................... [PASS in 2.81s]
2021-06-03 18:24:00.431684 (Thread-1): Finished running node test.adventureworks.unique_dim_creditcard_creditcard_sk
2021-06-03 18:24:00.436397 (Thread-1): Began running node test.adventureworks.unique_dim_customer_customer_sk
2021-06-03 18:24:00.436397 (Thread-1): 15:24:00 | 14 of 17 START test unique_dim_customer_customer_sk.................. [RUN]
2021-06-03 18:24:00.437468 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_customer_customer_sk".
2021-06-03 18:24:00.437468 (Thread-1): Compiling test.adventureworks.unique_dim_customer_customer_sk
2021-06-03 18:24:00.439443 (Thread-1): unclosed <socket.socket fd=980, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 57537), raddr=('216.58.202.10', 443)>
2021-06-03 18:24:00.440383 (Thread-1): unclosed <socket.socket fd=792, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 57538), raddr=('172.217.162.106', 443)>
2021-06-03 18:24:00.442518 (Thread-1): unclosed <socket.socket fd=976, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 54843), raddr=('216.58.202.10', 443)>
2021-06-03 18:24:00.443443 (Thread-1): unclosed <socket.socket fd=652, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 54844), raddr=('172.217.162.106', 443)>
2021-06-03 18:24:00.444427 (Thread-1): unclosed <socket.socket fd=984, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 54848), raddr=('216.58.202.10', 443)>
2021-06-03 18:24:00.445369 (Thread-1): unclosed <socket.socket fd=1388, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 54849), raddr=('172.217.162.106', 443)>
2021-06-03 18:24:00.445369 (Thread-1): unclosed <socket.socket fd=1580, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 58137), raddr=('172.217.162.106', 443)>
2021-06-03 18:24:00.446421 (Thread-1): unclosed <socket.socket fd=796, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 58136), raddr=('216.58.202.10', 443)>
2021-06-03 18:24:00.446421 (Thread-1): unclosed <socket.socket fd=340, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53457), raddr=('216.58.202.10', 443)>
2021-06-03 18:24:00.446421 (Thread-1): unclosed <socket.socket fd=712, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53458), raddr=('172.217.162.106', 443)>
2021-06-03 18:24:00.450369 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_customer_customer_sk"
2021-06-03 18:24:00.451417 (Thread-1): finished collecting timing info
2021-06-03 18:24:00.451417 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:24:00.458379 (Thread-1): On test.adventureworks.unique_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    where customer_sk is not null
    group by customer_sk
    having count(*) > 1

) validation_errors



2021-06-03 18:24:03.685746 (Thread-1): finished collecting timing info
2021-06-03 18:24:03.685746 (Thread-1): 15:24:03 | 14 of 17 PASS unique_dim_customer_customer_sk........................ [PASS in 3.25s]
2021-06-03 18:24:03.700269 (Thread-1): Finished running node test.adventureworks.unique_dim_customer_customer_sk
2021-06-03 18:24:03.700269 (Thread-1): Began running node test.adventureworks.unique_dim_localization_address_sk
2021-06-03 18:24:03.700269 (Thread-1): 15:24:03 | 15 of 17 START test unique_dim_localization_address_sk............... [RUN]
2021-06-03 18:24:03.702287 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_localization_address_sk".
2021-06-03 18:24:03.702287 (Thread-1): Compiling test.adventureworks.unique_dim_localization_address_sk
2021-06-03 18:24:03.708789 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_localization_address_sk"
2021-06-03 18:24:03.710784 (Thread-1): finished collecting timing info
2021-06-03 18:24:03.710784 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:24:03.715862 (Thread-1): On test.adventureworks.unique_dim_localization_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_localization_address_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        address_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    where address_sk is not null
    group by address_sk
    having count(*) > 1

) validation_errors



2021-06-03 18:24:06.043333 (Thread-1): finished collecting timing info
2021-06-03 18:24:06.043333 (Thread-1): 15:24:06 | 15 of 17 PASS unique_dim_localization_address_sk..................... [PASS in 2.34s]
2021-06-03 18:24:06.048319 (Thread-1): Finished running node test.adventureworks.unique_dim_localization_address_sk
2021-06-03 18:24:06.048319 (Thread-1): Began running node test.adventureworks.unique_dim_product_product_sk
2021-06-03 18:24:06.049320 (Thread-1): 15:24:06 | 16 of 17 START test unique_dim_product_product_sk.................... [RUN]
2021-06-03 18:24:06.050047 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_product_product_sk".
2021-06-03 18:24:06.050047 (Thread-1): Compiling test.adventureworks.unique_dim_product_product_sk
2021-06-03 18:24:06.053038 (Thread-1): unclosed <socket.socket fd=1028, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53461), raddr=('216.58.202.10', 443)>
2021-06-03 18:24:06.053038 (Thread-1): unclosed <socket.socket fd=1664, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53462), raddr=('172.217.162.106', 443)>
2021-06-03 18:24:06.058019 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_product_product_sk"
2021-06-03 18:24:06.059016 (Thread-1): finished collecting timing info
2021-06-03 18:24:06.059016 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:24:06.064039 (Thread-1): On test.adventureworks.unique_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        product_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    where product_sk is not null
    group by product_sk
    having count(*) > 1

) validation_errors



2021-06-03 18:24:08.727809 (Thread-1): finished collecting timing info
2021-06-03 18:24:08.727809 (Thread-1): 15:24:08 | 16 of 17 PASS unique_dim_product_product_sk.......................... [PASS in 2.68s]
2021-06-03 18:24:08.728807 (Thread-1): Finished running node test.adventureworks.unique_dim_product_product_sk
2021-06-03 18:24:08.728807 (Thread-1): Began running node test.adventureworks.unique_dim_salesreason_salesreason_sk
2021-06-03 18:24:08.728807 (Thread-1): 15:24:08 | 17 of 17 START test unique_dim_salesreason_salesreason_sk............ [RUN]
2021-06-03 18:24:08.729804 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_salesreason_salesreason_sk".
2021-06-03 18:24:08.729804 (Thread-1): Compiling test.adventureworks.unique_dim_salesreason_salesreason_sk
2021-06-03 18:24:08.733796 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_salesreason_salesreason_sk"
2021-06-03 18:24:08.734786 (Thread-1): finished collecting timing info
2021-06-03 18:24:08.734786 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:24:08.741049 (Thread-1): On test.adventureworks.unique_dim_salesreason_salesreason_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_salesreason_salesreason_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        salesreason_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    where salesreason_sk is not null
    group by salesreason_sk
    having count(*) > 1

) validation_errors



2021-06-03 18:24:10.868479 (Thread-1): finished collecting timing info
2021-06-03 18:24:10.868479 (Thread-1): 15:24:10 | 17 of 17 PASS unique_dim_salesreason_salesreason_sk.................. [PASS in 2.14s]
2021-06-03 18:24:10.869640 (Thread-1): Finished running node test.adventureworks.unique_dim_salesreason_salesreason_sk
2021-06-03 18:24:10.946868 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:24:10.947912 (MainThread): 15:24:10 | 
2021-06-03 18:24:10.948878 (MainThread): 15:24:10 | Finished running 17 tests in 47.72s.
2021-06-03 18:24:10.949906 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:24:10.949906 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:24:10.949906 (MainThread): Connection 'test.adventureworks.unique_dim_salesreason_salesreason_sk' was properly closed.
2021-06-03 18:24:10.962821 (MainThread): 
2021-06-03 18:24:10.962821 (MainThread): Completed with 1 error and 0 warnings:
2021-06-03 18:24:10.963821 (MainThread): 
2021-06-03 18:24:10.964886 (MainThread): Failure in test sum_qty_test (tests\sum_qty_test.sql)
2021-06-03 18:24:10.965809 (MainThread):   Got 1 result, expected 0.
2021-06-03 18:24:10.966844 (MainThread): 
2021-06-03 18:24:10.966844 (MainThread):   compiled SQL at target\compiled\adventureworks\tests\sum_qty_test.sql
2021-06-03 18:24:10.967802 (MainThread): 
Done. PASS=16 WARN=0 ERROR=1 SKIP=0 TOTAL=17
2021-06-03 18:24:10.969797 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219472B34C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194620AE48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021942553F88>]}
2021-06-03 18:24:10.969797 (MainThread): Flushing usage events
2021-06-03 18:24:31.857968 (MainThread): Running with dbt=0.19.1
2021-06-03 18:24:32.172312 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:24:32.172312 (MainThread): Tracking: tracking
2021-06-03 18:24:32.172312 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011449280BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011449280B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011449280A08>]}
2021-06-03 18:24:32.185206 (MainThread): Partial parsing not enabled
2021-06-03 18:24:32.185206 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:24:32.203456 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:24:32.203456 (MainThread): Parsing macros\etc.sql
2021-06-03 18:24:32.211758 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:24:32.214021 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:24:32.224346 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:24:32.224346 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:24:32.232598 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:24:32.234888 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:24:32.245127 (MainThread): Parsing macros\core.sql
2021-06-03 18:24:32.245127 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:24:32.286654 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:24:32.294844 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:24:32.294844 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:24:32.294844 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:24:32.304997 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:24:32.304997 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:24:32.307254 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:24:32.315553 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:24:32.327986 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:24:32.327986 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:24:32.336241 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:24:32.348695 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:24:32.387816 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:24:32.389807 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:24:32.399919 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:24:32.410391 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:24:32.410391 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:24:32.420749 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:24:32.420749 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:24:32.420749 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:24:32.428891 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:24:32.431141 (MainThread): Partial parsing not enabled
2021-06-03 18:24:32.451764 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:24:32.461984 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:24:32.472401 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:24:32.472401 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:24:32.480624 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:24:32.482805 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:24:32.491049 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:24:32.493301 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:24:32.493301 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:24:32.501478 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:24:32.503643 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:24:32.503643 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:24:32.514083 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:24:32.514083 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:24:32.514083 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:24:32.524434 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:24:32.524434 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:24:32.532693 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:24:32.534898 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:24:32.534898 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:24:32.545272 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:24:32.545272 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:24:32.555695 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:24:32.730067 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114492BB788>]}
2021-06-03 18:24:32.748278 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144CF2E488>]}
2021-06-03 18:24:32.748278 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:24:32.754841 (MainThread): 
2021-06-03 18:24:32.755856 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:24:32.758792 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:24:32.759790 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:24:33.329990 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:24:33.329990 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:24:33.337965 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:24:34.390061 (MainThread): 15:24:34 | Concurrency: 1 threads (target='dev')
2021-06-03 18:24:34.405691 (MainThread): 15:24:34 | 
2021-06-03 18:24:34.411497 (Thread-1): Began running node model.adventureworks.stg_address
2021-06-03 18:24:34.412503 (Thread-1): 15:24:34 | 1 of 22 START view model dbt_arthur.stg_address...................... [RUN]
2021-06-03 18:24:34.413455 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:24:34.413455 (Thread-1): Compiling model.adventureworks.stg_address
2021-06-03 18:24:34.417440 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_address"
2021-06-03 18:24:34.419430 (Thread-1): finished collecting timing info
2021-06-03 18:24:34.455038 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_address"
2021-06-03 18:24:34.456030 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:24:34.460018 (Thread-1): On model.adventureworks.stg_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_address"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_address`
  OPTIONS()
  as with 
    source as (
        select 
         stateprovinceid
         ,postalcode
         ,addressid		
         ,city			
         ,addressline2			
         ,modifieddate 
         ,_sdc_batched_at	
         ,_sdc_extracted_at as last_etl_run
         ,_sdc_table_version
         ,_sdc_received_at	
         ,_sdc_sequence						
        from `adventureworks-314121`.`adventureworks`.`address`
    )
select * from source;


2021-06-03 18:24:35.686639 (Thread-1): finished collecting timing info
2021-06-03 18:24:35.686639 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144B23D648>]}
2021-06-03 18:24:35.686639 (Thread-1): 15:24:35 | 1 of 22 OK created view model dbt_arthur.stg_address................. [OK in 1.27s]
2021-06-03 18:24:35.686639 (Thread-1): Finished running node model.adventureworks.stg_address
2021-06-03 18:24:35.686639 (Thread-1): Began running node model.adventureworks.stg_businessentitycontact
2021-06-03 18:24:35.691133 (Thread-1): 15:24:35 | 2 of 22 START view model dbt_arthur.stg_businessentitycontact........ [RUN]
2021-06-03 18:24:35.692157 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:24:35.692157 (Thread-1): Compiling model.adventureworks.stg_businessentitycontact
2021-06-03 18:24:35.692157 (Thread-1): unclosed <socket.socket fd=1112, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53476), raddr=('216.58.202.10', 443)>
2021-06-03 18:24:35.693130 (Thread-1): unclosed <socket.socket fd=1124, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53477), raddr=('172.217.162.106', 443)>
2021-06-03 18:24:35.696139 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_businessentitycontact"
2021-06-03 18:24:35.698112 (Thread-1): finished collecting timing info
2021-06-03 18:24:35.700103 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_businessentitycontact"
2021-06-03 18:24:35.701100 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:24:35.706135 (Thread-1): On model.adventureworks.stg_businessentitycontact: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_businessentitycontact"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_businessentitycontact`
  OPTIONS()
  as with 
    source as (
        select 
            personid
            ,businessentityid			
            ,modifieddate			
            ,rowguid			
            ,contacttypeid
            ,_sdc_batched_at	
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence							
         from `adventureworks-314121`.`adventureworks`.`businessentitycontact`
    )
select * from source;


2021-06-03 18:24:37.781589 (Thread-1): finished collecting timing info
2021-06-03 18:24:37.781589 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011449232508>]}
2021-06-03 18:24:37.781589 (Thread-1): 15:24:37 | 2 of 22 OK created view model dbt_arthur.stg_businessentitycontact... [OK in 2.09s]
2021-06-03 18:24:37.781589 (Thread-1): Finished running node model.adventureworks.stg_businessentitycontact
2021-06-03 18:24:37.787513 (Thread-1): Began running node model.adventureworks.stg_creditcard
2021-06-03 18:24:37.787513 (Thread-1): 15:24:37 | 3 of 22 START view model dbt_arthur.stg_creditcard................... [RUN]
2021-06-03 18:24:37.788509 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:24:37.788509 (Thread-1): Compiling model.adventureworks.stg_creditcard
2021-06-03 18:24:37.791647 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_creditcard"
2021-06-03 18:24:37.792603 (Thread-1): finished collecting timing info
2021-06-03 18:24:37.796595 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_creditcard"
2021-06-03 18:24:37.797631 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:24:37.802615 (Thread-1): On model.adventureworks.stg_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_creditcard"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_creditcard`
  OPTIONS()
  as with 
    source as (
        select * from `adventureworks-314121`.`adventureworks`.`creditcard`
    )
select * from source;


2021-06-03 18:24:37.914870 (Thread-1): unclosed <socket.socket fd=704, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53478), raddr=('216.58.202.10', 443)>
2021-06-03 18:24:37.914870 (Thread-1): unclosed <socket.socket fd=1164, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53479), raddr=('172.217.162.106', 443)>
2021-06-03 18:24:40.019937 (Thread-1): finished collecting timing info
2021-06-03 18:24:40.019937 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144CE10848>]}
2021-06-03 18:24:40.019937 (Thread-1): 15:24:40 | 3 of 22 OK created view model dbt_arthur.stg_creditcard.............. [OK in 2.23s]
2021-06-03 18:24:40.019937 (Thread-1): Finished running node model.adventureworks.stg_creditcard
2021-06-03 18:24:40.027200 (Thread-1): Began running node model.adventureworks.stg_customer
2021-06-03 18:24:40.027200 (Thread-1): 15:24:40 | 4 of 22 START view model dbt_arthur.stg_customer..................... [RUN]
2021-06-03 18:24:40.028197 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:24:40.029193 (Thread-1): Compiling model.adventureworks.stg_customer
2021-06-03 18:24:40.032228 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_customer"
2021-06-03 18:24:40.034174 (Thread-1): finished collecting timing info
2021-06-03 18:24:40.037167 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_customer"
2021-06-03 18:24:40.038199 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:24:40.044143 (Thread-1): On model.adventureworks.stg_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_customer"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_customer`
  OPTIONS()
  as with 
    source as (
        select 
            customerid
            ,personid	
            ,modifieddate	
            ,rowguid		
            ,territoryid		
            ,storeid		
            ,_sdc_batched_at	
            ,_sdc_extracted_at as last_etl_run
            ,_sdc_table_version
            ,_sdc_received_at	
            ,_sdc_sequence	
        
        from `adventureworks-314121`.`adventureworks`.`customer`
    )
select * from source;


2021-06-03 18:24:42.086360 (Thread-1): finished collecting timing info
2021-06-03 18:24:42.086360 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144CDACE88>]}
2021-06-03 18:24:42.086360 (Thread-1): 15:24:42 | 4 of 22 OK created view model dbt_arthur.stg_customer................ [OK in 2.06s]
2021-06-03 18:24:42.101731 (Thread-1): Finished running node model.adventureworks.stg_customer
2021-06-03 18:24:42.101731 (Thread-1): Began running node model.adventureworks.stg_person
2021-06-03 18:24:42.102268 (Thread-1): 15:24:42 | 5 of 22 START view model dbt_arthur.stg_person....................... [RUN]
2021-06-03 18:24:42.103265 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:24:42.103265 (Thread-1): Compiling model.adventureworks.stg_person
2021-06-03 18:24:42.103265 (Thread-1): unclosed <socket.socket fd=1244, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53482), raddr=('216.58.202.10', 443)>
2021-06-03 18:24:42.104265 (Thread-1): unclosed <socket.socket fd=1188, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53483), raddr=('172.217.162.106', 443)>
2021-06-03 18:24:42.107329 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_person"
2021-06-03 18:24:42.108502 (Thread-1): finished collecting timing info
2021-06-03 18:24:42.108502 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_person"
2021-06-03 18:24:42.108502 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:24:42.108502 (Thread-1): On model.adventureworks.stg_person: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_person"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_person`
  OPTIONS()
  as with 
    source as (
        select 
            businessentityid
            ,firstname 
            ,lastname
            ,persontype
            ,namestyle
            ,suffix	
            ,modifieddate
            ,rowguid
            ,emailpromotion			
            ,middlename
            ,_sdc_batched_at			
            ,_sdc_extracted_at as last_etl_run           			
            ,_sdc_received_at			
            ,_sdc_sequence
            ,_sdc_table_version	        
        from `adventureworks-314121`.`adventureworks`.`person`
    )
select * from source;


2021-06-03 18:24:44.128837 (Thread-1): finished collecting timing info
2021-06-03 18:24:44.128837 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144CF7DDC8>]}
2021-06-03 18:24:44.128837 (Thread-1): 15:24:44 | 5 of 22 OK created view model dbt_arthur.stg_person.................. [OK in 2.03s]
2021-06-03 18:24:44.142070 (Thread-1): Finished running node model.adventureworks.stg_person
2021-06-03 18:24:44.142070 (Thread-1): Began running node model.adventureworks.stg_personcreditcard
2021-06-03 18:24:44.143066 (Thread-1): 15:24:44 | 6 of 22 START view model dbt_arthur.stg_personcreditcard............. [RUN]
2021-06-03 18:24:44.143859 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:24:44.143859 (Thread-1): Compiling model.adventureworks.stg_personcreditcard
2021-06-03 18:24:44.146852 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_personcreditcard"
2021-06-03 18:24:44.147850 (Thread-1): finished collecting timing info
2021-06-03 18:24:44.149842 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_personcreditcard"
2021-06-03 18:24:44.150838 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:24:44.156819 (Thread-1): On model.adventureworks.stg_personcreditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_personcreditcard"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_personcreditcard`
  OPTIONS()
  as with 
    source as (
        select * from `adventureworks-314121`.`adventureworks`.`personcreditcard`
    )
select * from source;


2021-06-03 18:24:46.168869 (Thread-1): finished collecting timing info
2021-06-03 18:24:46.184552 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144CCAB848>]}
2021-06-03 18:24:46.184552 (Thread-1): 15:24:46 | 6 of 22 OK created view model dbt_arthur.stg_personcreditcard........ [OK in 2.04s]
2021-06-03 18:24:46.186477 (Thread-1): Finished running node model.adventureworks.stg_personcreditcard
2021-06-03 18:24:46.186477 (Thread-1): Began running node model.adventureworks.stg_product
2021-06-03 18:24:46.186477 (Thread-1): 15:24:46 | 7 of 22 START view model dbt_arthur.stg_product...................... [RUN]
2021-06-03 18:24:46.188471 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:24:46.188471 (Thread-1): Compiling model.adventureworks.stg_product
2021-06-03 18:24:46.191476 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_product"
2021-06-03 18:24:46.193454 (Thread-1): finished collecting timing info
2021-06-03 18:24:46.195495 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_product"
2021-06-03 18:24:46.196443 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:24:46.201427 (Thread-1): On model.adventureworks.stg_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_product"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_product`
  OPTIONS()
  as with 
    source as (
        select 
            productid
            ,productsubcategoryid		
            ,productmodelid   
            ,name as productname         
            ,safetystocklevel			
            ,class						
            ,productnumber						
            ,modifieddate			
            ,rowguid						
            ,weightunitmeasurecode			
            ,standardcost									
            ,sizeunitmeasurecode										
            ,listprice						
            ,productline			
            ,size							
            ,weight
            ,_sdc_batched_at			
            ,_sdc_extracted_at as last_etl_run           			
            ,_sdc_received_at			
            ,_sdc_sequence
            ,_sdc_table_version	                   
        from `adventureworks-314121`.`adventureworks`.`product`
    )
select * from source;


2021-06-03 18:24:47.698413 (Thread-1): finished collecting timing info
2021-06-03 18:24:47.698413 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144CC9B808>]}
2021-06-03 18:24:47.698413 (Thread-1): 15:24:47 | 7 of 22 OK created view model dbt_arthur.stg_product................. [OK in 1.51s]
2021-06-03 18:24:47.698413 (Thread-1): Finished running node model.adventureworks.stg_product
2021-06-03 18:24:47.705769 (Thread-1): Began running node model.adventureworks.stg_salesorderheadersalesreason
2021-06-03 18:24:47.705769 (Thread-1): 15:24:47 | 8 of 22 START view model dbt_arthur.stg_salesorderheadersalesreason.. [RUN]
2021-06-03 18:24:47.707763 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:24:47.707763 (Thread-1): Compiling model.adventureworks.stg_salesorderheadersalesreason
2021-06-03 18:24:47.710752 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_salesorderheadersalesreason"
2021-06-03 18:24:47.712747 (Thread-1): finished collecting timing info
2021-06-03 18:24:47.716785 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_salesorderheadersalesreason"
2021-06-03 18:24:47.717730 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:24:47.723166 (Thread-1): On model.adventureworks.stg_salesorderheadersalesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_salesorderheadersalesreason"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason`
  OPTIONS()
  as with 
    source as (
        select distinct * from `adventureworks-314121`.`adventureworks`.`salesorderheadersalesreason`
    )
select * from source;


2021-06-03 18:24:49.854921 (Thread-1): finished collecting timing info
2021-06-03 18:24:49.854921 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011449327EC8>]}
2021-06-03 18:24:49.855949 (Thread-1): 15:24:49 | 8 of 22 OK created view model dbt_arthur.stg_salesorderheadersalesreason [OK in 2.15s]
2021-06-03 18:24:49.856914 (Thread-1): Finished running node model.adventureworks.stg_salesorderheadersalesreason
2021-06-03 18:24:49.856914 (Thread-1): Began running node model.adventureworks.stg_salesreason
2021-06-03 18:24:49.856914 (Thread-1): 15:24:49 | 9 of 22 START view model dbt_arthur.stg_salesreason.................. [RUN]
2021-06-03 18:24:49.857907 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:24:49.857907 (Thread-1): Compiling model.adventureworks.stg_salesreason
2021-06-03 18:24:49.862894 (Thread-1): unclosed <socket.socket fd=1284, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53484), raddr=('216.58.202.10', 443)>
2021-06-03 18:24:49.863595 (Thread-1): unclosed <socket.socket fd=1228, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53485), raddr=('172.217.162.106', 443)>
2021-06-03 18:24:49.863595 (Thread-1): unclosed <socket.socket fd=1320, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53486), raddr=('216.58.202.10', 443)>
2021-06-03 18:24:49.864406 (Thread-1): unclosed <socket.socket fd=1328, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53487), raddr=('172.217.162.106', 443)>
2021-06-03 18:24:49.865420 (Thread-1): unclosed <socket.socket fd=1344, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53488), raddr=('216.58.202.10', 443)>
2021-06-03 18:24:49.866400 (Thread-1): unclosed <socket.socket fd=1352, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53489), raddr=('172.217.162.106', 443)>
2021-06-03 18:24:49.866400 (Thread-1): unclosed <socket.socket fd=1044, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53490), raddr=('216.58.202.10', 443)>
2021-06-03 18:24:49.867406 (Thread-1): unclosed <socket.socket fd=1408, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53491), raddr=('172.217.162.106', 443)>
2021-06-03 18:24:49.869445 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_salesreason"
2021-06-03 18:24:49.869445 (Thread-1): finished collecting timing info
2021-06-03 18:24:49.872397 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_salesreason"
2021-06-03 18:24:49.873377 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:24:49.879232 (Thread-1): On model.adventureworks.stg_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_salesreason"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
  OPTIONS()
  as with 
    source as (
        select distinct 
         salesreasonid			
         ,name as salereason			
         ,modifieddate			
         ,_sdc_batched_at			
         ,_sdc_extracted_at as last_etl_run           			
         ,_sdc_received_at			
         ,_sdc_sequence
         ,_sdc_table_version			
         from `adventureworks-314121`.`adventureworks`.`salesreason`
    )
select * from source;


2021-06-03 18:24:51.965626 (Thread-1): finished collecting timing info
2021-06-03 18:24:51.966625 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144CCC9C88>]}
2021-06-03 18:24:51.966625 (Thread-1): 15:24:51 | 9 of 22 OK created view model dbt_arthur.stg_salesreason............. [OK in 2.11s]
2021-06-03 18:24:51.968680 (Thread-1): Finished running node model.adventureworks.stg_salesreason
2021-06-03 18:24:51.968680 (Thread-1): Began running node model.adventureworks.stg_salesterritory
2021-06-03 18:24:51.969681 (Thread-1): 15:24:51 | 10 of 22 START view model dbt_arthur.stg_salesterritory.............. [RUN]
2021-06-03 18:24:51.969681 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:24:51.969681 (Thread-1): Compiling model.adventureworks.stg_salesterritory
2021-06-03 18:24:51.970676 (Thread-1): unclosed <socket.socket fd=1428, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53492), raddr=('216.58.202.10', 443)>
2021-06-03 18:24:51.971673 (Thread-1): unclosed <socket.socket fd=1360, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53493), raddr=('172.217.162.106', 443)>
2021-06-03 18:24:51.974663 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_salesterritory"
2021-06-03 18:24:51.975659 (Thread-1): finished collecting timing info
2021-06-03 18:24:51.978650 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_salesterritory"
2021-06-03 18:24:51.979646 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:24:51.985625 (Thread-1): On model.adventureworks.stg_salesterritory: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_salesterritory"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_salesterritory`
  OPTIONS()
  as with 
    source as (
        select *
         from `adventureworks-314121`.`adventureworks`.`salesterritory`
    )
select * from source;


2021-06-03 18:24:53.658506 (Thread-1): finished collecting timing info
2021-06-03 18:24:53.658506 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144CFCA648>]}
2021-06-03 18:24:53.659487 (Thread-1): 15:24:53 | 10 of 22 OK created view model dbt_arthur.stg_salesterritory......... [OK in 1.69s]
2021-06-03 18:24:53.661431 (Thread-1): Finished running node model.adventureworks.stg_salesterritory
2021-06-03 18:24:53.661431 (Thread-1): Began running node model.adventureworks.stg_stateprovince
2021-06-03 18:24:53.662428 (Thread-1): 15:24:53 | 11 of 22 START view model dbt_arthur.stg_stateprovince............... [RUN]
2021-06-03 18:24:53.663426 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:24:53.663426 (Thread-1): Compiling model.adventureworks.stg_stateprovince
2021-06-03 18:24:53.664422 (Thread-1): unclosed <socket.socket fd=1432, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53494), raddr=('216.58.202.10', 443)>
2021-06-03 18:24:53.664422 (Thread-1): unclosed <socket.socket fd=1416, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53495), raddr=('172.217.162.106', 443)>
2021-06-03 18:24:53.667411 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_stateprovince"
2021-06-03 18:24:53.669404 (Thread-1): finished collecting timing info
2021-06-03 18:24:53.672395 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_stateprovince"
2021-06-03 18:24:53.674388 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:24:53.680368 (Thread-1): On model.adventureworks.stg_stateprovince: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_stateprovince"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_stateprovince`
  OPTIONS()
  as with 
    source as (
        select 
         stateprovinceid
         ,territoryid
         ,name as statename 			
         ,countryregioncode as countryregionid		
         ,modifieddate			
         ,rowguid									
         ,isonlystateprovinceflag			
         ,stateprovincecode			
         ,_sdc_batched_at	
         ,_sdc_extracted_at as last_etl_run
         ,_sdc_table_version
         ,_sdc_received_at	
         ,_sdc_sequence					
        from `adventureworks-314121`.`adventureworks`.`stateprovince`
    )
select * from source;


2021-06-03 18:24:55.677385 (Thread-1): finished collecting timing info
2021-06-03 18:24:55.677385 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144E01BD08>]}
2021-06-03 18:24:55.677385 (Thread-1): 15:24:55 | 11 of 22 OK created view model dbt_arthur.stg_stateprovince.......... [OK in 2.01s]
2021-06-03 18:24:55.679948 (Thread-1): Finished running node model.adventureworks.stg_stateprovince
2021-06-03 18:24:55.679948 (Thread-1): Began running node model.adventureworks.stg_salesorderdetail
2021-06-03 18:24:55.679948 (Thread-1): 15:24:55 | 12 of 22 START view model dbt_arthur.stg_salesorderdetail............ [RUN]
2021-06-03 18:24:55.681985 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:24:55.681985 (Thread-1): Compiling model.adventureworks.stg_salesorderdetail
2021-06-03 18:24:55.685934 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_salesorderdetail"
2021-06-03 18:24:55.687966 (Thread-1): finished collecting timing info
2021-06-03 18:24:55.689963 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_salesorderdetail"
2021-06-03 18:24:55.690913 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:24:55.695899 (Thread-1): On model.adventureworks.stg_salesorderdetail: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_salesorderdetail"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_salesorderdetail`
  OPTIONS()
  as with 
    source as (
        select 
         salesorderdetailid
         ,salesorderid
         ,specialofferid
         ,orderqty			
         ,unitprice			
		 ,modifieddate			
         ,rowguid			
         ,productid			
         ,carriertrackingnumber			
         ,unitpricediscount
         ,_sdc_batched_at	
         ,_sdc_extracted_at as last_etl_run
         ,_sdc_table_version
         ,_sdc_received_at	
         ,_sdc_sequence		
         from `adventureworks-314121`.`adventureworks`.`salesorderdetail`
    )
    , source1 as (
        select 
         salesorderdetailid
         ,salesorderid
         ,specialofferid
         ,orderqty			
         ,unitprice					
         ,productid	
        from source
        )		
select * from source1;


2021-06-03 18:24:57.906421 (Thread-1): finished collecting timing info
2021-06-03 18:24:57.921799 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144E00F288>]}
2021-06-03 18:24:57.922141 (Thread-1): 15:24:57 | 12 of 22 OK created view model dbt_arthur.stg_salesorderdetail....... [OK in 2.24s]
2021-06-03 18:24:57.924207 (Thread-1): Finished running node model.adventureworks.stg_salesorderdetail
2021-06-03 18:24:57.924744 (Thread-1): Began running node model.adventureworks.stg_salesorderheader
2021-06-03 18:24:57.924744 (Thread-1): 15:24:57 | 13 of 22 START view model dbt_arthur.stg_salesorderheader............ [RUN]
2021-06-03 18:24:57.925410 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:24:57.925410 (Thread-1): Compiling model.adventureworks.stg_salesorderheader
2021-06-03 18:24:57.928957 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_salesorderheader"
2021-06-03 18:24:57.929953 (Thread-1): finished collecting timing info
2021-06-03 18:24:57.932935 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_salesorderheader"
2021-06-03 18:24:57.933944 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:24:57.938870 (Thread-1): On model.adventureworks.stg_salesorderheader: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_salesorderheader"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheader`
  OPTIONS()
  as with 
    source as (
        select 
            salesorderid  
            ,customerid				
            ,shipmethodid
            ,shiptoaddressid as addressid					
            ,billtoaddressid			
            ,salespersonid
            ,territoryid					
            ,currencyrateid	            
            ,status	
            ,totaldue
            ,orderdate			
            ,modifieddate			
            ,rowguid
            ,purchaseordernumber			
            ,taxamt						
            ,onlineorderflag														
            ,creditcardapprovalcode			
            ,subtotal			
            ,creditcardid						
            ,freight			
            ,duedate													
            ,_sdc_batched_at			
            ,_sdc_extracted_at as last_etl_run           			
            ,_sdc_received_at			
            ,_sdc_sequence
            ,_sdc_table_version			
        from `adventureworks-314121`.`adventureworks`.`salesorderheader`
    )
select * from source;


2021-06-03 18:24:59.931659 (Thread-1): finished collecting timing info
2021-06-03 18:24:59.932655 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144E05D108>]}
2021-06-03 18:24:59.933653 (Thread-1): 15:24:59 | 13 of 22 OK created view model dbt_arthur.stg_salesorderheader....... [OK in 2.01s]
2021-06-03 18:24:59.935129 (Thread-1): Finished running node model.adventureworks.stg_salesorderheader
2021-06-03 18:24:59.935129 (Thread-1): Began running node model.adventureworks.stg_countryregion
2021-06-03 18:24:59.936091 (Thread-1): 15:24:59 | 14 of 22 START view model dbt_arthur.stg_countryregion............... [RUN]
2021-06-03 18:24:59.937084 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:24:59.937084 (Thread-1): Compiling model.adventureworks.stg_countryregion
2021-06-03 18:24:59.941116 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_countryregion"
2021-06-03 18:24:59.942499 (Thread-1): finished collecting timing info
2021-06-03 18:24:59.945013 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_countryregion"
2021-06-03 18:24:59.945013 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:24:59.948566 (Thread-1): On model.adventureworks.stg_countryregion: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_countryregion"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_countryregion`
  OPTIONS()
  as with 
    source as (
        select 
         name as country						
         ,countryregioncode as countryregionid
         ,modifieddate			
         ,_sdc_batched_at	
         ,_sdc_extracted_at as last_etl_run
         ,_sdc_table_version
         ,_sdc_received_at	
         ,_sdc_sequence			
        from `adventureworks-314121`.`adventureworks`.`countryregion`
    )
select * from source;


2021-06-03 18:24:59.948566 (Thread-1): unclosed <socket.socket fd=1492, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53496), raddr=('216.58.202.10', 443)>
2021-06-03 18:24:59.948566 (Thread-1): unclosed <socket.socket fd=1440, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53497), raddr=('172.217.162.106', 443)>
2021-06-03 18:24:59.948566 (Thread-1): unclosed <socket.socket fd=1524, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53498), raddr=('216.58.202.10', 443)>
2021-06-03 18:24:59.948566 (Thread-1): unclosed <socket.socket fd=1532, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53499), raddr=('172.217.162.106', 443)>
2021-06-03 18:24:59.948566 (Thread-1): unclosed <socket.socket fd=1576, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53500), raddr=('216.58.202.10', 443)>
2021-06-03 18:24:59.948566 (Thread-1): unclosed <socket.socket fd=1592, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53501), raddr=('172.217.162.106', 443)>
2021-06-03 18:25:02.059135 (Thread-1): finished collecting timing info
2021-06-03 18:25:02.060129 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144E05DA48>]}
2021-06-03 18:25:02.060129 (Thread-1): 15:25:02 | 14 of 22 OK created view model dbt_arthur.stg_countryregion.......... [OK in 2.12s]
2021-06-03 18:25:02.062076 (Thread-1): Finished running node model.adventureworks.stg_countryregion
2021-06-03 18:25:02.063095 (Thread-1): Began running node model.adventureworks.stg_productlistpricehistory
2021-06-03 18:25:02.063095 (Thread-1): 15:25:02 | 15 of 22 START view model dbt_arthur.stg_productlistpricehistory..... [RUN]
2021-06-03 18:25:02.064066 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:25:02.064066 (Thread-1): Compiling model.adventureworks.stg_productlistpricehistory
2021-06-03 18:25:02.068052 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_productlistpricehistory"
2021-06-03 18:25:02.070046 (Thread-1): finished collecting timing info
2021-06-03 18:25:02.073046 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_productlistpricehistory"
2021-06-03 18:25:02.075029 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:25:02.080011 (Thread-1): On model.adventureworks.stg_productlistpricehistory: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_productlistpricehistory"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_productlistpricehistory`
  OPTIONS()
  as with 
    source as (
        select * from `adventureworks-314121`.`adventureworks`.`productlistpricehistory`
    )
select * from source;


2021-06-03 18:25:04.108058 (Thread-1): finished collecting timing info
2021-06-03 18:25:04.108058 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144E0BDEC8>]}
2021-06-03 18:25:04.108058 (Thread-1): 15:25:04 | 15 of 22 OK created view model dbt_arthur.stg_productlistpricehistory [OK in 2.04s]
2021-06-03 18:25:04.108058 (Thread-1): Finished running node model.adventureworks.stg_productlistpricehistory
2021-06-03 18:25:04.108058 (Thread-1): Began running node model.adventureworks.stg_store
2021-06-03 18:25:04.118203 (Thread-1): 15:25:04 | 16 of 22 START view model dbt_arthur.stg_store....................... [RUN]
2021-06-03 18:25:04.119199 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:25:04.119199 (Thread-1): Compiling model.adventureworks.stg_store
2021-06-03 18:25:04.120194 (Thread-1): unclosed <socket.socket fd=1632, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53505), raddr=('216.58.202.10', 443)>
2021-06-03 18:25:04.120194 (Thread-1): unclosed <socket.socket fd=1640, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53506), raddr=('172.217.162.106', 443)>
2021-06-03 18:25:04.123184 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_store"
2021-06-03 18:25:04.124181 (Thread-1): finished collecting timing info
2021-06-03 18:25:04.128167 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_store"
2021-06-03 18:25:04.129164 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:25:04.134167 (Thread-1): On model.adventureworks.stg_store: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_store"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_store`
  OPTIONS()
  as with 
    source as (
        select * from `adventureworks-314121`.`adventureworks`.`store`
    )
select * from source;


2021-06-03 18:25:06.435250 (Thread-1): finished collecting timing info
2021-06-03 18:25:06.435250 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144E0C8348>]}
2021-06-03 18:25:06.435250 (Thread-1): 15:25:06 | 16 of 22 OK created view model dbt_arthur.stg_store.................. [OK in 2.32s]
2021-06-03 18:25:06.438268 (Thread-1): Finished running node model.adventureworks.stg_store
2021-06-03 18:25:06.438268 (Thread-1): Began running node model.adventureworks.dim_customer
2021-06-03 18:25:06.439269 (Thread-1): 15:25:06 | 17 of 22 START table model dbt_arthur.dim_customer................... [RUN]
2021-06-03 18:25:06.440260 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:25:06.440260 (Thread-1): Compiling model.adventureworks.dim_customer
2021-06-03 18:25:06.445301 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_customer"
2021-06-03 18:25:06.446288 (Thread-1): finished collecting timing info
2021-06-03 18:25:06.462235 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:25:06.469188 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:25:07.632011 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_customer"
2021-06-03 18:25:07.632011 (Thread-1): On model.adventureworks.dim_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_customer"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_customer`
  
  
  OPTIONS()
  as (
    with 
    sourcecustomer as (
        select 
            customerid
 
        from `adventureworks-314121`.`dbt_arthur`.`stg_customer`       
    )
    , transformed as (
        select
         row_number () over (order by customerid) as customer_sk 
         ,*
        from sourcecustomer
    )
select distinct * from transformed
  );
    
2021-06-03 18:25:10.577500 (Thread-1): finished collecting timing info
2021-06-03 18:25:10.577500 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144E097C88>]}
2021-06-03 18:25:10.577500 (Thread-1): 15:25:10 | 17 of 22 OK created table model dbt_arthur.dim_customer.............. [CREATE TABLE (19.8k rows, 154.8 KB processed) in 4.14s]
2021-06-03 18:25:10.577500 (Thread-1): Finished running node model.adventureworks.dim_customer
2021-06-03 18:25:10.591715 (Thread-1): Began running node model.adventureworks.dim_creditcard
2021-06-03 18:25:10.591715 (Thread-1): 15:25:10 | 18 of 22 START table model dbt_arthur.dim_creditcard................. [RUN]
2021-06-03 18:25:10.592752 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:25:10.593715 (Thread-1): Compiling model.adventureworks.dim_creditcard
2021-06-03 18:25:10.599728 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_creditcard"
2021-06-03 18:25:10.600686 (Thread-1): finished collecting timing info
2021-06-03 18:25:10.601717 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:25:10.605714 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:25:11.695909 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_creditcard"
2021-06-03 18:25:11.695909 (Thread-1): On model.adventureworks.dim_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_creditcard"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
  
  
  OPTIONS()
  as (
    with 
    sourceperson as (
        select 
            businessentityid
            ,firstname 
            ,lastname
            ,persontype
            ,namestyle
            ,suffix	
            ,modifieddate
            ,rowguid
            ,emailpromotion			
            ,middlename       
        from `adventureworks-314121`.`dbt_arthur`.`stg_person`  
    )
    ,sourcebusinessentitycontact as (
        select 
            personid
            ,businessentityid			
            ,modifieddate			
            ,rowguid			
            ,contacttypeid
        from `adventureworks-314121`.`dbt_arthur`.`stg_businessentitycontact`
    )
    ,sourcecreditcard as (
        select 
            creditcardid
            ,cardtype	
            ,expyear	
            ,modifieddate	
            ,cardnumber	
            ,expmonth	

        from `adventureworks-314121`.`dbt_arthur`.`stg_creditcard` 
    ) 
    , sourcepersoncreditcard as (
        select 
            businessentityid
            ,creditcardid	 	 	
            ,modifieddate		 		

        from `adventureworks-314121`.`dbt_arthur`.`stg_personcreditcard` 
    )  
    , selected as (
        select 
         sourceperson.businessentityid,
         sourceperson.firstname,
         sourceperson.lastname, 
         sourcecreditcard.cardtype,
         sourcepersoncreditcard.creditcardid

        from sourceperson 
        left join sourcepersoncreditcard on sourceperson.businessentityid = sourcepersoncreditcard.businessentityid
        left join sourcecreditcard on sourcepersoncreditcard.creditcardid = sourcecreditcard.creditcardid
        
     )
    , transformed as (
        select 
           row_number() over (order by creditcardid) as creditcard_sk
           , *
        from selected
    )
select distinct * from transformed
  );
    
2021-06-03 18:25:14.950814 (Thread-1): finished collecting timing info
2021-06-03 18:25:14.950814 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000114492C0FC8>]}
2021-06-03 18:25:14.950814 (Thread-1): 15:25:14 | 18 of 22 OK created table model dbt_arthur.dim_creditcard............ [CREATE TABLE (20.0k rows, 1.1 MB processed) in 4.36s]
2021-06-03 18:25:14.963053 (Thread-1): Finished running node model.adventureworks.dim_creditcard
2021-06-03 18:25:14.963053 (Thread-1): Began running node model.adventureworks.dim_product
2021-06-03 18:25:14.963053 (Thread-1): 15:25:14 | 19 of 22 START table model dbt_arthur.dim_product.................... [RUN]
2021-06-03 18:25:14.965048 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:25:14.965048 (Thread-1): Compiling model.adventureworks.dim_product
2021-06-03 18:25:14.970532 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_product"
2021-06-03 18:25:14.974462 (Thread-1): finished collecting timing info
2021-06-03 18:25:14.976457 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:25:14.983801 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:25:14.985778 (Thread-1): unclosed <socket.socket fd=1664, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53507), raddr=('216.58.202.10', 443)>
2021-06-03 18:25:14.985778 (Thread-1): unclosed <socket.socket fd=1096, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53508), raddr=('172.217.162.106', 443)>
2021-06-03 18:25:14.985778 (Thread-1): unclosed <socket.socket fd=1708, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53511), raddr=('172.217.162.106', 443)>
2021-06-03 18:25:14.985778 (Thread-1): unclosed <socket.socket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53510), raddr=('216.58.202.10', 443)>
2021-06-03 18:25:14.986775 (Thread-1): unclosed <socket.socket fd=1748, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53513), raddr=('216.58.202.10', 443)>
2021-06-03 18:25:14.986775 (Thread-1): unclosed <socket.socket fd=1732, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53514), raddr=('172.217.162.106', 443)>
2021-06-03 18:25:16.190897 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_product"
2021-06-03 18:25:16.190897 (Thread-1): On model.adventureworks.dim_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_product"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_product`
  
  
  OPTIONS()
  as (
    with 
    sourceproduct as (
        select distinct
            productid 
            ,productname       				
        from `adventureworks-314121`.`dbt_arthur`.`stg_product` 
    )
    , transformedproduct as (
        select
          row_number() over(order by productid) as product_sk 
           , *
        from sourceproduct
    )
select * from transformedproduct
  );
    
2021-06-03 18:25:19.197032 (Thread-1): finished collecting timing info
2021-06-03 18:25:19.197032 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144E182448>]}
2021-06-03 18:25:19.197032 (Thread-1): 15:25:19 | 19 of 22 OK created table model dbt_arthur.dim_product............... [CREATE TABLE (504.0 rows, 14.0 KB processed) in 4.23s]
2021-06-03 18:25:19.207346 (Thread-1): Finished running node model.adventureworks.dim_product
2021-06-03 18:25:19.207346 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 18:25:19.207346 (Thread-1): 15:25:19 | 20 of 22 START table model dbt_arthur.dim_salesreason................ [RUN]
2021-06-03 18:25:19.208776 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:25:19.208913 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 18:25:19.212904 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:25:19.213937 (Thread-1): finished collecting timing info
2021-06-03 18:25:19.215927 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:25:19.220872 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:25:20.315357 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:25:20.315357 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct
            salesorderheadersalesreason.salesreasonid			
            ,salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select 
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
where salereason = 'On Promotion'
  );
    
2021-06-03 18:25:23.841503 (Thread-1): finished collecting timing info
2021-06-03 18:25:23.841503 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144E197F48>]}
2021-06-03 18:25:23.841503 (Thread-1): 15:25:23 | 20 of 22 OK created table model dbt_arthur.dim_salesreason........... [CREATE TABLE (3.5k rows, 432.7 KB processed) in 4.63s]
2021-06-03 18:25:23.841503 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 18:25:23.854566 (Thread-1): Began running node model.adventureworks.dim_localization
2021-06-03 18:25:23.854566 (Thread-1): 15:25:23 | 21 of 22 START table model dbt_arthur.dim_localization............... [RUN]
2021-06-03 18:25:23.855562 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:25:23.856601 (Thread-1): Compiling model.adventureworks.dim_localization
2021-06-03 18:25:23.862540 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_localization"
2021-06-03 18:25:23.863533 (Thread-1): finished collecting timing info
2021-06-03 18:25:23.865528 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:25:23.871515 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:25:24.973851 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_localization"
2021-06-03 18:25:24.973851 (Thread-1): On model.adventureworks.dim_localization: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_localization"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_localization`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesterritory as (
            select *
              ,name as countryname
            from `adventureworks-314121`.`dbt_arthur`.`stg_salesterritory`       
    )   
    ,sourceaddress as (
            select 
             postalcode
             ,stateprovinceid
             ,addressid			
             ,city	
            from `adventureworks-314121`.`dbt_arthur`.`stg_address` 
    ) 
    , sourcestateprovince as (
            select 
                stateprovinceid
                ,countryregionid
                ,territoryid
                ,statename 	
            from `adventureworks-314121`.`dbt_arthur`.`stg_stateprovince`		
    )
    , selected as (
            select 
              sourceaddress.addressid
              ,sourcestateprovince.statename
              ,sourcesalesterritory.countryname
              ,sourceaddress.city
              ,sourceaddress.postalcode
            from sourceaddress
            left join sourcestateprovince on sourceaddress.stateprovinceid = sourcestateprovince.stateprovinceid 
            left join sourcesalesterritory on sourcestateprovince.territoryid =  sourcesalesterritory.territoryid 
    )
    , transformed as (
            select 
              row_number() over (order by addressid) as address_sk,
              * 
            from selected
    )

select distinct * from transformed
  );
    
2021-06-03 18:25:28.450230 (Thread-1): finished collecting timing info
2021-06-03 18:25:28.450230 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144E19EF88>]}
2021-06-03 18:25:28.450230 (Thread-1): 15:25:28 | 21 of 22 OK created table model dbt_arthur.dim_localization.......... [CREATE TABLE (19.6k rows, 650.7 KB processed) in 4.59s]
2021-06-03 18:25:28.463306 (Thread-1): Finished running node model.adventureworks.dim_localization
2021-06-03 18:25:28.464311 (Thread-1): Began running node model.adventureworks.fact_sales_order
2021-06-03 18:25:28.464678 (Thread-1): 15:25:28 | 22 of 22 START table model dbt_arthur.fact_sales_order............... [RUN]
2021-06-03 18:25:28.465882 (Thread-1): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:25:28.465882 (Thread-1): Compiling model.adventureworks.fact_sales_order
2021-06-03 18:25:28.471897 (Thread-1): Writing injected SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:25:28.472904 (Thread-1): finished collecting timing info
2021-06-03 18:25:28.474889 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:25:28.480833 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:25:29.553255 (Thread-1): Writing runtime SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:25:29.568607 (Thread-1): On model.adventureworks.fact_sales_order: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.fact_sales_order"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
  
  
  OPTIONS()
  as (
    with 
    salesreason as ( 
        select distinct * from  `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    )
    ,creditcard as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    )
    ,customers as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    )
    , localization as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    )
    , products as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    )
    , sales_orders_sk as (
          select 
            orderheader.salesorderid  
            ,customers.customer_sk as customer_fk		
            ,creditcard.creditcard_sk as creditcard_fk
            ,localization.address_sk as address_fk
            ,orderheader.status	
            ,orderheader.totaldue
            ,orderheader.orderdate						
          from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheader` as orderheader
          left join localization on orderheader.addressid = localization.addressid
          left join customers on orderheader.customerid = customers.customerid
          left join creditcard on orderheader.creditcardid = creditcard.creditcardid

    )
    , sales_orders_details_sk as (
        select 
         orderdetail.salesorderdetailid
         ,orderdetail.salesorderid
         ,products.product_sk as product_fk
         ,orderdetail.specialofferid
         ,orderdetail.orderqty			
         ,orderdetail.unitprice			
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderdetail` as orderdetail
        left join products on orderdetail.productid = products.productid
    )
    , final as (
        select 
            sales_orders_sk.salesorderid 
            ,sales_orders_sk.customer_fk
            ,sales_orders_sk.creditcard_fk
            ,sales_orders_details_sk.product_fk
            ,sales_orders_sk.address_fk
            ,sales_orders_sk.status	
            ,sales_orders_sk.orderdate						
            ,sales_orders_details_sk.orderqty			
            ,sales_orders_details_sk.unitprice
            ,salesreason.salesreason_sk as salesreason_fk
						
        from sales_orders_sk 
        left join sales_orders_details_sk on sales_orders_sk.salesorderid = sales_orders_details_sk.salesorderid
        left join salesreason on sales_orders_sk.salesorderid = salesreason.salesorderid		
    )

select  distinct * from final
  );
    
2021-06-03 18:25:34.966351 (Thread-1): finished collecting timing info
2021-06-03 18:25:34.966351 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d617d8-228b-4cd3-ba38-eadc1b83f6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144F1A8EC8>]}
2021-06-03 18:25:34.966351 (Thread-1): 15:25:34 | 22 of 22 OK created table model dbt_arthur.fact_sales_order.......... [CREATE TABLE (121.3k rows, 7.1 MB processed) in 6.50s]
2021-06-03 18:25:34.981724 (Thread-1): Finished running node model.adventureworks.fact_sales_order
2021-06-03 18:25:35.086018 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:25:35.086018 (MainThread): 15:25:35 | 
2021-06-03 18:25:35.086018 (MainThread): 15:25:35 | Finished running 16 view models, 6 table models in 62.33s.
2021-06-03 18:25:35.086018 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:25:35.090011 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:25:35.090011 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:25:35.090011 (MainThread): Connection 'model.adventureworks.fact_sales_order' was properly closed.
2021-06-03 18:25:35.101690 (MainThread): 
2021-06-03 18:25:35.102648 (MainThread): Completed successfully
2021-06-03 18:25:35.104643 (MainThread): 
Done. PASS=22 WARN=0 ERROR=0 SKIP=0 TOTAL=22
2021-06-03 18:25:35.105639 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011449240A88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144E197F48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001144C7799C8>]}
2021-06-03 18:25:35.105639 (MainThread): Flushing usage events
2021-06-03 18:25:43.408895 (MainThread): Running with dbt=0.19.1
2021-06-03 18:25:43.730619 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-03 18:25:43.730619 (MainThread): Tracking: tracking
2021-06-03 18:25:43.730619 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219894E0C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219894E0A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219894E6BC8>]}
2021-06-03 18:25:43.740867 (MainThread): Partial parsing not enabled
2021-06-03 18:25:43.740867 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:25:43.767869 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:25:43.773849 (MainThread): Parsing macros\etc.sql
2021-06-03 18:25:43.775842 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:25:43.780825 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:25:43.792785 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:25:43.794246 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:25:43.794246 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:25:43.801955 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:25:43.812111 (MainThread): Parsing macros\core.sql
2021-06-03 18:25:43.812111 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:25:43.853109 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:25:43.863244 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:25:43.863244 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:25:43.863244 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:25:43.871277 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:25:43.873347 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:25:43.873347 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:25:43.883496 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:25:43.893615 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:25:43.901697 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:25:43.903776 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:25:43.924183 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:25:43.954906 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:25:43.954906 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:25:43.975394 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:25:43.983558 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:25:43.985692 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:25:43.995948 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:25:43.995990 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:25:43.995990 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:25:43.995990 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:25:44.006230 (MainThread): Partial parsing not enabled
2021-06-03 18:25:44.026706 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:25:44.036919 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:25:44.036919 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:25:44.047099 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:25:44.047099 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:25:44.055205 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:25:44.057301 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:25:44.065390 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:25:44.067532 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:25:44.067532 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:25:44.075682 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:25:44.077870 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:25:44.077870 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:25:44.088320 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:25:44.088320 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:25:44.088320 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:25:44.098571 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:25:44.098571 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:25:44.106688 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:25:44.108784 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:25:44.108784 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:25:44.119018 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:25:44.129261 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:25:44.293629 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51e23370-57a6-4137-8411-8a50c34453dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002198D114EC8>]}
2021-06-03 18:25:44.308412 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51e23370-57a6-4137-8411-8a50c34453dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002198D143948>]}
2021-06-03 18:25:44.309438 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:25:44.314378 (MainThread): 
2021-06-03 18:25:44.315390 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:25:44.320378 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:25:44.320378 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:25:44.325360 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:25:45.465220 (MainThread): 15:25:45 | Concurrency: 1 threads (target='dev')
2021-06-03 18:25:45.466215 (MainThread): 15:25:45 | 
2021-06-03 18:25:45.469827 (Thread-1): Began running node test.adventureworks.not_null_dim_creditcard_creditcard_sk
2021-06-03 18:25:45.470325 (Thread-1): 15:25:45 | 1 of 17 START test not_null_dim_creditcard_creditcard_sk............. [RUN]
2021-06-03 18:25:45.471318 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_creditcard_creditcard_sk".
2021-06-03 18:25:45.471815 (Thread-1): Compiling test.adventureworks.not_null_dim_creditcard_creditcard_sk
2021-06-03 18:25:45.487844 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_creditcard_creditcard_sk"
2021-06-03 18:25:45.489181 (Thread-1): finished collecting timing info
2021-06-03 18:25:45.489678 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:25:45.498018 (Thread-1): On test.adventureworks.not_null_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
where creditcard_sk is null



2021-06-03 18:25:48.631965 (Thread-1): finished collecting timing info
2021-06-03 18:25:48.631965 (Thread-1): 15:25:48 | 1 of 17 PASS not_null_dim_creditcard_creditcard_sk................... [PASS in 3.16s]
2021-06-03 18:25:48.634082 (Thread-1): Finished running node test.adventureworks.not_null_dim_creditcard_creditcard_sk
2021-06-03 18:25:48.635081 (Thread-1): Began running node test.adventureworks.not_null_dim_customer_customer_sk
2021-06-03 18:25:48.635081 (Thread-1): 15:25:48 | 2 of 17 START test not_null_dim_customer_customer_sk................. [RUN]
2021-06-03 18:25:48.636082 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_customer_customer_sk".
2021-06-03 18:25:48.636082 (Thread-1): Compiling test.adventureworks.not_null_dim_customer_customer_sk
2021-06-03 18:25:48.638126 (Thread-1): unclosed <socket.socket fd=1128, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53529), raddr=('216.58.202.10', 443)>
2021-06-03 18:25:48.638126 (Thread-1): unclosed <socket.socket fd=1144, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53530), raddr=('172.217.162.106', 443)>
2021-06-03 18:25:48.642061 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_customer_customer_sk"
2021-06-03 18:25:48.643084 (Thread-1): finished collecting timing info
2021-06-03 18:25:48.644053 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:25:48.649081 (Thread-1): On test.adventureworks.not_null_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
where customer_sk is null



2021-06-03 18:25:51.324017 (Thread-1): finished collecting timing info
2021-06-03 18:25:51.324017 (Thread-1): 15:25:51 | 2 of 17 PASS not_null_dim_customer_customer_sk....................... [PASS in 2.69s]
2021-06-03 18:25:51.324017 (Thread-1): Finished running node test.adventureworks.not_null_dim_customer_customer_sk
2021-06-03 18:25:51.324017 (Thread-1): Began running node test.adventureworks.not_null_dim_localization_address_sk
2021-06-03 18:25:51.328724 (Thread-1): 15:25:51 | 3 of 17 START test not_null_dim_localization_address_sk.............. [RUN]
2021-06-03 18:25:51.329720 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_localization_address_sk".
2021-06-03 18:25:51.329720 (Thread-1): Compiling test.adventureworks.not_null_dim_localization_address_sk
2021-06-03 18:25:51.333765 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_localization_address_sk"
2021-06-03 18:25:51.334766 (Thread-1): finished collecting timing info
2021-06-03 18:25:51.334766 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:25:51.341742 (Thread-1): On test.adventureworks.not_null_dim_localization_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_localization_address_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
where address_sk is null



2021-06-03 18:25:54.091734 (Thread-1): finished collecting timing info
2021-06-03 18:25:54.091734 (Thread-1): 15:25:54 | 3 of 17 PASS not_null_dim_localization_address_sk.................... [PASS in 2.76s]
2021-06-03 18:25:54.091734 (Thread-1): Finished running node test.adventureworks.not_null_dim_localization_address_sk
2021-06-03 18:25:54.104902 (Thread-1): Began running node test.adventureworks.not_null_dim_product_product_sk
2021-06-03 18:25:54.104902 (Thread-1): 15:25:54 | 4 of 17 START test not_null_dim_product_product_sk................... [RUN]
2021-06-03 18:25:54.106894 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_product_product_sk".
2021-06-03 18:25:54.106894 (Thread-1): Compiling test.adventureworks.not_null_dim_product_product_sk
2021-06-03 18:25:54.113917 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_product_product_sk"
2021-06-03 18:25:54.114912 (Thread-1): finished collecting timing info
2021-06-03 18:25:54.115899 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:25:54.121843 (Thread-1): On test.adventureworks.not_null_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_product`
where product_sk is null



2021-06-03 18:25:56.812253 (Thread-1): finished collecting timing info
2021-06-03 18:25:56.812253 (Thread-1): 15:25:56 | 4 of 17 PASS not_null_dim_product_product_sk......................... [PASS in 2.71s]
2021-06-03 18:25:56.812253 (Thread-1): Finished running node test.adventureworks.not_null_dim_product_product_sk
2021-06-03 18:25:56.817113 (Thread-1): Began running node test.adventureworks.not_null_dim_salesreason_salesreason_sk
2021-06-03 18:25:56.817113 (Thread-1): 15:25:56 | 5 of 17 START test not_null_dim_salesreason_salesreason_sk........... [RUN]
2021-06-03 18:25:56.817113 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_salesreason_salesreason_sk".
2021-06-03 18:25:56.818176 (Thread-1): Compiling test.adventureworks.not_null_dim_salesreason_salesreason_sk
2021-06-03 18:25:56.819107 (Thread-1): unclosed <socket.socket fd=1144, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 51675), raddr=('216.58.202.10', 443)>
2021-06-03 18:25:56.819107 (Thread-1): unclosed <socket.socket fd=784, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 51676), raddr=('172.217.162.106', 443)>
2021-06-03 18:25:56.823156 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_salesreason_salesreason_sk"
2021-06-03 18:25:56.824127 (Thread-1): finished collecting timing info
2021-06-03 18:25:56.824127 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:25:56.829184 (Thread-1): On test.adventureworks.not_null_dim_salesreason_salesreason_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_salesreason_salesreason_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
where salesreason_sk is null



2021-06-03 18:25:59.307249 (Thread-1): finished collecting timing info
2021-06-03 18:25:59.307249 (Thread-1): 15:25:59 | 5 of 17 PASS not_null_dim_salesreason_salesreason_sk................. [PASS in 2.49s]
2021-06-03 18:25:59.307249 (Thread-1): Finished running node test.adventureworks.not_null_dim_salesreason_salesreason_sk
2021-06-03 18:25:59.317121 (Thread-1): Began running node test.adventureworks.not_null_fact_sales_order_salesorderid
2021-06-03 18:25:59.317647 (Thread-1): 15:25:59 | 6 of 17 START test not_null_fact_sales_order_salesorderid............ [RUN]
2021-06-03 18:25:59.319183 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_fact_sales_order_salesorderid".
2021-06-03 18:25:59.319183 (Thread-1): Compiling test.adventureworks.not_null_fact_sales_order_salesorderid
2021-06-03 18:25:59.325568 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_fact_sales_order_salesorderid"
2021-06-03 18:25:59.327562 (Thread-1): finished collecting timing info
2021-06-03 18:25:59.327562 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:25:59.332545 (Thread-1): On test.adventureworks.not_null_fact_sales_order_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_fact_sales_order_salesorderid"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
where salesorderid is null



2021-06-03 18:25:59.337529 (Thread-1): unclosed <socket.socket fd=1140, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53531), raddr=('216.58.202.10', 443)>
2021-06-03 18:25:59.337529 (Thread-1): unclosed <socket.socket fd=1092, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53532), raddr=('172.217.162.106', 443)>
2021-06-03 18:25:59.337529 (Thread-1): unclosed <socket.socket fd=1016, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53534), raddr=('172.217.162.106', 443)>
2021-06-03 18:25:59.337529 (Thread-1): unclosed <socket.socket fd=1148, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 53533), raddr=('216.58.202.10', 443)>
2021-06-03 18:25:59.338525 (Thread-1): unclosed <socket.socket fd=880, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 51677), raddr=('216.58.202.10', 443)>
2021-06-03 18:25:59.339522 (Thread-1): unclosed <socket.socket fd=1296, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 51678), raddr=('172.217.162.106', 443)>
2021-06-03 18:26:02.147195 (Thread-1): finished collecting timing info
2021-06-03 18:26:02.147195 (Thread-1): 15:26:02 | 6 of 17 PASS not_null_fact_sales_order_salesorderid.................. [PASS in 2.83s]
2021-06-03 18:26:02.147195 (Thread-1): Finished running node test.adventureworks.not_null_fact_sales_order_salesorderid
2021-06-03 18:26:02.162533 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_
2021-06-03 18:26:02.162533 (Thread-1): 15:26:02 | 7 of 17 START test relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_ [RUN]
2021-06-03 18:26:02.164526 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_".
2021-06-03 18:26:02.164526 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_
2021-06-03 18:26:02.174540 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_"
2021-06-03 18:26:02.175538 (Thread-1): finished collecting timing info
2021-06-03 18:26:02.176487 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:26:02.182464 (Thread-1): On test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_"} */

    
    




select count(*) as validation_errors
from (
    select address_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select address_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 18:26:04.514802 (Thread-1): finished collecting timing info
2021-06-03 18:26:04.514802 (Thread-1): 15:26:04 | 7 of 17 PASS relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_ [PASS in 2.35s]
2021-06-03 18:26:04.514802 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_
2021-06-03 18:26:04.526935 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-06-03 18:26:04.526935 (Thread-1): 15:26:04 | 8 of 17 START test relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [RUN]
2021-06-03 18:26:04.528929 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_".
2021-06-03 18:26:04.528929 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-06-03 18:26:04.536947 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_"
2021-06-03 18:26:04.537896 (Thread-1): finished collecting timing info
2021-06-03 18:26:04.537896 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:26:04.542939 (Thread-1): On test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_"} */

    
    




select count(*) as validation_errors
from (
    select creditcard_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select creditcard_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 18:26:07.100174 (Thread-1): finished collecting timing info
2021-06-03 18:26:07.101170 (Thread-1): 15:26:07 | 8 of 17 PASS relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [PASS in 2.57s]
2021-06-03 18:26:07.103164 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-06-03 18:26:07.103164 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_
2021-06-03 18:26:07.103164 (Thread-1): 15:26:07 | 9 of 17 START test relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_ [RUN]
2021-06-03 18:26:07.104161 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_".
2021-06-03 18:26:07.104161 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_
2021-06-03 18:26:07.106156 (Thread-1): unclosed <socket.socket fd=960, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 62694), raddr=('216.58.202.10', 443)>
2021-06-03 18:26:07.106156 (Thread-1): unclosed <socket.socket fd=940, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 62695), raddr=('172.217.162.106', 443)>
2021-06-03 18:26:07.112136 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_"
2021-06-03 18:26:07.113176 (Thread-1): finished collecting timing info
2021-06-03 18:26:07.114130 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:26:07.118164 (Thread-1): On test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_"} */

    
    




select count(*) as validation_errors
from (
    select customer_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select customer_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 18:26:09.980509 (Thread-1): finished collecting timing info
2021-06-03 18:26:09.980509 (Thread-1): 15:26:09 | 9 of 17 PASS relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_ [PASS in 2.88s]
2021-06-03 18:26:09.984607 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_
2021-06-03 18:26:09.984607 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_
2021-06-03 18:26:09.985605 (Thread-1): 15:26:09 | 10 of 17 START test relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_ [RUN]
2021-06-03 18:26:09.986598 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_".
2021-06-03 18:26:09.986598 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_
2021-06-03 18:26:09.997563 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_"
2021-06-03 18:26:09.998559 (Thread-1): finished collecting timing info
2021-06-03 18:26:09.999556 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:26:10.007529 (Thread-1): On test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_"} */

    
    




select count(*) as validation_errors
from (
    select product_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select product_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_product`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 18:26:12.775707 (Thread-1): finished collecting timing info
2021-06-03 18:26:12.775707 (Thread-1): 15:26:12 | 10 of 17 PASS relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_ [PASS in 2.79s]
2021-06-03 18:26:12.775707 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_
2021-06-03 18:26:12.781456 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_
2021-06-03 18:26:12.781456 (Thread-1): 15:26:12 | 11 of 17 START test relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_ [RUN]
2021-06-03 18:26:12.782451 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_".
2021-06-03 18:26:12.783452 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_
2021-06-03 18:26:12.785483 (Thread-1): unclosed <socket.socket fd=1500, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 62698), raddr=('216.58.202.10', 443)>
2021-06-03 18:26:12.785483 (Thread-1): unclosed <socket.socket fd=1516, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 62699), raddr=('172.217.162.106', 443)>
2021-06-03 18:26:12.790427 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_"
2021-06-03 18:26:12.792425 (Thread-1): finished collecting timing info
2021-06-03 18:26:12.793429 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:26:12.797452 (Thread-1): On test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_"} */

    
    




select count(*) as validation_errors
from (
    select salesreason_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select salesreason_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 18:26:15.129433 (Thread-1): finished collecting timing info
2021-06-03 18:26:15.129433 (Thread-1): 15:26:15 | 11 of 17 PASS relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_ [PASS in 2.35s]
2021-06-03 18:26:15.129433 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_
2021-06-03 18:26:15.135532 (Thread-1): Began running node test.adventureworks.sum_qty_test
2021-06-03 18:26:15.135532 (Thread-1): 15:26:15 | 12 of 17 START test sum_qty_test..................................... [RUN]
2021-06-03 18:26:15.137524 (Thread-1): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:26:15.137524 (Thread-1): Compiling test.adventureworks.sum_qty_test
2021-06-03 18:26:15.151091 (Thread-1): Writing injected SQL for node "test.adventureworks.sum_qty_test"
2021-06-03 18:26:15.153066 (Thread-1): finished collecting timing info
2021-06-03 18:26:15.153066 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:26:15.158099 (Thread-1): On test.adventureworks.sum_qty_test: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.sum_qty_test"} */

with dbt__CTE__INTERNAL_test as (
with 
   validation as (
    select sum(orderqty) as sum_qty
    from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order` 
   )
select * from validation where sum_qty != 274914
)select count(*) from dbt__CTE__INTERNAL_test
2021-06-03 18:26:17.803894 (Thread-1): finished collecting timing info
2021-06-03 18:26:17.803894 (Thread-1): 15:26:17 | 12 of 17 PASS sum_qty_test........................................... [PASS in 2.67s]
2021-06-03 18:26:17.808669 (Thread-1): Finished running node test.adventureworks.sum_qty_test
2021-06-03 18:26:17.808669 (Thread-1): Began running node test.adventureworks.unique_dim_creditcard_creditcard_sk
2021-06-03 18:26:17.808669 (Thread-1): 15:26:17 | 13 of 17 START test unique_dim_creditcard_creditcard_sk.............. [RUN]
2021-06-03 18:26:17.809668 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_creditcard_creditcard_sk".
2021-06-03 18:26:17.809668 (Thread-1): Compiling test.adventureworks.unique_dim_creditcard_creditcard_sk
2021-06-03 18:26:17.832344 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_creditcard_creditcard_sk"
2021-06-03 18:26:17.832344 (Thread-1): finished collecting timing info
2021-06-03 18:26:17.832344 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:26:17.832344 (Thread-1): On test.adventureworks.unique_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        creditcard_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    where creditcard_sk is not null
    group by creditcard_sk
    having count(*) > 1

) validation_errors



2021-06-03 18:26:20.176927 (Thread-1): finished collecting timing info
2021-06-03 18:26:20.176927 (Thread-1): 15:26:20 | 13 of 17 PASS unique_dim_creditcard_creditcard_sk.................... [PASS in 2.37s]
2021-06-03 18:26:20.176927 (Thread-1): Finished running node test.adventureworks.unique_dim_creditcard_creditcard_sk
2021-06-03 18:26:20.187813 (Thread-1): Began running node test.adventureworks.unique_dim_customer_customer_sk
2021-06-03 18:26:20.187813 (Thread-1): 15:26:20 | 14 of 17 START test unique_dim_customer_customer_sk.................. [RUN]
2021-06-03 18:26:20.189806 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_customer_customer_sk".
2021-06-03 18:26:20.189806 (Thread-1): Compiling test.adventureworks.unique_dim_customer_customer_sk
2021-06-03 18:26:20.192796 (Thread-1): unclosed <socket.socket fd=1144, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 62691), raddr=('216.58.202.10', 443)>
2021-06-03 18:26:20.193792 (Thread-1): unclosed <socket.socket fd=1344, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 62692), raddr=('172.217.162.106', 443)>
2021-06-03 18:26:20.195784 (Thread-1): unclosed <socket.socket fd=1300, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 62696), raddr=('216.58.202.10', 443)>
2021-06-03 18:26:20.195784 (Thread-1): unclosed <socket.socket fd=784, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 62697), raddr=('172.217.162.106', 443)>
2021-06-03 18:26:20.197776 (Thread-1): unclosed <socket.socket fd=1020, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 62700), raddr=('216.58.202.10', 443)>
2021-06-03 18:26:20.197776 (Thread-1): unclosed <socket.socket fd=1560, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 62701), raddr=('172.217.162.106', 443)>
2021-06-03 18:26:20.197776 (Thread-1): unclosed <socket.socket fd=1468, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 62703), raddr=('172.217.162.106', 443)>
2021-06-03 18:26:20.197776 (Thread-1): unclosed <socket.socket fd=1576, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 62702), raddr=('216.58.202.10', 443)>
2021-06-03 18:26:20.197776 (Thread-1): unclosed <socket.socket fd=956, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 62704), raddr=('216.58.202.10', 443)>
2021-06-03 18:26:20.197776 (Thread-1): unclosed <socket.socket fd=1460, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 62705), raddr=('172.217.162.106', 443)>
2021-06-03 18:26:20.200767 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_customer_customer_sk"
2021-06-03 18:26:20.201771 (Thread-1): finished collecting timing info
2021-06-03 18:26:20.201771 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:26:20.205749 (Thread-1): On test.adventureworks.unique_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    where customer_sk is not null
    group by customer_sk
    having count(*) > 1

) validation_errors



2021-06-03 18:26:23.000193 (Thread-1): finished collecting timing info
2021-06-03 18:26:23.000193 (Thread-1): 15:26:23 | 14 of 17 PASS unique_dim_customer_customer_sk........................ [PASS in 2.81s]
2021-06-03 18:26:23.000193 (Thread-1): Finished running node test.adventureworks.unique_dim_customer_customer_sk
2021-06-03 18:26:23.009576 (Thread-1): Began running node test.adventureworks.unique_dim_localization_address_sk
2021-06-03 18:26:23.009576 (Thread-1): 15:26:23 | 15 of 17 START test unique_dim_localization_address_sk............... [RUN]
2021-06-03 18:26:23.011575 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_localization_address_sk".
2021-06-03 18:26:23.011575 (Thread-1): Compiling test.adventureworks.unique_dim_localization_address_sk
2021-06-03 18:26:23.018546 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_localization_address_sk"
2021-06-03 18:26:23.018546 (Thread-1): finished collecting timing info
2021-06-03 18:26:23.019543 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:26:23.024526 (Thread-1): On test.adventureworks.unique_dim_localization_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_localization_address_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        address_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    where address_sk is not null
    group by address_sk
    having count(*) > 1

) validation_errors



2021-06-03 18:26:25.688415 (Thread-1): finished collecting timing info
2021-06-03 18:26:25.689410 (Thread-1): 15:26:25 | 15 of 17 PASS unique_dim_localization_address_sk..................... [PASS in 2.68s]
2021-06-03 18:26:25.691403 (Thread-1): Finished running node test.adventureworks.unique_dim_localization_address_sk
2021-06-03 18:26:25.691403 (Thread-1): Began running node test.adventureworks.unique_dim_product_product_sk
2021-06-03 18:26:25.691403 (Thread-1): 15:26:25 | 16 of 17 START test unique_dim_product_product_sk.................... [RUN]
2021-06-03 18:26:25.692400 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_product_product_sk".
2021-06-03 18:26:25.692400 (Thread-1): Compiling test.adventureworks.unique_dim_product_product_sk
2021-06-03 18:26:25.694390 (Thread-1): unclosed <socket.socket fd=1036, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 62708), raddr=('216.58.202.10', 443)>
2021-06-03 18:26:25.694390 (Thread-1): unclosed <socket.socket fd=1668, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 62709), raddr=('172.217.162.106', 443)>
2021-06-03 18:26:25.697387 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_product_product_sk"
2021-06-03 18:26:25.698439 (Thread-1): finished collecting timing info
2021-06-03 18:26:25.698439 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:26:25.703361 (Thread-1): On test.adventureworks.unique_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        product_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    where product_sk is not null
    group by product_sk
    having count(*) > 1

) validation_errors



2021-06-03 18:26:28.732985 (Thread-1): finished collecting timing info
2021-06-03 18:26:28.733929 (Thread-1): 15:26:28 | 16 of 17 PASS unique_dim_product_product_sk.......................... [PASS in 3.04s]
2021-06-03 18:26:28.735922 (Thread-1): Finished running node test.adventureworks.unique_dim_product_product_sk
2021-06-03 18:26:28.735922 (Thread-1): Began running node test.adventureworks.unique_dim_salesreason_salesreason_sk
2021-06-03 18:26:28.735922 (Thread-1): 15:26:28 | 17 of 17 START test unique_dim_salesreason_salesreason_sk............ [RUN]
2021-06-03 18:26:28.737959 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_salesreason_salesreason_sk".
2021-06-03 18:26:28.737959 (Thread-1): Compiling test.adventureworks.unique_dim_salesreason_salesreason_sk
2021-06-03 18:26:28.742940 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_salesreason_salesreason_sk"
2021-06-03 18:26:28.743941 (Thread-1): finished collecting timing info
2021-06-03 18:26:28.744892 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:26:28.748933 (Thread-1): On test.adventureworks.unique_dim_salesreason_salesreason_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_salesreason_salesreason_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        salesreason_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    where salesreason_sk is not null
    group by salesreason_sk
    having count(*) > 1

) validation_errors



2021-06-03 18:26:30.525967 (Thread-1): finished collecting timing info
2021-06-03 18:26:30.526971 (Thread-1): 15:26:30 | 17 of 17 PASS unique_dim_salesreason_salesreason_sk.................. [PASS in 1.79s]
2021-06-03 18:26:30.528910 (Thread-1): Finished running node test.adventureworks.unique_dim_salesreason_salesreason_sk
2021-06-03 18:26:30.540927 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:26:30.541941 (MainThread): 15:26:30 | 
2021-06-03 18:26:30.542919 (MainThread): 15:26:30 | Finished running 17 tests in 46.23s.
2021-06-03 18:26:30.543921 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:26:30.543921 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:26:30.543921 (MainThread): Connection 'test.adventureworks.unique_dim_salesreason_salesreason_sk' was properly closed.
2021-06-03 18:26:30.560900 (MainThread): 
2021-06-03 18:26:30.561859 (MainThread): Completed successfully
2021-06-03 18:26:30.561859 (MainThread): 
Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
2021-06-03 18:26:30.563849 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002198E267148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002198E283BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219894B0AC8>]}
2021-06-03 18:26:30.563849 (MainThread): Flushing usage events
2021-06-03 18:28:23.886965 (MainThread): Running with dbt=0.19.1
2021-06-03 18:28:24.190699 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:28:24.190699 (MainThread): Tracking: tracking
2021-06-03 18:28:24.190699 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002845CBF3A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002845CBF3C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002845CBF8108>]}
2021-06-03 18:28:24.201338 (MainThread): Partial parsing not enabled
2021-06-03 18:28:24.201338 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:28:24.221127 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:28:24.229187 (MainThread): Parsing macros\etc.sql
2021-06-03 18:28:24.231247 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:28:24.231247 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:28:24.241432 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:28:24.249496 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:28:24.251554 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:28:24.259666 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:28:24.261728 (MainThread): Parsing macros\core.sql
2021-06-03 18:28:24.261728 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:28:24.302310 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:28:24.312427 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:28:24.312427 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:28:24.312427 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:28:24.320524 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:28:24.322610 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:28:24.322610 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:28:24.332803 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:28:24.351213 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:28:24.353226 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:28:24.353226 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:28:24.373563 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:28:24.404155 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:28:24.412258 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:28:24.424792 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:28:24.434983 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:28:24.434983 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:28:24.449439 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:28:24.452429 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:28:24.454427 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:28:24.456417 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:28:24.463393 (MainThread): Partial parsing not enabled
2021-06-03 18:28:24.486059 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:28:24.496221 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:28:24.496221 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:28:24.504361 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:28:24.506575 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:28:24.506575 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:28:24.516964 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:28:24.516964 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:28:24.527078 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:28:24.527078 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:28:24.537169 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:28:24.537241 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:28:24.545332 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:28:24.547519 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:28:24.547519 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:28:24.555787 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:28:24.558001 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:28:24.558001 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:28:24.569327 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:28:24.573649 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:28:24.576395 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:28:24.578575 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:28:24.588883 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:28:24.764602 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a537911b-406f-40a1-9b55-1c521d00ed2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002845CC00548>]}
2021-06-03 18:28:24.774934 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a537911b-406f-40a1-9b55-1c521d00ed2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002845CB96888>]}
2021-06-03 18:28:24.774934 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:28:24.783102 (MainThread): 
2021-06-03 18:28:24.783102 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:28:24.786063 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:28:24.787035 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:28:25.445876 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:28:25.445876 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:28:25.452943 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:28:26.535835 (MainThread): 15:28:26 | Concurrency: 1 threads (target='dev')
2021-06-03 18:28:26.535835 (MainThread): 15:28:26 | 
2021-06-03 18:28:26.544529 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 18:28:26.545542 (Thread-1): 15:28:26 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 18:28:26.546500 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:28:26.546500 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 18:28:26.550529 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:28:26.552490 (Thread-1): finished collecting timing info
2021-06-03 18:28:26.574411 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:28:26.579387 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:28:28.150552 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:28:28.150552 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct
            salesorderheadersalesreason.salesreasonid			
            ,salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select 
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
where salereason = 'On Promotion'
  );
    
2021-06-03 18:28:31.872164 (Thread-1): finished collecting timing info
2021-06-03 18:28:31.873159 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a537911b-406f-40a1-9b55-1c521d00ed2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028460674808>]}
2021-06-03 18:28:31.873159 (Thread-1): 15:28:31 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (3.5k rows, 432.7 KB processed) in 5.33s]
2021-06-03 18:28:31.874157 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 18:28:31.902781 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:28:31.902781 (MainThread): 15:28:31 | 
2021-06-03 18:28:31.903750 (MainThread): 15:28:31 | Finished running 1 table model in 7.12s.
2021-06-03 18:28:31.904748 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:28:31.904748 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:28:31.904748 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:28:31.904748 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 18:28:31.912722 (MainThread): 
2021-06-03 18:28:31.913721 (MainThread): Completed successfully
2021-06-03 18:28:31.915712 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:28:31.916709 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284600E9A48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284606D9F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284606D9448>]}
2021-06-03 18:28:31.916709 (MainThread): Flushing usage events
2021-06-03 18:28:48.203041 (MainThread): Running with dbt=0.19.1
2021-06-03 18:28:48.515506 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:28:48.515506 (MainThread): Tracking: tracking
2021-06-03 18:28:48.515506 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3BC6E0C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3BCE70748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3BCE70B88>]}
2021-06-03 18:28:48.527220 (MainThread): Partial parsing not enabled
2021-06-03 18:28:48.527220 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:28:48.549213 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:28:48.554335 (MainThread): Parsing macros\etc.sql
2021-06-03 18:28:48.556441 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:28:48.556441 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:28:48.566683 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:28:48.574810 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:28:48.576907 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:28:48.587065 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:28:48.587065 (MainThread): Parsing macros\core.sql
2021-06-03 18:28:48.595200 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:28:48.636192 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:28:48.645163 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:28:48.646673 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:28:48.648268 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:28:48.648268 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:28:48.648268 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:28:48.648268 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:28:48.658400 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:28:48.668638 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:28:48.676776 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:28:48.678869 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:28:48.699306 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:28:48.737853 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:28:48.739959 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:28:48.758340 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:28:48.768463 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:28:48.770552 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:28:48.780750 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:28:48.790953 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:28:48.790953 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:28:48.790953 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:28:48.801011 (MainThread): Partial parsing not enabled
2021-06-03 18:28:48.831367 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:28:48.841533 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:28:48.841533 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:28:48.849655 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:28:48.851801 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:28:48.859937 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:28:48.862130 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:28:48.862130 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:28:48.872525 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:28:48.872525 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:28:48.880763 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:28:48.882972 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:28:48.882972 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:28:48.891164 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:28:48.893357 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:28:48.893357 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:28:48.903789 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:28:48.903789 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:28:48.911879 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:28:48.914081 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:28:48.914081 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:28:48.924483 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:28:48.934844 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:28:49.109479 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3479609-2bbf-44e8-be44-36ed2b4420d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3BCE9A648>]}
2021-06-03 18:28:49.119755 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3479609-2bbf-44e8-be44-36ed2b4420d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3BEE09CC8>]}
2021-06-03 18:28:49.119755 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:28:49.124472 (MainThread): 
2021-06-03 18:28:49.125469 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:28:49.126404 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:28:49.127402 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:28:49.678156 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:28:49.679614 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:28:49.686867 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:28:50.794265 (MainThread): 15:28:50 | Concurrency: 1 threads (target='dev')
2021-06-03 18:28:50.794265 (MainThread): 15:28:50 | 
2021-06-03 18:28:50.805949 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 18:28:50.805949 (Thread-1): 15:28:50 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 18:28:50.805949 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:28:50.808595 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 18:28:50.811961 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:28:50.812959 (Thread-1): finished collecting timing info
2021-06-03 18:28:50.834875 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:28:50.839863 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:28:51.373637 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:28:51.373637 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct
            salesorderheadersalesreason.salesreasonid			
            ,salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select 
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
  );
    
2021-06-03 18:28:54.769218 (Thread-1): finished collecting timing info
2021-06-03 18:28:54.769218 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3479609-2bbf-44e8-be44-36ed2b4420d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3BCE71C08>]}
2021-06-03 18:28:54.769218 (Thread-1): 15:28:54 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (27.6k rows, 432.7 KB processed) in 3.96s]
2021-06-03 18:28:54.772810 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 18:28:54.786013 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:28:54.786013 (MainThread): 15:28:54 | 
2021-06-03 18:28:54.787028 (MainThread): 15:28:54 | Finished running 1 table model in 5.66s.
2021-06-03 18:28:54.787028 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:28:54.787028 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:28:54.787028 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:28:54.788005 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 18:28:54.796979 (MainThread): 
2021-06-03 18:28:54.797972 (MainThread): Completed successfully
2021-06-03 18:28:54.798968 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:28:54.800977 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3BCDC85C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C096AC48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C096A548>]}
2021-06-03 18:28:54.800977 (MainThread): Flushing usage events
2021-06-03 18:29:46.707356 (MainThread): Running with dbt=0.19.1
2021-06-03 18:29:47.010261 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_sales_order'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:29:47.010261 (MainThread): Tracking: tracking
2021-06-03 18:29:47.010261 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA91A2E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA91D0C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA91D10C8>]}
2021-06-03 18:29:47.030245 (MainThread): Partial parsing not enabled
2021-06-03 18:29:47.030245 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:29:47.050081 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:29:47.060303 (MainThread): Parsing macros\etc.sql
2021-06-03 18:29:47.060303 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:29:47.060303 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:29:47.070529 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:29:47.080743 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:29:47.080743 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:29:47.090946 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:29:47.090946 (MainThread): Parsing macros\core.sql
2021-06-03 18:29:47.101170 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:29:47.139840 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:29:47.150016 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:29:47.150016 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:29:47.152071 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:29:47.156519 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:29:47.160158 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:29:47.162229 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:29:47.172353 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:29:47.190606 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:29:47.192714 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:29:47.192714 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:29:47.213155 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:29:47.243751 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:29:47.251873 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:29:47.264212 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:29:47.274404 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:29:47.274404 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:29:47.284593 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:29:47.284593 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:29:47.284593 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:29:47.292688 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:29:47.294801 (MainThread): Partial parsing not enabled
2021-06-03 18:29:47.321730 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:29:47.332695 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:29:47.336681 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:29:47.339217 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:29:47.343835 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:29:47.345949 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:29:47.354054 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:29:47.356141 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:29:47.356141 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:29:47.366372 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:29:47.366372 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:29:47.374474 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:29:47.380168 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:29:47.384738 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:29:47.386799 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:29:47.397005 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:29:47.397005 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:29:47.397005 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:29:47.407210 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:29:47.407210 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:29:47.415288 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:29:47.417380 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:29:47.427572 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:29:47.598527 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd26836b2-0143-404b-9e28-8231cc3fe41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBACE17108>]}
2021-06-03 18:29:47.608716 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd26836b2-0143-404b-9e28-8231cc3fe41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA9186588>]}
2021-06-03 18:29:47.608716 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:29:47.613884 (MainThread): 
2021-06-03 18:29:47.614921 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:29:47.616894 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:29:47.616894 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:29:48.134967 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:29:48.135598 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:29:48.142402 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:29:49.237208 (MainThread): 15:29:49 | Concurrency: 1 threads (target='dev')
2021-06-03 18:29:49.237208 (MainThread): 15:29:49 | 
2021-06-03 18:29:49.246147 (Thread-1): Began running node model.adventureworks.fact_sales_order
2021-06-03 18:29:49.246147 (Thread-1): 15:29:49 | 1 of 1 START table model dbt_arthur.fact_sales_order................. [RUN]
2021-06-03 18:29:49.248173 (Thread-1): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:29:49.248173 (Thread-1): Compiling model.adventureworks.fact_sales_order
2021-06-03 18:29:49.255148 (Thread-1): Writing injected SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:29:49.257125 (Thread-1): finished collecting timing info
2021-06-03 18:29:49.283618 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:29:49.288537 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:29:49.820517 (Thread-1): Writing runtime SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:29:49.820517 (Thread-1): On model.adventureworks.fact_sales_order: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.fact_sales_order"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
  
  
  OPTIONS()
  as (
    with 
    salesreason as ( 
        select distinct * from  `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    )
    ,creditcard as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    )
    ,customers as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    )
    , localization as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    )
    , products as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    )
    , sales_orders_sk as (
          select 
            orderheader.salesorderid  
            ,customers.customer_sk as customer_fk		
            ,creditcard.creditcard_sk as creditcard_fk
            ,localization.address_sk as address_fk
            ,orderheader.status	
            ,orderheader.totaldue
            ,orderheader.orderdate						
          from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheader` as orderheader
          left join localization on orderheader.addressid = localization.addressid
          left join customers on orderheader.customerid = customers.customerid
          left join creditcard on orderheader.creditcardid = creditcard.creditcardid

    )
    , sales_orders_details_sk as (
        select 
         orderdetail.salesorderdetailid
         ,orderdetail.salesorderid
         ,products.product_sk as product_fk
         ,orderdetail.specialofferid
         ,orderdetail.orderqty			
         ,orderdetail.unitprice			
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderdetail` as orderdetail
        left join products on orderdetail.productid = products.productid
    )
    , final as (
        select 
            sales_orders_sk.salesorderid 
            ,sales_orders_sk.customer_fk
            ,sales_orders_sk.creditcard_fk
            ,sales_orders_details_sk.product_fk
            ,sales_orders_sk.address_fk
            ,sales_orders_sk.status	
            ,sales_orders_sk.orderdate						
            ,sales_orders_details_sk.orderqty			
            ,sales_orders_details_sk.unitprice
            ,salesreason.salesreason_sk as salesreason_fk
						
        from sales_orders_sk 
        left join sales_orders_details_sk on sales_orders_sk.salesorderid = sales_orders_details_sk.salesorderid
        left join salesreason on sales_orders_sk.salesorderid = salesreason.salesorderid		
    )

select  distinct * from final
  );
    
2021-06-03 18:29:55.817985 (Thread-1): finished collecting timing info
2021-06-03 18:29:55.818987 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd26836b2-0143-404b-9e28-8231cc3fe41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA920F948>]}
2021-06-03 18:29:55.818987 (Thread-1): 15:29:55 | 1 of 1 OK created table model dbt_arthur.fact_sales_order............ [CREATE TABLE (131.9k rows, 7.8 MB processed) in 6.57s]
2021-06-03 18:29:55.820031 (Thread-1): Finished running node model.adventureworks.fact_sales_order
2021-06-03 18:29:55.895755 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:29:55.895755 (MainThread): 15:29:55 | 
2021-06-03 18:29:55.896750 (MainThread): 15:29:55 | Finished running 1 table model in 8.28s.
2021-06-03 18:29:55.897742 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:29:55.898738 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:29:55.898738 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:29:55.898738 (MainThread): Connection 'model.adventureworks.fact_sales_order' was properly closed.
2021-06-03 18:29:55.908705 (MainThread): 
2021-06-03 18:29:55.908705 (MainThread): Completed successfully
2021-06-03 18:29:55.910713 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:29:55.910713 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBACC98B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBACC98808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBACC987C8>]}
2021-06-03 18:29:55.910713 (MainThread): Flushing usage events
2021-06-03 18:30:22.467366 (MainThread): Running with dbt=0.19.1
2021-06-03 18:30:22.817681 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_sales_order'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:30:22.817681 (MainThread): Tracking: tracking
2021-06-03 18:30:22.817681 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBB712DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBB740BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBB7410C8>]}
2021-06-03 18:30:22.828106 (MainThread): Partial parsing not enabled
2021-06-03 18:30:22.828106 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:30:22.848904 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:30:22.848904 (MainThread): Parsing macros\etc.sql
2021-06-03 18:30:22.848904 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:30:22.861713 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:30:22.875667 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:30:22.878659 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:30:22.880655 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:30:22.889787 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:30:22.889787 (MainThread): Parsing macros\core.sql
2021-06-03 18:30:22.900220 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:30:22.941750 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:30:22.949881 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:30:22.949881 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:30:22.952106 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:30:22.952106 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:30:22.952106 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:30:22.952106 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:30:22.962539 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:30:22.973083 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:30:22.981323 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:30:22.983568 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:30:23.004374 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:30:23.037820 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:30:23.037820 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:30:23.056610 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:30:23.064871 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:30:23.067061 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:30:23.077439 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:30:23.077439 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:30:23.077439 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:30:23.077439 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:30:23.090180 (MainThread): Partial parsing not enabled
2021-06-03 18:30:23.107901 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:30:23.118258 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:30:23.128729 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:30:23.128729 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:30:23.128729 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:30:23.139004 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:30:23.139004 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:30:23.149452 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:30:23.149452 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:30:23.149452 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:30:23.159678 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:30:23.159678 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:30:23.159678 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:30:23.170161 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:30:23.170161 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:30:23.170161 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:30:23.180483 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:30:23.180483 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:30:23.180483 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:30:23.190980 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:30:23.190980 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:30:23.190980 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:30:23.201302 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:30:23.375840 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4fec629-c133-447e-b8e5-86ea2b998573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBB6FC888>]}
2021-06-03 18:30:23.398419 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4fec629-c133-447e-b8e5-86ea2b998573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBF3C85C8>]}
2021-06-03 18:30:23.399416 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:30:23.404400 (MainThread): 
2021-06-03 18:30:23.404400 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:30:23.407394 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:30:23.408390 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:30:24.601497 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:30:24.601497 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:30:24.601497 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:30:25.117657 (MainThread): 15:30:25 | Concurrency: 1 threads (target='dev')
2021-06-03 18:30:25.117657 (MainThread): 15:30:25 | 
2021-06-03 18:30:25.129921 (Thread-1): Began running node model.adventureworks.fact_sales_order
2021-06-03 18:30:25.129921 (Thread-1): 15:30:25 | 1 of 1 START table model dbt_arthur.fact_sales_order................. [RUN]
2021-06-03 18:30:25.130928 (Thread-1): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:30:25.131986 (Thread-1): Compiling model.adventureworks.fact_sales_order
2021-06-03 18:30:25.138888 (Thread-1): Writing injected SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:30:25.139887 (Thread-1): finished collecting timing info
2021-06-03 18:30:25.164935 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:30:25.173025 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:30:25.737316 (Thread-1): Writing runtime SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:30:25.738343 (Thread-1): On model.adventureworks.fact_sales_order: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.fact_sales_order"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
  
  
  OPTIONS()
  as (
    with 
    salesreason as ( 
        select distinct * from  `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    )
    ,creditcard as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    )
    ,customers as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    )
    , localization as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    )
    , products as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    )
    , sales_orders_sk as (
          select 
            orderheader.salesorderid  
            ,customers.customer_sk as customer_fk		
            ,creditcard.creditcard_sk as creditcard_fk
            ,localization.address_sk as address_fk
            ,orderheader.status	
            ,orderheader.totaldue
            ,orderheader.orderdate						
          from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheader` as orderheader
          left join localization on orderheader.addressid = localization.addressid
          left join customers on orderheader.customerid = customers.customerid
          left join creditcard on orderheader.creditcardid = creditcard.creditcardid

    )
    , sales_orders_details_sk as (
        select 
         orderdetail.salesorderdetailid
         ,orderdetail.salesorderid
         ,products.product_sk as product_fk
         ,orderdetail.specialofferid
         ,orderdetail.orderqty			
         ,orderdetail.unitprice			
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderdetail` as orderdetail
        left join products on orderdetail.productid = products.productid
    )
    , final as (
        select distinct
            sales_orders_sk.salesorderid 
            ,sales_orders_sk.customer_fk
            ,sales_orders_sk.creditcard_fk
            ,sales_orders_details_sk.product_fk
            ,sales_orders_sk.address_fk
            ,sales_orders_sk.status	
            ,sales_orders_sk.orderdate						
            ,sales_orders_details_sk.orderqty			
            ,sales_orders_details_sk.unitprice
            ,salesreason.salesreason_sk as salesreason_fk
						
        from sales_orders_sk 
        left join sales_orders_details_sk on sales_orders_sk.salesorderid = sales_orders_details_sk.salesorderid
        left join salesreason on sales_orders_sk.salesorderid = salesreason.salesorderid		
    )

select  distinct * from final
  );
    
2021-06-03 18:30:31.378928 (Thread-1): finished collecting timing info
2021-06-03 18:30:31.378928 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4fec629-c133-447e-b8e5-86ea2b998573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBB730388>]}
2021-06-03 18:30:31.378928 (Thread-1): 15:30:31 | 1 of 1 OK created table model dbt_arthur.fact_sales_order............ [CREATE TABLE (131.9k rows, 7.8 MB processed) in 6.25s]
2021-06-03 18:30:31.389908 (Thread-1): Finished running node model.adventureworks.fact_sales_order
2021-06-03 18:30:31.396010 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:30:31.396010 (MainThread): 15:30:31 | 
2021-06-03 18:30:31.397388 (MainThread): 15:30:31 | Finished running 1 table model in 7.99s.
2021-06-03 18:30:31.398387 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:30:31.398387 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:30:31.398387 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:30:31.398387 (MainThread): Connection 'model.adventureworks.fact_sales_order' was properly closed.
2021-06-03 18:30:31.406373 (MainThread): 
2021-06-03 18:30:31.407984 (MainThread): Completed successfully
2021-06-03 18:30:31.408995 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:30:31.410977 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBF3AF888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBF1CFA88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBB75F6C8>]}
2021-06-03 18:30:31.410977 (MainThread): Flushing usage events
2021-06-03 18:31:39.270020 (MainThread): Running with dbt=0.19.1
2021-06-03 18:31:39.610048 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:31:39.610048 (MainThread): Tracking: tracking
2021-06-03 18:31:39.610048 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5EC2109C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5EC1E0FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5EC2130C8>]}
2021-06-03 18:31:39.620603 (MainThread): Partial parsing not enabled
2021-06-03 18:31:39.620603 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:31:39.641560 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:31:39.650758 (MainThread): Parsing macros\etc.sql
2021-06-03 18:31:39.653318 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:31:39.655624 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:31:39.662649 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:31:39.670821 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:31:39.673104 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:31:39.681394 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:31:39.683697 (MainThread): Parsing macros\core.sql
2021-06-03 18:31:39.683697 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:31:39.725461 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:31:39.737628 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:31:39.738841 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:31:39.740052 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:31:39.742339 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:31:39.744013 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:31:39.746027 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:31:39.754139 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:31:39.766814 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:31:39.766814 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:31:39.776754 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:31:39.795920 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:31:39.828816 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:31:39.828816 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:31:39.839342 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:31:39.849721 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:31:39.857777 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:31:39.860305 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:31:39.860305 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:31:39.860305 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:31:39.868380 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:31:39.870574 (MainThread): Partial parsing not enabled
2021-06-03 18:31:39.891358 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:31:39.901816 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:31:39.912044 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:31:39.912044 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:31:39.920184 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:31:39.922299 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:31:39.930387 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:31:39.932487 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:31:39.932487 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:31:39.942716 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:31:39.942716 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:31:39.953049 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:31:39.953049 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:31:39.963218 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:31:39.963218 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:31:39.971372 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:31:39.973568 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:31:39.973568 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:31:39.981805 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:31:39.984006 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:31:39.984006 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:31:39.994371 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:31:40.004739 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:31:40.170578 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07ea134d-d13c-4923-beb7-f2afdee21b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5EC230188>]}
2021-06-03 18:31:40.180900 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07ea134d-d13c-4923-beb7-f2afdee21b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5EFDE7388>]}
2021-06-03 18:31:40.180900 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:31:40.190541 (MainThread): 
2021-06-03 18:31:40.191545 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:31:40.193487 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:31:40.193487 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:31:41.319231 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:31:41.320603 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:31:41.327474 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:31:42.434940 (MainThread): 15:31:42 | Concurrency: 1 threads (target='dev')
2021-06-03 18:31:42.435335 (MainThread): 15:31:42 | 
2021-06-03 18:31:42.438452 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 18:31:42.439246 (Thread-1): 15:31:42 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 18:31:42.440530 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:31:42.440872 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 18:31:42.444379 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:31:42.445367 (Thread-1): finished collecting timing info
2021-06-03 18:31:42.482704 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:31:42.487848 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:31:43.007928 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:31:43.007928 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct
            salesorderheadersalesreason.salesreasonid			
            ,salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select distinct
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
  );
    
2021-06-03 18:31:47.303749 (Thread-1): finished collecting timing info
2021-06-03 18:31:47.303749 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07ea134d-d13c-4923-beb7-f2afdee21b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5EFDDB548>]}
2021-06-03 18:31:47.303749 (Thread-1): 15:31:47 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (27.6k rows, 432.7 KB processed) in 4.86s]
2021-06-03 18:31:47.307895 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 18:31:47.422432 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:31:47.422432 (MainThread): 15:31:47 | 
2021-06-03 18:31:47.422432 (MainThread): 15:31:47 | Finished running 1 table model in 7.23s.
2021-06-03 18:31:47.422432 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:31:47.425934 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:31:47.425934 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:31:47.425934 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 18:31:47.434583 (MainThread): 
2021-06-03 18:31:47.435563 (MainThread): Completed successfully
2021-06-03 18:31:47.437502 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:31:47.437502 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5EC22E508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5EC22EA88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5EC1D3B48>]}
2021-06-03 18:31:47.437502 (MainThread): Flushing usage events
2021-06-03 18:32:03.008495 (MainThread): Running with dbt=0.19.1
2021-06-03 18:32:03.333293 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_sales_order'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:32:03.333293 (MainThread): Tracking: tracking
2021-06-03 18:32:03.333293 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1AF42F908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1AF415B08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1AF40E388>]}
2021-06-03 18:32:03.348974 (MainThread): Partial parsing not enabled
2021-06-03 18:32:03.348974 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:32:03.369726 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:32:03.369726 (MainThread): Parsing macros\etc.sql
2021-06-03 18:32:03.377796 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:32:03.379864 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:32:03.389990 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:32:03.389990 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:32:03.389990 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:32:03.400133 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:32:03.410265 (MainThread): Parsing macros\core.sql
2021-06-03 18:32:03.410265 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:32:03.450871 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:32:03.461133 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:32:03.461133 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:32:03.461133 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:32:03.461133 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:32:03.461133 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:32:03.469207 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:32:03.471267 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:32:03.489524 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:32:03.491583 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:32:03.491583 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:32:03.511835 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:32:03.542201 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:32:03.550265 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:32:03.562449 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:32:03.570515 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:32:03.572570 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:32:03.582786 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:32:03.582786 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:32:03.582786 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:32:03.582786 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:32:03.592916 (MainThread): Partial parsing not enabled
2021-06-03 18:32:03.613190 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:32:03.623374 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:32:03.623374 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:32:03.631455 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:32:03.633516 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:32:03.633516 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:32:03.643716 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:32:03.643716 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:32:03.651795 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:32:03.653866 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:32:03.653866 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:32:03.662621 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:32:03.666656 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:32:03.669646 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:32:03.674625 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:32:03.677621 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:32:03.681604 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:32:03.684597 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:32:03.688584 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:32:03.692721 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:32:03.696305 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:32:03.696305 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:32:03.705289 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:32:03.872809 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '810c0bbd-deb6-4d02-94c0-c8b97a831a7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1AF46B2C8>]}
2021-06-03 18:32:03.881069 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '810c0bbd-deb6-4d02-94c0-c8b97a831a7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1B30CE548>]}
2021-06-03 18:32:03.881069 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:32:03.888703 (MainThread): 
2021-06-03 18:32:03.888703 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:32:03.890755 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:32:03.891697 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:32:04.991448 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:32:04.991448 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:32:04.991448 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:32:06.067332 (MainThread): 15:32:06 | Concurrency: 1 threads (target='dev')
2021-06-03 18:32:06.067332 (MainThread): 15:32:06 | 
2021-06-03 18:32:06.082879 (Thread-1): Began running node model.adventureworks.fact_sales_order
2021-06-03 18:32:06.082879 (Thread-1): 15:32:06 | 1 of 1 START table model dbt_arthur.fact_sales_order................. [RUN]
2021-06-03 18:32:06.084719 (Thread-1): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:32:06.084719 (Thread-1): Compiling model.adventureworks.fact_sales_order
2021-06-03 18:32:06.091710 (Thread-1): Writing injected SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:32:06.092706 (Thread-1): finished collecting timing info
2021-06-03 18:32:06.113635 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:32:06.117621 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:32:06.673076 (Thread-1): Writing runtime SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:32:06.673076 (Thread-1): On model.adventureworks.fact_sales_order: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.fact_sales_order"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
  
  
  OPTIONS()
  as (
    with 
    salesreason as ( 
        select distinct * from  `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    )
    ,creditcard as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    )
    ,customers as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    )
    , localization as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    )
    , products as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    )
    , sales_orders_sk as (
          select 
            orderheader.salesorderid  
            ,customers.customer_sk as customer_fk		
            ,creditcard.creditcard_sk as creditcard_fk
            ,localization.address_sk as address_fk
            ,orderheader.status	
            ,orderheader.totaldue
            ,orderheader.orderdate						
          from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheader` as orderheader
          left join localization on orderheader.addressid = localization.addressid
          left join customers on orderheader.customerid = customers.customerid
          left join creditcard on orderheader.creditcardid = creditcard.creditcardid

    )
    , sales_orders_details_sk as (
        select 
         orderdetail.salesorderdetailid
         ,orderdetail.salesorderid
         ,products.product_sk as product_fk
         ,orderdetail.specialofferid
         ,orderdetail.orderqty			
         ,orderdetail.unitprice			
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderdetail` as orderdetail
        left join products on orderdetail.productid = products.productid
    )
    , final as (
        select distinct
            sales_orders_sk.salesorderid 
            ,sales_orders_sk.customer_fk
            ,sales_orders_sk.creditcard_fk
            ,sales_orders_details_sk.product_fk
            ,sales_orders_sk.address_fk
            ,sales_orders_sk.status	
            ,sales_orders_sk.orderdate						
            ,sales_orders_details_sk.orderqty			
            ,sales_orders_details_sk.unitprice
            ,salesreason.salesreason_sk as salesreason_fk
						
        from sales_orders_sk 
        left join sales_orders_details_sk on sales_orders_sk.salesorderid = sales_orders_details_sk.salesorderid
        left join salesreason on sales_orders_sk.salesorderid = salesreason.salesorderid		
    )

select  distinct * from final
  );
    
2021-06-03 18:32:12.570684 (Thread-1): finished collecting timing info
2021-06-03 18:32:12.570684 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '810c0bbd-deb6-4d02-94c0-c8b97a831a7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1B13ED5C8>]}
2021-06-03 18:32:12.570684 (Thread-1): 15:32:12 | 1 of 1 OK created table model dbt_arthur.fact_sales_order............ [CREATE TABLE (131.9k rows, 7.8 MB processed) in 6.49s]
2021-06-03 18:32:12.570684 (Thread-1): Finished running node model.adventureworks.fact_sales_order
2021-06-03 18:32:12.632942 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:32:12.632942 (MainThread): 15:32:12 | 
2021-06-03 18:32:12.633938 (MainThread): 15:32:12 | Finished running 1 table model in 8.74s.
2021-06-03 18:32:12.634943 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:32:12.635989 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:32:12.635989 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:32:12.635989 (MainThread): Connection 'model.adventureworks.fact_sales_order' was properly closed.
2021-06-03 18:32:12.644899 (MainThread): 
2021-06-03 18:32:12.644899 (MainThread): Completed successfully
2021-06-03 18:32:12.645898 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:32:12.648000 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1AF470288>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1AF470988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1AF4C5248>]}
2021-06-03 18:32:12.648000 (MainThread): Flushing usage events
2021-06-03 18:39:50.337432 (MainThread): Running with dbt=0.19.1
2021-06-03 18:39:50.693763 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:39:50.693763 (MainThread): Tracking: tracking
2021-06-03 18:39:50.693763 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B144022908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B14401BEC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B14401CB08>]}
2021-06-03 18:39:50.704171 (MainThread): Partial parsing not enabled
2021-06-03 18:39:50.704171 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:39:50.724853 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:39:50.735048 (MainThread): Parsing macros\etc.sql
2021-06-03 18:39:50.735048 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:39:50.746691 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:39:50.761643 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:39:50.765187 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:39:50.765815 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:39:50.776193 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:39:50.776193 (MainThread): Parsing macros\core.sql
2021-06-03 18:39:50.786542 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:39:50.825957 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:39:50.836273 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:39:50.836421 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:39:50.838628 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:39:50.838628 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:39:50.838628 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:39:50.838628 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:39:50.849023 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:39:50.859457 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:39:50.867582 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:39:50.869795 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:39:50.890518 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:39:50.921486 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:39:50.921486 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:39:50.941794 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:39:50.952017 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:39:50.952017 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:39:50.962391 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:39:50.962391 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:39:50.962391 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:39:50.962391 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:39:50.976947 (MainThread): Partial parsing not enabled
2021-06-03 18:39:50.993866 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:39:51.004350 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:39:51.012466 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:39:51.014717 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:39:51.014717 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:39:51.022969 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:39:51.025049 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:39:51.033194 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:39:51.035210 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:39:51.039738 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:39:51.045338 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:39:51.045338 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:39:51.053457 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:39:51.055961 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:39:51.055961 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:39:51.063513 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:39:51.063513 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:39:51.063513 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:39:51.085730 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:39:51.085730 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:39:51.085730 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:39:51.095888 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:39:51.105996 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:39:51.268481 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfe99343-919d-42a6-b359-4a1a4f17f037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B14405B288>]}
2021-06-03 18:39:51.283428 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfe99343-919d-42a6-b359-4a1a4f17f037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B147C84D48>]}
2021-06-03 18:39:51.283428 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:39:51.290390 (MainThread): 
2021-06-03 18:39:51.290980 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:39:51.292894 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:39:51.292894 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:39:51.991743 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:39:51.991743 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:39:51.998390 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:39:52.529309 (MainThread): 15:39:52 | Concurrency: 1 threads (target='dev')
2021-06-03 18:39:52.530303 (MainThread): 15:39:52 | 
2021-06-03 18:39:52.534011 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 18:39:52.534507 (Thread-1): 15:39:52 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 18:39:52.536056 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:39:52.536056 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 18:39:52.541476 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:39:52.543486 (Thread-1): finished collecting timing info
2021-06-03 18:39:52.595105 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:39:52.603407 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:39:53.750409 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:39:53.750409 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct
            salesorderheadersalesreason.salesreasonid			
            ,salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select distinct
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
where salereason <> 'Price'
  );
    
2021-06-03 18:39:57.404200 (Thread-1): finished collecting timing info
2021-06-03 18:39:57.404200 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfe99343-919d-42a6-b359-4a1a4f17f037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B143FE31C8>]}
2021-06-03 18:39:57.404200 (Thread-1): 15:39:57 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (10.2k rows, 432.7 KB processed) in 4.87s]
2021-06-03 18:39:57.407149 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 18:39:57.425798 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:39:57.426817 (MainThread): 15:39:57 | 
2021-06-03 18:39:57.427853 (MainThread): 15:39:57 | Finished running 1 table model in 6.14s.
2021-06-03 18:39:57.428813 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:39:57.428813 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:39:57.428813 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:39:57.428813 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 18:39:57.437825 (MainThread): 
2021-06-03 18:39:57.438529 (MainThread): Completed successfully
2021-06-03 18:39:57.439543 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:39:57.440551 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B14402E408>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B14402EA48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B14402E288>]}
2021-06-03 18:39:57.441522 (MainThread): Flushing usage events
2021-06-03 18:40:13.781366 (MainThread): Running with dbt=0.19.1
2021-06-03 18:40:14.094413 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_sales_order'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:40:14.094413 (MainThread): Tracking: tracking
2021-06-03 18:40:14.094413 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002680AF2CAC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002680AF31C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002680D18EB88>]}
2021-06-03 18:40:14.103562 (MainThread): Partial parsing not enabled
2021-06-03 18:40:14.103562 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:40:14.121886 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:40:14.123960 (MainThread): Parsing macros\etc.sql
2021-06-03 18:40:14.123960 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:40:14.134156 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:40:14.144270 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:40:14.144270 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:40:14.144270 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:40:14.154389 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:40:14.162458 (MainThread): Parsing macros\core.sql
2021-06-03 18:40:14.164516 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:40:14.204993 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:40:14.213061 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:40:14.215121 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:40:14.215121 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:40:14.215121 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:40:14.215121 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:40:14.215121 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:40:14.225250 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:40:14.235382 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:40:14.243441 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:40:14.245506 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:40:14.265824 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:40:14.296432 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:40:14.296432 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:40:14.316709 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:40:14.316709 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:40:14.326838 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:40:14.326838 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:40:14.334911 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:40:14.336978 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:40:14.336978 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:40:14.345120 (MainThread): Partial parsing not enabled
2021-06-03 18:40:14.365468 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:40:14.375658 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:40:14.377726 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:40:14.377726 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:40:14.387875 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:40:14.387875 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:40:14.398116 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:40:14.398116 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:40:14.398116 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:40:14.408323 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:40:14.408323 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:40:14.417270 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:40:14.422782 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:40:14.426769 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:40:14.430756 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:40:14.434742 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:40:14.438729 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:40:14.442087 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:40:14.446629 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:40:14.448672 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:40:14.448672 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:40:14.458734 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:40:14.468839 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:40:14.640824 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb72f629-81d1-4cc5-86e2-faf32bc9a1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002680AF5A748>]}
2021-06-03 18:40:14.642911 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb72f629-81d1-4cc5-86e2-faf32bc9a1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002680EBB58C8>]}
2021-06-03 18:40:14.650981 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:40:14.655740 (MainThread): 
2021-06-03 18:40:14.656736 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:40:14.660087 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:40:14.660585 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:40:15.817304 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:40:15.817802 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:40:15.824516 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:40:16.943978 (MainThread): 15:40:16 | Concurrency: 1 threads (target='dev')
2021-06-03 18:40:16.943978 (MainThread): 15:40:16 | 
2021-06-03 18:40:16.961999 (Thread-1): Began running node model.adventureworks.fact_sales_order
2021-06-03 18:40:16.961999 (Thread-1): 15:40:16 | 1 of 1 START table model dbt_arthur.fact_sales_order................. [RUN]
2021-06-03 18:40:16.963994 (Thread-1): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:40:16.963994 (Thread-1): Compiling model.adventureworks.fact_sales_order
2021-06-03 18:40:16.971001 (Thread-1): Writing injected SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:40:16.972986 (Thread-1): finished collecting timing info
2021-06-03 18:40:16.998953 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:40:17.002939 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:40:18.137886 (Thread-1): Writing runtime SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:40:18.139092 (Thread-1): On model.adventureworks.fact_sales_order: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.fact_sales_order"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
  
  
  OPTIONS()
  as (
    with 
    salesreason as ( 
        select distinct * from  `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    )
    ,creditcard as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    )
    ,customers as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    )
    , localization as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    )
    , products as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    )
    , sales_orders_sk as (
          select 
            orderheader.salesorderid  
            ,customers.customer_sk as customer_fk		
            ,creditcard.creditcard_sk as creditcard_fk
            ,localization.address_sk as address_fk
            ,orderheader.status	
            ,orderheader.totaldue
            ,orderheader.orderdate						
          from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheader` as orderheader
          left join localization on orderheader.addressid = localization.addressid
          left join customers on orderheader.customerid = customers.customerid
          left join creditcard on orderheader.creditcardid = creditcard.creditcardid

    )
    , sales_orders_details_sk as (
        select 
         orderdetail.salesorderdetailid
         ,orderdetail.salesorderid
         ,products.product_sk as product_fk
         ,orderdetail.specialofferid
         ,orderdetail.orderqty			
         ,orderdetail.unitprice			
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderdetail` as orderdetail
        left join products on orderdetail.productid = products.productid
    )
    , final as (
        select distinct
            sales_orders_sk.salesorderid 
            ,sales_orders_sk.customer_fk
            ,sales_orders_sk.creditcard_fk
            ,sales_orders_details_sk.product_fk
            ,sales_orders_sk.address_fk
            ,sales_orders_sk.status	
            ,sales_orders_sk.orderdate						
            ,sales_orders_details_sk.orderqty			
            ,sales_orders_details_sk.unitprice
            ,salesreason.salesreason_sk as salesreason_fk
						
        from sales_orders_sk 
        left join sales_orders_details_sk on sales_orders_sk.salesorderid = sales_orders_details_sk.salesorderid
        left join salesreason on sales_orders_sk.salesorderid = salesreason.salesorderid		
    )

select  distinct * from final
  );
    
2021-06-03 18:40:23.410908 (Thread-1): finished collecting timing info
2021-06-03 18:40:23.410908 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb72f629-81d1-4cc5-86e2-faf32bc9a1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268080E49C8>]}
2021-06-03 18:40:23.410908 (Thread-1): 15:40:23 | 1 of 1 OK created table model dbt_arthur.fact_sales_order............ [CREATE TABLE (123.5k rows, 7.3 MB processed) in 6.45s]
2021-06-03 18:40:23.410908 (Thread-1): Finished running node model.adventureworks.fact_sales_order
2021-06-03 18:40:23.426424 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:40:23.427477 (MainThread): 15:40:23 | 
2021-06-03 18:40:23.428422 (MainThread): 15:40:23 | Finished running 1 table model in 8.77s.
2021-06-03 18:40:23.429420 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:40:23.429420 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:40:23.429420 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:40:23.429420 (MainThread): Connection 'model.adventureworks.fact_sales_order' was properly closed.
2021-06-03 18:40:23.436397 (MainThread): 
2021-06-03 18:40:23.437392 (MainThread): Completed successfully
2021-06-03 18:40:23.438546 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:40:23.439547 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002680EA77508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002680EA77688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002680EA77FC8>]}
2021-06-03 18:40:23.440545 (MainThread): Flushing usage events
2021-06-03 18:43:30.975425 (MainThread): Running with dbt=0.19.1
2021-06-03 18:43:31.307282 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:43:31.307282 (MainThread): Tracking: tracking
2021-06-03 18:43:31.307282 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E433D0CF08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E433D13B08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E433D13B48>]}
2021-06-03 18:43:31.317548 (MainThread): Partial parsing not enabled
2021-06-03 18:43:31.319532 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:43:31.338997 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:43:31.344975 (MainThread): Parsing macros\etc.sql
2021-06-03 18:43:31.347119 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:43:31.350226 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:43:31.358292 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:43:31.366385 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:43:31.368484 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:43:31.378709 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:43:31.378709 (MainThread): Parsing macros\core.sql
2021-06-03 18:43:31.386833 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:43:31.419611 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:43:31.429968 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:43:31.438035 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:43:31.438175 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:43:31.440387 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:43:31.440387 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:43:31.440387 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:43:31.450667 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:43:31.460927 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:43:31.469086 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:43:31.471173 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:43:31.491647 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:43:31.522300 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:43:31.522300 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:43:31.542739 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:43:31.552963 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:43:31.552963 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:43:31.563201 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:43:31.563201 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:43:31.563201 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:43:31.563201 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:43:31.573481 (MainThread): Partial parsing not enabled
2021-06-03 18:43:31.594079 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:43:31.604373 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:43:31.612563 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:43:31.614646 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:43:31.614646 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:43:31.624863 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:43:31.624863 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:43:31.637360 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:43:31.640593 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:43:31.645326 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:43:31.645326 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:43:31.645326 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:43:31.655553 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:43:31.655553 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:43:31.663671 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:43:31.665778 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:43:31.665778 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:43:31.673918 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:43:31.676010 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:43:31.676010 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:43:31.686220 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:43:31.686220 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:43:31.696505 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:43:31.870760 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b6f07ff-f071-41da-bb00-d2c7866c30f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E433D3A308>]}
2021-06-03 18:43:31.880954 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b6f07ff-f071-41da-bb00-d2c7866c30f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4373882C8>]}
2021-06-03 18:43:31.880954 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:43:31.889855 (MainThread): 
2021-06-03 18:43:31.890861 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:43:31.892779 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:43:31.893821 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:43:33.055061 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:43:33.056055 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:43:33.062655 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:43:33.592773 (MainThread): 15:43:33 | Concurrency: 1 threads (target='dev')
2021-06-03 18:43:33.592773 (MainThread): 15:43:33 | 
2021-06-03 18:43:33.607896 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 18:43:33.607896 (Thread-1): 15:43:33 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 18:43:33.609887 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:43:33.609887 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 18:43:33.613874 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:43:33.615865 (Thread-1): finished collecting timing info
2021-06-03 18:43:33.638827 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:43:33.643821 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:43:34.188015 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:43:34.188015 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct
            salesorderheadersalesreason.salesreasonid			
            ,salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select distinct
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
where salereason <> 'Price' and salereason <> 'Manufacturer'
  );
    
2021-06-03 18:43:38.184611 (Thread-1): finished collecting timing info
2021-06-03 18:43:38.184611 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b6f07ff-f071-41da-bb00-d2c7866c30f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E433CC6C88>]}
2021-06-03 18:43:38.184611 (Thread-1): 15:43:38 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (8.4k rows, 432.7 KB processed) in 4.58s]
2021-06-03 18:43:38.184611 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 18:43:38.229706 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:43:38.230694 (MainThread): 15:43:38 | 
2021-06-03 18:43:38.231188 (MainThread): 15:43:38 | Finished running 1 table model in 6.34s.
2021-06-03 18:43:38.231188 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:43:38.232188 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:43:38.232188 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:43:38.232188 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 18:43:38.238170 (MainThread): 
2021-06-03 18:43:38.239498 (MainThread): Completed successfully
2021-06-03 18:43:38.240501 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:43:38.241493 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E433D80C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E435C67F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4335A8208>]}
2021-06-03 18:43:38.241493 (MainThread): Flushing usage events
2021-06-03 18:43:54.945807 (MainThread): Running with dbt=0.19.1
2021-06-03 18:43:55.257252 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_sales_order'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:43:55.257252 (MainThread): Tracking: tracking
2021-06-03 18:43:55.257252 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0635D1EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C063603C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C063608148>]}
2021-06-03 18:43:55.273584 (MainThread): Partial parsing not enabled
2021-06-03 18:43:55.273584 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:43:55.297450 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:43:55.305569 (MainThread): Parsing macros\etc.sql
2021-06-03 18:43:55.307837 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:43:55.307837 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:43:55.318371 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:43:55.326449 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:43:55.328735 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:43:55.336998 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:43:55.339284 (MainThread): Parsing macros\core.sql
2021-06-03 18:43:55.339284 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:43:55.380668 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:43:55.390916 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:43:55.390916 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:43:55.399005 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:43:55.401098 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:43:55.401098 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:43:55.401098 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:43:55.411323 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:43:55.421441 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:43:55.421441 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:43:55.431622 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:43:55.451890 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:43:55.482268 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:43:55.482268 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:43:55.500515 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:43:55.502574 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:43:55.512724 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:43:55.512724 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:43:55.520786 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:43:55.522846 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:43:55.522846 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:43:55.531031 (MainThread): Partial parsing not enabled
2021-06-03 18:43:55.553584 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:43:55.563825 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:43:55.563825 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:43:55.572069 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:43:55.574701 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:43:55.574701 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:43:55.584397 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:43:55.584397 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:43:55.594504 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:43:55.594504 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:43:55.594504 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:43:55.604905 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:43:55.604905 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:43:55.612995 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:43:55.615101 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:43:55.615101 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:43:55.623209 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:43:55.625296 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:43:55.625296 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:43:55.635468 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:43:55.635468 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:43:55.643574 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:43:55.654271 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:43:55.829694 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '636479d6-d5da-439c-911f-9c89f6d45c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C06363B6C8>]}
2021-06-03 18:43:55.839812 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '636479d6-d5da-439c-911f-9c89f6d45c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C06728C308>]}
2021-06-03 18:43:55.839812 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:43:55.846549 (MainThread): 
2021-06-03 18:43:55.847558 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:43:55.850481 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:43:55.850481 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:43:56.442729 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:43:56.442912 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:43:56.448846 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:43:57.579768 (MainThread): 15:43:57 | Concurrency: 1 threads (target='dev')
2021-06-03 18:43:57.580765 (MainThread): 15:43:57 | 
2021-06-03 18:43:57.583756 (Thread-1): Began running node model.adventureworks.fact_sales_order
2021-06-03 18:43:57.583756 (Thread-1): 15:43:57 | 1 of 1 START table model dbt_arthur.fact_sales_order................. [RUN]
2021-06-03 18:43:57.584753 (Thread-1): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:43:57.584753 (Thread-1): Compiling model.adventureworks.fact_sales_order
2021-06-03 18:43:57.590736 (Thread-1): Writing injected SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:43:57.591728 (Thread-1): finished collecting timing info
2021-06-03 18:43:57.614600 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:43:57.619587 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:43:58.746229 (Thread-1): Writing runtime SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:43:58.746229 (Thread-1): On model.adventureworks.fact_sales_order: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.fact_sales_order"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
  
  
  OPTIONS()
  as (
    with 
    salesreason as ( 
        select distinct * from  `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    )
    ,creditcard as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    )
    ,customers as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    )
    , localization as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    )
    , products as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    )
    , sales_orders_sk as (
          select 
            orderheader.salesorderid  
            ,customers.customer_sk as customer_fk		
            ,creditcard.creditcard_sk as creditcard_fk
            ,localization.address_sk as address_fk
            ,orderheader.status	
            ,orderheader.totaldue
            ,orderheader.orderdate						
          from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheader` as orderheader
          left join localization on orderheader.addressid = localization.addressid
          left join customers on orderheader.customerid = customers.customerid
          left join creditcard on orderheader.creditcardid = creditcard.creditcardid

    )
    , sales_orders_details_sk as (
        select 
         orderdetail.salesorderdetailid
         ,orderdetail.salesorderid
         ,products.product_sk as product_fk
         ,orderdetail.specialofferid
         ,orderdetail.orderqty			
         ,orderdetail.unitprice			
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderdetail` as orderdetail
        left join products on orderdetail.productid = products.productid
    )
    , final as (
        select distinct
            sales_orders_sk.salesorderid 
            ,sales_orders_sk.customer_fk
            ,sales_orders_sk.creditcard_fk
            ,sales_orders_details_sk.product_fk
            ,sales_orders_sk.address_fk
            ,sales_orders_sk.status	
            ,sales_orders_sk.orderdate						
            ,sales_orders_details_sk.orderqty			
            ,sales_orders_details_sk.unitprice
            ,salesreason.salesreason_sk as salesreason_fk
						
        from sales_orders_sk 
        left join sales_orders_details_sk on sales_orders_sk.salesorderid = sales_orders_details_sk.salesorderid
        left join salesreason on sales_orders_sk.salesorderid = salesreason.salesorderid		
    )

select  distinct * from final
  );
    
2021-06-03 18:44:03.504834 (Thread-1): finished collecting timing info
2021-06-03 18:44:03.520292 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '636479d6-d5da-439c-911f-9c89f6d45c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C06362FE08>]}
2021-06-03 18:44:03.520292 (Thread-1): 15:44:03 | 1 of 1 OK created table model dbt_arthur.fact_sales_order............ [CREATE TABLE (121.9k rows, 7.3 MB processed) in 5.94s]
2021-06-03 18:44:03.522318 (Thread-1): Finished running node model.adventureworks.fact_sales_order
2021-06-03 18:44:03.536021 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:44:03.536944 (MainThread): 15:44:03 | 
2021-06-03 18:44:03.536944 (MainThread): 15:44:03 | Finished running 1 table model in 7.69s.
2021-06-03 18:44:03.537939 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:44:03.537939 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:44:03.537939 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:44:03.537939 (MainThread): Connection 'model.adventureworks.fact_sales_order' was properly closed.
2021-06-03 18:44:03.549914 (MainThread): 
2021-06-03 18:44:03.550898 (MainThread): Completed successfully
2021-06-03 18:44:03.552891 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:44:03.553887 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C067050648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C067050E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C067050DC8>]}
2021-06-03 18:44:03.553887 (MainThread): Flushing usage events
2021-06-03 18:44:11.111266 (MainThread): Running with dbt=0.19.1
2021-06-03 18:44:11.445517 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-03 18:44:11.445517 (MainThread): Tracking: tracking
2021-06-03 18:44:11.445517 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FD793808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FD799B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FD7994C8>]}
2021-06-03 18:44:11.455719 (MainThread): Partial parsing not enabled
2021-06-03 18:44:11.455719 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:44:11.476096 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:44:11.486527 (MainThread): Parsing macros\etc.sql
2021-06-03 18:44:11.486527 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:44:11.486527 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:44:11.504788 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:44:11.506868 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:44:11.506868 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:44:11.517078 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:44:11.525151 (MainThread): Parsing macros\core.sql
2021-06-03 18:44:11.527237 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:44:11.569916 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:44:11.578324 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:44:11.578324 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:44:11.578324 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:44:11.578324 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:44:11.578324 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:44:11.586427 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:44:11.588511 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:44:11.606774 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:44:11.608862 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:44:11.608862 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:44:11.629106 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:44:11.659480 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:44:11.659480 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:44:11.679691 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:44:11.687752 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:44:11.689809 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:44:11.699937 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:44:11.699937 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:44:11.699937 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:44:11.699937 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:44:11.710125 (MainThread): Partial parsing not enabled
2021-06-03 18:44:11.730222 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:44:11.740415 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:44:11.748519 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:44:11.750612 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:44:11.750612 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:44:11.760716 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:44:11.760716 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:44:11.770906 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:44:11.770906 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:44:11.779165 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:44:11.781182 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:44:11.781182 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:44:11.791346 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:44:11.791346 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:44:11.801392 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:44:11.801392 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:44:11.809414 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:44:11.811432 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:44:11.819542 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:44:11.821628 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:44:11.821628 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:44:11.831823 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:44:11.842396 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:44:12.007654 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c71cddf-876f-47db-bc4e-e881955c57ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2813D9048>]}
2021-06-03 18:44:12.014728 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c71cddf-876f-47db-bc4e-e881955c57ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D28144A1C8>]}
2021-06-03 18:44:12.014728 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:44:12.022172 (MainThread): 
2021-06-03 18:44:12.022172 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:44:12.027102 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:44:12.028099 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:44:12.033146 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:44:13.172953 (MainThread): 15:44:13 | Concurrency: 1 threads (target='dev')
2021-06-03 18:44:13.172953 (MainThread): 15:44:13 | 
2021-06-03 18:44:13.177451 (Thread-1): Began running node test.adventureworks.not_null_dim_creditcard_creditcard_sk
2021-06-03 18:44:13.177451 (Thread-1): 15:44:13 | 1 of 17 START test not_null_dim_creditcard_creditcard_sk............. [RUN]
2021-06-03 18:44:13.178454 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_creditcard_creditcard_sk".
2021-06-03 18:44:13.179448 (Thread-1): Compiling test.adventureworks.not_null_dim_creditcard_creditcard_sk
2021-06-03 18:44:13.189411 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_creditcard_creditcard_sk"
2021-06-03 18:44:13.191054 (Thread-1): finished collecting timing info
2021-06-03 18:44:13.191054 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:44:13.197794 (Thread-1): On test.adventureworks.not_null_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
where creditcard_sk is null



2021-06-03 18:44:15.272359 (Thread-1): finished collecting timing info
2021-06-03 18:44:15.272359 (Thread-1): 15:44:15 | 1 of 17 PASS not_null_dim_creditcard_creditcard_sk................... [PASS in 2.09s]
2021-06-03 18:44:15.272359 (Thread-1): Finished running node test.adventureworks.not_null_dim_creditcard_creditcard_sk
2021-06-03 18:44:15.276796 (Thread-1): Began running node test.adventureworks.not_null_dim_customer_customer_sk
2021-06-03 18:44:15.276796 (Thread-1): 15:44:15 | 2 of 17 START test not_null_dim_customer_customer_sk................. [RUN]
2021-06-03 18:44:15.277798 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_customer_customer_sk".
2021-06-03 18:44:15.278788 (Thread-1): Compiling test.adventureworks.not_null_dim_customer_customer_sk
2021-06-03 18:44:15.278788 (Thread-1): unclosed <socket.socket fd=1140, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49931), raddr=('142.250.218.74', 443)>
2021-06-03 18:44:15.279790 (Thread-1): unclosed <socket.socket fd=1148, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49932), raddr=('172.217.162.106', 443)>
2021-06-03 18:44:15.282408 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_customer_customer_sk"
2021-06-03 18:44:15.282408 (Thread-1): finished collecting timing info
2021-06-03 18:44:15.282408 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:44:15.282408 (Thread-1): On test.adventureworks.not_null_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
where customer_sk is null



2021-06-03 18:44:17.283645 (Thread-1): finished collecting timing info
2021-06-03 18:44:17.283645 (Thread-1): 15:44:17 | 2 of 17 PASS not_null_dim_customer_customer_sk....................... [PASS in 2.01s]
2021-06-03 18:44:17.294016 (Thread-1): Finished running node test.adventureworks.not_null_dim_customer_customer_sk
2021-06-03 18:44:17.294016 (Thread-1): Began running node test.adventureworks.not_null_dim_localization_address_sk
2021-06-03 18:44:17.294016 (Thread-1): 15:44:17 | 3 of 17 START test not_null_dim_localization_address_sk.............. [RUN]
2021-06-03 18:44:17.295046 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_localization_address_sk".
2021-06-03 18:44:17.295046 (Thread-1): Compiling test.adventureworks.not_null_dim_localization_address_sk
2021-06-03 18:44:17.300198 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_localization_address_sk"
2021-06-03 18:44:17.302147 (Thread-1): finished collecting timing info
2021-06-03 18:44:17.302147 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:44:17.307131 (Thread-1): On test.adventureworks.not_null_dim_localization_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_localization_address_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
where address_sk is null



2021-06-03 18:44:19.395642 (Thread-1): finished collecting timing info
2021-06-03 18:44:19.395642 (Thread-1): 15:44:19 | 3 of 17 PASS not_null_dim_localization_address_sk.................... [PASS in 2.10s]
2021-06-03 18:44:19.395642 (Thread-1): Finished running node test.adventureworks.not_null_dim_localization_address_sk
2021-06-03 18:44:19.406283 (Thread-1): Began running node test.adventureworks.not_null_dim_product_product_sk
2021-06-03 18:44:19.406283 (Thread-1): 15:44:19 | 4 of 17 START test not_null_dim_product_product_sk................... [RUN]
2021-06-03 18:44:19.407279 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_product_product_sk".
2021-06-03 18:44:19.408279 (Thread-1): Compiling test.adventureworks.not_null_dim_product_product_sk
2021-06-03 18:44:19.414277 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_product_product_sk"
2021-06-03 18:44:19.415846 (Thread-1): finished collecting timing info
2021-06-03 18:44:19.415846 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:44:19.421272 (Thread-1): On test.adventureworks.not_null_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_product`
where product_sk is null



2021-06-03 18:44:21.999779 (Thread-1): finished collecting timing info
2021-06-03 18:44:21.999779 (Thread-1): 15:44:21 | 4 of 17 PASS not_null_dim_product_product_sk......................... [PASS in 2.59s]
2021-06-03 18:44:22.008075 (Thread-1): Finished running node test.adventureworks.not_null_dim_product_product_sk
2021-06-03 18:44:22.008075 (Thread-1): Began running node test.adventureworks.not_null_dim_salesreason_salesreason_sk
2021-06-03 18:44:22.008075 (Thread-1): 15:44:22 | 5 of 17 START test not_null_dim_salesreason_salesreason_sk........... [RUN]
2021-06-03 18:44:22.010073 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_salesreason_salesreason_sk".
2021-06-03 18:44:22.010073 (Thread-1): Compiling test.adventureworks.not_null_dim_salesreason_salesreason_sk
2021-06-03 18:44:22.012066 (Thread-1): unclosed <socket.socket fd=1252, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49937), raddr=('142.250.218.74', 443)>
2021-06-03 18:44:22.012066 (Thread-1): unclosed <socket.socket fd=908, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49938), raddr=('172.217.162.106', 443)>
2021-06-03 18:44:22.017043 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_salesreason_salesreason_sk"
2021-06-03 18:44:22.018041 (Thread-1): finished collecting timing info
2021-06-03 18:44:22.019038 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:44:22.023069 (Thread-1): On test.adventureworks.not_null_dim_salesreason_salesreason_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_salesreason_salesreason_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
where salesreason_sk is null



2021-06-03 18:44:24.105248 (Thread-1): finished collecting timing info
2021-06-03 18:44:24.105248 (Thread-1): 15:44:24 | 5 of 17 PASS not_null_dim_salesreason_salesreason_sk................. [PASS in 2.10s]
2021-06-03 18:44:24.105248 (Thread-1): Finished running node test.adventureworks.not_null_dim_salesreason_salesreason_sk
2021-06-03 18:44:24.105248 (Thread-1): Began running node test.adventureworks.not_null_fact_sales_order_salesorderid
2021-06-03 18:44:24.105248 (Thread-1): 15:44:24 | 6 of 17 START test not_null_fact_sales_order_salesorderid............ [RUN]
2021-06-03 18:44:24.117702 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_fact_sales_order_salesorderid".
2021-06-03 18:44:24.117702 (Thread-1): Compiling test.adventureworks.not_null_fact_sales_order_salesorderid
2021-06-03 18:44:24.121757 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_fact_sales_order_salesorderid"
2021-06-03 18:44:24.122688 (Thread-1): finished collecting timing info
2021-06-03 18:44:24.122688 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:44:24.128723 (Thread-1): On test.adventureworks.not_null_fact_sales_order_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_fact_sales_order_salesorderid"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
where salesorderid is null



2021-06-03 18:44:24.131656 (Thread-1): unclosed <socket.socket fd=920, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49933), raddr=('142.250.218.74', 443)>
2021-06-03 18:44:24.132651 (Thread-1): unclosed <socket.socket fd=376, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49934), raddr=('172.217.162.106', 443)>
2021-06-03 18:44:24.132651 (Thread-1): unclosed <socket.socket fd=408, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49936), raddr=('172.217.162.106', 443)>
2021-06-03 18:44:24.132651 (Thread-1): unclosed <socket.socket fd=1204, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49935), raddr=('142.250.218.74', 443)>
2021-06-03 18:44:24.134645 (Thread-1): unclosed <socket.socket fd=1076, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49940), raddr=('172.217.162.106', 443)>
2021-06-03 18:44:24.135749 (Thread-1): unclosed <socket.socket fd=720, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49939), raddr=('142.250.218.74', 443)>
2021-06-03 18:44:26.454202 (Thread-1): finished collecting timing info
2021-06-03 18:44:26.464269 (Thread-1): 15:44:26 | 6 of 17 PASS not_null_fact_sales_order_salesorderid.................. [PASS in 2.35s]
2021-06-03 18:44:26.464269 (Thread-1): Finished running node test.adventureworks.not_null_fact_sales_order_salesorderid
2021-06-03 18:44:26.466351 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_
2021-06-03 18:44:26.466351 (Thread-1): 15:44:26 | 7 of 17 START test relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_ [RUN]
2021-06-03 18:44:26.467348 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_".
2021-06-03 18:44:26.467348 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_
2021-06-03 18:44:26.476368 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_"
2021-06-03 18:44:26.477365 (Thread-1): finished collecting timing info
2021-06-03 18:44:26.478310 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:44:26.484327 (Thread-1): On test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_"} */

    
    




select count(*) as validation_errors
from (
    select address_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select address_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 18:44:29.045833 (Thread-1): finished collecting timing info
2021-06-03 18:44:29.046890 (Thread-1): 15:44:29 | 7 of 17 PASS relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_ [PASS in 2.58s]
2021-06-03 18:44:29.047824 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_
2021-06-03 18:44:29.047824 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-06-03 18:44:29.047824 (Thread-1): 15:44:29 | 8 of 17 START test relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [RUN]
2021-06-03 18:44:29.048823 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_".
2021-06-03 18:44:29.048823 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-06-03 18:44:29.055845 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_"
2021-06-03 18:44:29.056795 (Thread-1): finished collecting timing info
2021-06-03 18:44:29.056795 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:44:29.064116 (Thread-1): On test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_"} */

    
    




select count(*) as validation_errors
from (
    select creditcard_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select creditcard_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 18:44:31.997891 (Thread-1): finished collecting timing info
2021-06-03 18:44:31.997891 (Thread-1): 15:44:31 | 8 of 17 PASS relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [PASS in 2.95s]
2021-06-03 18:44:31.997891 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-06-03 18:44:32.013054 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_
2021-06-03 18:44:32.014050 (Thread-1): 15:44:32 | 9 of 17 START test relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_ [RUN]
2021-06-03 18:44:32.015047 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_".
2021-06-03 18:44:32.015047 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_
2021-06-03 18:44:32.017040 (Thread-1): unclosed <socket.socket fd=1332, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49945), raddr=('142.250.218.74', 443)>
2021-06-03 18:44:32.017040 (Thread-1): unclosed <socket.socket fd=1324, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49946), raddr=('172.217.162.106', 443)>
2021-06-03 18:44:32.023018 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_"
2021-06-03 18:44:32.025040 (Thread-1): finished collecting timing info
2021-06-03 18:44:32.025040 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:44:32.031031 (Thread-1): On test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_"} */

    
    




select count(*) as validation_errors
from (
    select customer_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select customer_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 18:44:34.920514 (Thread-1): finished collecting timing info
2021-06-03 18:44:34.920514 (Thread-1): 15:44:34 | 9 of 17 PASS relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_ [PASS in 2.91s]
2021-06-03 18:44:34.920514 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_
2021-06-03 18:44:34.932531 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_
2021-06-03 18:44:34.932531 (Thread-1): 15:44:34 | 10 of 17 START test relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_ [RUN]
2021-06-03 18:44:34.933527 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_".
2021-06-03 18:44:34.934527 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_
2021-06-03 18:44:34.942501 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_"
2021-06-03 18:44:34.943543 (Thread-1): finished collecting timing info
2021-06-03 18:44:34.943543 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:44:34.948526 (Thread-1): On test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_"} */

    
    




select count(*) as validation_errors
from (
    select product_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select product_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_product`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 18:44:37.339195 (Thread-1): finished collecting timing info
2021-06-03 18:44:37.339195 (Thread-1): 15:44:37 | 10 of 17 PASS relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_ [PASS in 2.41s]
2021-06-03 18:44:37.349592 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_
2021-06-03 18:44:37.349592 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_
2021-06-03 18:44:37.349592 (Thread-1): 15:44:37 | 11 of 17 START test relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_ [RUN]
2021-06-03 18:44:37.351587 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_".
2021-06-03 18:44:37.351587 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_
2021-06-03 18:44:37.353579 (Thread-1): unclosed <socket.socket fd=1444, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49949), raddr=('142.250.218.74', 443)>
2021-06-03 18:44:37.353579 (Thread-1): unclosed <socket.socket fd=1456, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49950), raddr=('172.217.162.106', 443)>
2021-06-03 18:44:37.355993 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_"
2021-06-03 18:44:37.355993 (Thread-1): finished collecting timing info
2021-06-03 18:44:37.355993 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:44:37.355993 (Thread-1): On test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_"} */

    
    




select count(*) as validation_errors
from (
    select salesreason_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select salesreason_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 18:44:39.765813 (Thread-1): finished collecting timing info
2021-06-03 18:44:39.765813 (Thread-1): 15:44:39 | 11 of 17 PASS relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_ [PASS in 2.42s]
2021-06-03 18:44:39.765813 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_
2021-06-03 18:44:39.769798 (Thread-1): Began running node test.adventureworks.sum_qty_test
2021-06-03 18:44:39.770795 (Thread-1): 15:44:39 | 12 of 17 START test sum_qty_test..................................... [RUN]
2021-06-03 18:44:39.771797 (Thread-1): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:44:39.771797 (Thread-1): Compiling test.adventureworks.sum_qty_test
2021-06-03 18:44:39.782451 (Thread-1): Writing injected SQL for node "test.adventureworks.sum_qty_test"
2021-06-03 18:44:39.784446 (Thread-1): finished collecting timing info
2021-06-03 18:44:39.784446 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:44:39.790481 (Thread-1): On test.adventureworks.sum_qty_test: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.sum_qty_test"} */

with dbt__CTE__INTERNAL_test as (
with 
   validation as (
    select sum(orderqty) as sum_qty
    from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order` 
   )
select * from validation where sum_qty != 274914
)select count(*) from dbt__CTE__INTERNAL_test
2021-06-03 18:44:42.367828 (Thread-1): finished collecting timing info
2021-06-03 18:44:42.367828 (Thread-1): 15:44:42 | 12 of 17 FAIL 1 sum_qty_test......................................... [FAIL 1 in 2.60s]
2021-06-03 18:44:42.378392 (Thread-1): Finished running node test.adventureworks.sum_qty_test
2021-06-03 18:44:42.378392 (Thread-1): Began running node test.adventureworks.unique_dim_creditcard_creditcard_sk
2021-06-03 18:44:42.378392 (Thread-1): 15:44:42 | 13 of 17 START test unique_dim_creditcard_creditcard_sk.............. [RUN]
2021-06-03 18:44:42.379424 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_creditcard_creditcard_sk".
2021-06-03 18:44:42.379424 (Thread-1): Compiling test.adventureworks.unique_dim_creditcard_creditcard_sk
2021-06-03 18:44:42.383743 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_creditcard_creditcard_sk"
2021-06-03 18:44:42.383743 (Thread-1): finished collecting timing info
2021-06-03 18:44:42.383743 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:44:42.383743 (Thread-1): On test.adventureworks.unique_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        creditcard_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    where creditcard_sk is not null
    group by creditcard_sk
    having count(*) > 1

) validation_errors



2021-06-03 18:44:44.873603 (Thread-1): finished collecting timing info
2021-06-03 18:44:44.873603 (Thread-1): 15:44:44 | 13 of 17 PASS unique_dim_creditcard_creditcard_sk.................... [PASS in 2.49s]
2021-06-03 18:44:44.886661 (Thread-1): Finished running node test.adventureworks.unique_dim_creditcard_creditcard_sk
2021-06-03 18:44:44.886661 (Thread-1): Began running node test.adventureworks.unique_dim_customer_customer_sk
2021-06-03 18:44:44.887159 (Thread-1): 15:44:44 | 14 of 17 START test unique_dim_customer_customer_sk.................. [RUN]
2021-06-03 18:44:44.888462 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_customer_customer_sk".
2021-06-03 18:44:44.888490 (Thread-1): Compiling test.adventureworks.unique_dim_customer_customer_sk
2021-06-03 18:44:44.890537 (Thread-1): unclosed <socket.socket fd=1072, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49943), raddr=('142.250.218.74', 443)>
2021-06-03 18:44:44.890537 (Thread-1): unclosed <socket.socket fd=1256, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49944), raddr=('172.217.162.106', 443)>
2021-06-03 18:44:44.892529 (Thread-1): unclosed <socket.socket fd=1416, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49947), raddr=('142.250.218.74', 443)>
2021-06-03 18:44:44.893527 (Thread-1): unclosed <socket.socket fd=1420, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49948), raddr=('172.217.162.106', 443)>
2021-06-03 18:44:44.895518 (Thread-1): unclosed <socket.socket fd=1328, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49951), raddr=('142.250.218.74', 443)>
2021-06-03 18:44:44.895518 (Thread-1): unclosed <socket.socket fd=1476, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49952), raddr=('172.217.162.106', 443)>
2021-06-03 18:44:44.895518 (Thread-1): unclosed <socket.socket fd=756, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49954), raddr=('172.217.162.106', 443)>
2021-06-03 18:44:44.896518 (Thread-1): unclosed <socket.socket fd=1472, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49953), raddr=('142.250.218.74', 443)>
2021-06-03 18:44:44.896518 (Thread-1): unclosed <socket.socket fd=1540, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49955), raddr=('142.250.218.74', 443)>
2021-06-03 18:44:44.896518 (Thread-1): unclosed <socket.socket fd=1548, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49956), raddr=('172.217.162.106', 443)>
2021-06-03 18:44:44.899510 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_customer_customer_sk"
2021-06-03 18:44:44.900508 (Thread-1): finished collecting timing info
2021-06-03 18:44:44.900508 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:44:44.905486 (Thread-1): On test.adventureworks.unique_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    where customer_sk is not null
    group by customer_sk
    having count(*) > 1

) validation_errors



2021-06-03 18:44:47.447754 (Thread-1): finished collecting timing info
2021-06-03 18:44:47.447754 (Thread-1): 15:44:47 | 14 of 17 PASS unique_dim_customer_customer_sk........................ [PASS in 2.56s]
2021-06-03 18:44:47.447754 (Thread-1): Finished running node test.adventureworks.unique_dim_customer_customer_sk
2021-06-03 18:44:47.458528 (Thread-1): Began running node test.adventureworks.unique_dim_localization_address_sk
2021-06-03 18:44:47.458528 (Thread-1): 15:44:47 | 15 of 17 START test unique_dim_localization_address_sk............... [RUN]
2021-06-03 18:44:47.459533 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_localization_address_sk".
2021-06-03 18:44:47.460520 (Thread-1): Compiling test.adventureworks.unique_dim_localization_address_sk
2021-06-03 18:44:47.467495 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_localization_address_sk"
2021-06-03 18:44:47.468492 (Thread-1): finished collecting timing info
2021-06-03 18:44:47.468492 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:44:47.473474 (Thread-1): On test.adventureworks.unique_dim_localization_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_localization_address_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        address_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    where address_sk is not null
    group by address_sk
    having count(*) > 1

) validation_errors



2021-06-03 18:44:49.989382 (Thread-1): finished collecting timing info
2021-06-03 18:44:49.989382 (Thread-1): 15:44:49 | 15 of 17 PASS unique_dim_localization_address_sk..................... [PASS in 2.53s]
2021-06-03 18:44:49.989382 (Thread-1): Finished running node test.adventureworks.unique_dim_localization_address_sk
2021-06-03 18:44:49.989382 (Thread-1): Began running node test.adventureworks.unique_dim_product_product_sk
2021-06-03 18:44:50.000596 (Thread-1): 15:44:50 | 16 of 17 START test unique_dim_product_product_sk.................... [RUN]
2021-06-03 18:44:50.000596 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_product_product_sk".
2021-06-03 18:44:50.001651 (Thread-1): Compiling test.adventureworks.unique_dim_product_product_sk
2021-06-03 18:44:50.007842 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_product_product_sk"
2021-06-03 18:44:50.008856 (Thread-1): finished collecting timing info
2021-06-03 18:44:50.008856 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:44:50.012841 (Thread-1): On test.adventureworks.unique_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        product_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    where product_sk is not null
    group by product_sk
    having count(*) > 1

) validation_errors



2021-06-03 18:44:52.443635 (Thread-1): finished collecting timing info
2021-06-03 18:44:52.443635 (Thread-1): 15:44:52 | 16 of 17 PASS unique_dim_product_product_sk.......................... [PASS in 2.44s]
2021-06-03 18:44:52.443635 (Thread-1): Finished running node test.adventureworks.unique_dim_product_product_sk
2021-06-03 18:44:52.451163 (Thread-1): Began running node test.adventureworks.unique_dim_salesreason_salesreason_sk
2021-06-03 18:44:52.451163 (Thread-1): 15:44:52 | 17 of 17 START test unique_dim_salesreason_salesreason_sk............ [RUN]
2021-06-03 18:44:52.452229 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_salesreason_salesreason_sk".
2021-06-03 18:44:52.452229 (Thread-1): Compiling test.adventureworks.unique_dim_salesreason_salesreason_sk
2021-06-03 18:44:52.453229 (Thread-1): unclosed <socket.socket fd=1568, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49965), raddr=('142.250.218.74', 443)>
2021-06-03 18:44:52.453229 (Thread-1): unclosed <socket.socket fd=1456, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 49966), raddr=('172.217.162.106', 443)>
2021-06-03 18:44:52.457214 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_salesreason_salesreason_sk"
2021-06-03 18:44:52.458209 (Thread-1): finished collecting timing info
2021-06-03 18:44:52.459260 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 18:44:52.464347 (Thread-1): On test.adventureworks.unique_dim_salesreason_salesreason_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_salesreason_salesreason_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        salesreason_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    where salesreason_sk is not null
    group by salesreason_sk
    having count(*) > 1

) validation_errors



2021-06-03 18:44:54.662203 (Thread-1): finished collecting timing info
2021-06-03 18:44:54.662203 (Thread-1): 15:44:54 | 17 of 17 PASS unique_dim_salesreason_salesreason_sk.................. [PASS in 2.21s]
2021-06-03 18:44:54.662203 (Thread-1): Finished running node test.adventureworks.unique_dim_salesreason_salesreason_sk
2021-06-03 18:44:54.751340 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:44:54.751340 (MainThread): 15:44:54 | 
2021-06-03 18:44:54.751340 (MainThread): 15:44:54 | Finished running 17 tests in 42.73s.
2021-06-03 18:44:54.751340 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:44:54.755350 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:44:54.755350 (MainThread): Connection 'test.adventureworks.unique_dim_salesreason_salesreason_sk' was properly closed.
2021-06-03 18:44:54.765948 (MainThread): 
2021-06-03 18:44:54.766912 (MainThread): Completed with 1 error and 0 warnings:
2021-06-03 18:44:54.768956 (MainThread): 
2021-06-03 18:44:54.769886 (MainThread): Failure in test sum_qty_test (tests\sum_qty_test.sql)
2021-06-03 18:44:54.770886 (MainThread):   Got 1 result, expected 0.
2021-06-03 18:44:54.770886 (MainThread): 
2021-06-03 18:44:54.771881 (MainThread):   compiled SQL at target\compiled\adventureworks\tests\sum_qty_test.sql
2021-06-03 18:44:54.772885 (MainThread): 
Done. PASS=16 WARN=0 ERROR=1 SKIP=0 TOTAL=17
2021-06-03 18:44:54.773957 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D282597FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D282597F48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FD75F108>]}
2021-06-03 18:44:54.774888 (MainThread): Flushing usage events
2021-06-03 18:48:18.270255 (MainThread): Running with dbt=0.19.1
2021-06-03 18:48:18.624465 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['stg_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:48:18.626496 (MainThread): Tracking: tracking
2021-06-03 18:48:18.626496 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F5983A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F5988608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F59881C8>]}
2021-06-03 18:48:18.636640 (MainThread): Partial parsing not enabled
2021-06-03 18:48:18.636640 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:48:18.667027 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:48:18.677207 (MainThread): Parsing macros\etc.sql
2021-06-03 18:48:18.677207 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:48:18.687432 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:48:18.697653 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:48:18.697653 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:48:18.697653 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:48:18.707887 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:48:18.718129 (MainThread): Parsing macros\core.sql
2021-06-03 18:48:18.718129 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:48:18.765840 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:48:18.769828 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:48:18.769828 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:48:18.776950 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:48:18.779033 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:48:18.779033 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:48:18.779033 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:48:18.789248 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:48:18.799499 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:48:18.807576 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:48:18.809642 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:48:18.830077 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:48:18.860583 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:48:18.868724 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:48:18.887754 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:48:18.895733 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:48:18.900719 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:48:18.902707 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:48:18.909944 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:48:18.912205 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:48:18.912205 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:48:18.920358 (MainThread): Partial parsing not enabled
2021-06-03 18:48:18.942913 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:48:18.953232 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:48:18.953232 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:48:18.963504 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:48:18.963504 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:48:18.971622 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:48:18.973724 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:48:18.981901 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:48:18.983971 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:48:18.983971 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:48:18.992043 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:48:18.994178 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:48:18.994178 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:48:19.004450 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:48:19.004450 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:48:19.012610 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:48:19.014715 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:48:19.014715 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:48:19.022867 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:48:19.024953 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:48:19.024953 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:48:19.035167 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:48:19.045380 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:48:19.209425 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adff80ea-fe30-412c-b397-03bd3e6bf88f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F953FF48>]}
2021-06-03 18:48:19.219643 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adff80ea-fe30-412c-b397-03bd3e6bf88f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F957A888>]}
2021-06-03 18:48:19.219643 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:48:19.231916 (MainThread): 
2021-06-03 18:48:19.232947 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:48:19.234916 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:48:19.235903 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:48:20.357900 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:48:20.357900 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:48:20.366315 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:48:21.488624 (MainThread): 15:48:21 | Concurrency: 1 threads (target='dev')
2021-06-03 18:48:21.488624 (MainThread): 15:48:21 | 
2021-06-03 18:48:21.496613 (Thread-1): Began running node model.adventureworks.stg_salesreason
2021-06-03 18:48:21.497675 (Thread-1): 15:48:21 | 1 of 1 START view model dbt_arthur.stg_salesreason................... [RUN]
2021-06-03 18:48:21.498607 (Thread-1): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:48:21.498607 (Thread-1): Compiling model.adventureworks.stg_salesreason
2021-06-03 18:48:21.502594 (Thread-1): Writing injected SQL for node "model.adventureworks.stg_salesreason"
2021-06-03 18:48:21.503633 (Thread-1): finished collecting timing info
2021-06-03 18:48:21.533038 (Thread-1): Writing runtime SQL for node "model.adventureworks.stg_salesreason"
2021-06-03 18:48:21.535024 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:48:21.539009 (Thread-1): On model.adventureworks.stg_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.stg_salesreason"} */


  create or replace view `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
  OPTIONS()
  as with 
    source as (
        select distinct 
         salesreasonid			
         ,name as salereason
         ,reasontype			
         ,modifieddate			
         ,_sdc_batched_at			
         ,_sdc_extracted_at as last_etl_run           			
         ,_sdc_received_at			
         ,_sdc_sequence
         ,_sdc_table_version			
         from `adventureworks-314121`.`adventureworks`.`salesreason`
    )
select * from source;


2021-06-03 18:48:23.640978 (Thread-1): finished collecting timing info
2021-06-03 18:48:23.640978 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adff80ea-fe30-412c-b397-03bd3e6bf88f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F950A188>]}
2021-06-03 18:48:23.640978 (Thread-1): 15:48:23 | 1 of 1 OK created view model dbt_arthur.stg_salesreason.............. [OK in 2.14s]
2021-06-03 18:48:23.640978 (Thread-1): Finished running node model.adventureworks.stg_salesreason
2021-06-03 18:48:23.687345 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:48:23.687345 (MainThread): 15:48:23 | 
2021-06-03 18:48:23.688338 (MainThread): 15:48:23 | Finished running 1 view model in 4.46s.
2021-06-03 18:48:23.689337 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:48:23.689337 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:48:23.689337 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:48:23.689337 (MainThread): Connection 'model.adventureworks.stg_salesreason' was properly closed.
2021-06-03 18:48:23.699299 (MainThread): 
2021-06-03 18:48:23.700305 (MainThread): Completed successfully
2021-06-03 18:48:23.702290 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:48:23.703286 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F9395808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F93956C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F5940688>]}
2021-06-03 18:48:23.703286 (MainThread): Flushing usage events
2021-06-03 18:49:10.678985 (MainThread): Running with dbt=0.19.1
2021-06-03 18:49:11.018786 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:49:11.018786 (MainThread): Tracking: tracking
2021-06-03 18:49:11.018786 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFE86E0988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFE86E0B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFE86E80C8>]}
2021-06-03 18:49:11.029151 (MainThread): Partial parsing not enabled
2021-06-03 18:49:11.029151 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:49:11.049982 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:49:11.060295 (MainThread): Parsing macros\etc.sql
2021-06-03 18:49:11.060295 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:49:11.060295 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:49:11.078949 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:49:11.081152 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:49:11.081152 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:49:11.091590 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:49:11.091590 (MainThread): Parsing macros\core.sql
2021-06-03 18:49:11.101953 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:49:11.142940 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:49:11.152990 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:49:11.152990 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:49:11.152990 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:49:11.152990 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:49:11.152990 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:49:11.161040 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:49:11.163084 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:49:11.183375 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:49:11.183375 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:49:11.191574 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:49:11.214215 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:49:11.245026 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:49:11.245026 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:49:11.265560 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:49:11.273722 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:49:11.275904 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:49:11.286156 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:49:11.286156 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:49:11.286156 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:49:11.286156 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:49:11.296372 (MainThread): Partial parsing not enabled
2021-06-03 18:49:11.317093 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:49:11.327543 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:49:11.335705 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:49:11.337785 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:49:11.337785 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:49:11.348015 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:49:11.348015 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:49:11.356185 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:49:11.358244 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:49:11.358244 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:49:11.368722 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:49:11.368722 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:49:11.376852 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:49:11.379056 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:49:11.379056 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:49:11.387318 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:49:11.389539 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:49:11.389539 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:49:11.399879 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:49:11.399879 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:49:11.399879 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:49:11.410327 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:49:11.424176 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:49:11.596732 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d321435-63f0-4c46-8996-f087c3c51829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFE870A988>]}
2021-06-03 18:49:11.607113 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d321435-63f0-4c46-8996-f087c3c51829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFEC38D088>]}
2021-06-03 18:49:11.607113 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:49:11.612749 (MainThread): 
2021-06-03 18:49:11.613749 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:49:11.616698 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:49:11.616698 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:49:12.778480 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:49:12.778916 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:49:12.785233 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:49:13.868428 (MainThread): 15:49:13 | Concurrency: 1 threads (target='dev')
2021-06-03 18:49:13.868428 (MainThread): 15:49:13 | 
2021-06-03 18:49:13.881547 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 18:49:13.882586 (Thread-1): 15:49:13 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 18:49:13.883541 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:49:13.884538 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 18:49:13.889116 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:49:13.890054 (Thread-1): finished collecting timing info
2021-06-03 18:49:13.911482 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:49:13.918460 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:49:15.033680 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:49:15.049224 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,reasontype
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct
            salesorderheadersalesreason.salesreasonid			
            ,salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select distinct
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
  );
    
2021-06-03 18:49:16.290216 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/adventureworks-314121/queries/4cb29178-a364-46c2-8ba9-720d3bf2be75?maxResults=0&location=US&prettyPrint=false: Name salereason not found inside sourcesalesreason at [27:32]')
2021-06-03 18:49:18.309503 (Thread-1): finished collecting timing info
2021-06-03 18:49:18.310497 (Thread-1): Database Error in model dim_salesreason (models\marts\dim_salesreason.sql)
  Name salereason not found inside sourcesalesreason at [27:32]
  compiled SQL at target\run\adventureworks\models\marts\dim_salesreason.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/adventureworks-314121/queries/374c7d40-50a9-49d1-ad37-197dd26fc4e7?maxResults=0&location=US&prettyPrint=false: Name salereason not found inside sourcesalesreason at [27:32]

(job ID: 374c7d40-50a9-49d1-ad37-197dd26fc4e7)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */
   2:
   3:
   4:  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with 
  10:    sourcesalesreason as (
  11:        select 
  12:         salesreasonid 
  13:         ,reasontype
  14:        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
  15:    )
  16:    , salesorderheadersalesreason as (
  17:        select distinct
  18:            salesorderid
  19:            ,salesreasonid
  20:    
  21:        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
  22:    )   
  23:    , selected as (
  24:        select distinct
  25:            salesorderheadersalesreason.salesreasonid			
  26:            ,salesorderheadersalesreason.salesorderid
  27:            ,sourcesalesreason.salereason			
  28:          
  29:        from salesorderheadersalesreason
  30:        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
  31:    )
  32:    , transformedsalesreason as (
  33:        select distinct
  34:        row_number() over(order by salesreasonid) as salesreason_sk
  35:        , * 
  36:        from selected
  37:    )
  38:select distinct * from transformedsalesreason
  39:  );
  40:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_salesreason (models\marts\dim_salesreason.sql)
  Name salereason not found inside sourcesalesreason at [27:32]
  compiled SQL at target\run\adventureworks\models\marts\dim_salesreason.sql
2021-06-03 18:49:18.326529 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d321435-63f0-4c46-8996-f087c3c51829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFEC1D4D08>]}
2021-06-03 18:49:18.326529 (Thread-1): 15:49:18 | 1 of 1 ERROR creating table model dbt_arthur.dim_salesreason......... [ERROR in 4.44s]
2021-06-03 18:49:18.326529 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 18:49:18.425654 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:49:18.425654 (MainThread): 15:49:18 | 
2021-06-03 18:49:18.425654 (MainThread): 15:49:18 | Finished running 1 table model in 6.81s.
2021-06-03 18:49:18.425654 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:49:18.429295 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:49:18.429295 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:49:18.429295 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 18:49:18.440963 (MainThread): 
2021-06-03 18:49:18.441421 (MainThread): Completed with 1 error and 0 warnings:
2021-06-03 18:49:18.441895 (MainThread): 
2021-06-03 18:49:18.442894 (MainThread): Database Error in model dim_salesreason (models\marts\dim_salesreason.sql)
2021-06-03 18:49:18.444887 (MainThread):   Name salereason not found inside sourcesalesreason at [27:32]
2021-06-03 18:49:18.445883 (MainThread):   compiled SQL at target\run\adventureworks\models\marts\dim_salesreason.sql
2021-06-03 18:49:18.446886 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-06-03 18:49:18.448895 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFE86B4508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFE86B0C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFEC28D108>]}
2021-06-03 18:49:18.448895 (MainThread): Flushing usage events
2021-06-03 18:49:59.699833 (MainThread): Running with dbt=0.19.1
2021-06-03 18:50:00.016703 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:50:00.016703 (MainThread): Tracking: tracking
2021-06-03 18:50:00.016703 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FF4BA0908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FF4B9BE48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FF4BA8588>]}
2021-06-03 18:50:00.048725 (MainThread): Partial parsing not enabled
2021-06-03 18:50:00.052270 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:50:00.073953 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:50:00.084019 (MainThread): Parsing macros\etc.sql
2021-06-03 18:50:00.084019 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:50:00.092049 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:50:00.104960 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:50:00.112482 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:50:00.114501 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:50:00.124776 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:50:00.134836 (MainThread): Parsing macros\core.sql
2021-06-03 18:50:00.134836 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:50:00.185477 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:50:00.195608 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:50:00.195608 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:50:00.195608 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:50:00.195608 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:50:00.205663 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:50:00.205729 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:50:00.215758 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:50:00.235984 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:50:00.235984 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:50:00.246237 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:50:00.266884 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:50:00.306487 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:50:00.307510 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:50:00.327843 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:50:00.338023 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:50:00.346146 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:50:00.348162 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:50:00.356275 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:50:00.358380 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:50:00.358380 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:50:00.366709 (MainThread): Partial parsing not enabled
2021-06-03 18:50:00.387065 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:50:00.399613 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:50:00.399613 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:50:00.407686 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:50:00.409773 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:50:00.409773 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:50:00.419981 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:50:00.419981 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:50:00.430777 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:50:00.435763 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:50:00.439750 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:50:00.443736 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:50:00.448719 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:50:00.452000 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:50:00.452000 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:50:00.459115 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:50:00.461236 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:50:00.461236 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:50:00.471651 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:50:00.471651 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:50:00.479758 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:50:00.481846 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:50:00.492007 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:50:00.676390 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eaa02fbe-5392-4323-bc25-510fec3ab0e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FF4BCAB48>]}
2021-06-03 18:50:00.686739 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eaa02fbe-5392-4323-bc25-510fec3ab0e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FF885FF88>]}
2021-06-03 18:50:00.686739 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:50:00.693204 (MainThread): 
2021-06-03 18:50:00.694370 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:50:00.696186 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:50:00.696186 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:50:01.975073 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:50:01.975626 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:50:01.982903 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:50:02.520486 (MainThread): 15:50:02 | Concurrency: 1 threads (target='dev')
2021-06-03 18:50:02.520486 (MainThread): 15:50:02 | 
2021-06-03 18:50:02.527966 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 18:50:02.528922 (Thread-1): 15:50:02 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 18:50:02.529918 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:50:02.530919 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 18:50:02.535898 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:50:02.536895 (Thread-1): finished collecting timing info
2021-06-03 18:50:02.557869 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:50:02.561863 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:50:03.761801 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:50:03.761801 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,reasontype
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct
            salesorderheadersalesreason.salesreasonid			
            ,salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.reasontype			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select distinct
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
  );
    
2021-06-03 18:50:07.423228 (Thread-1): finished collecting timing info
2021-06-03 18:50:07.423228 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaa02fbe-5392-4323-bc25-510fec3ab0e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FF87AB448>]}
2021-06-03 18:50:07.423228 (Thread-1): 15:50:07 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (27.6k rows, 432.8 KB processed) in 4.89s]
2021-06-03 18:50:07.425179 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 18:50:07.510511 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:50:07.510511 (MainThread): 15:50:07 | 
2021-06-03 18:50:07.510511 (MainThread): 15:50:07 | Finished running 1 table model in 6.82s.
2021-06-03 18:50:07.510511 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:50:07.514103 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:50:07.514103 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:50:07.514103 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 18:50:07.525860 (MainThread): 
2021-06-03 18:50:07.526813 (MainThread): Completed successfully
2021-06-03 18:50:07.527871 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:50:07.528813 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FF4B71AC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FF4B717C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FF4B71A88>]}
2021-06-03 18:50:07.529805 (MainThread): Flushing usage events
2021-06-03 18:50:26.828299 (MainThread): Running with dbt=0.19.1
2021-06-03 18:50:27.144487 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_sales_order'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:50:27.144487 (MainThread): Tracking: tracking
2021-06-03 18:50:27.144487 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CBBE5B7C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CBBE649C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CBBE66488>]}
2021-06-03 18:50:27.144487 (MainThread): Partial parsing not enabled
2021-06-03 18:50:27.160118 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:50:27.178939 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:50:27.178939 (MainThread): Parsing macros\etc.sql
2021-06-03 18:50:27.187067 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:50:27.189162 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:50:27.199398 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:50:27.199398 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:50:27.207535 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:50:27.209632 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:50:27.219747 (MainThread): Parsing macros\core.sql
2021-06-03 18:50:27.219747 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:50:27.268666 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:50:27.278799 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:50:27.280693 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:50:27.280693 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:50:27.280693 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:50:27.288773 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:50:27.288773 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:50:27.300985 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:50:27.311191 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:50:27.311191 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:50:27.321430 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:50:27.341819 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:50:27.372399 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:50:27.372399 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:50:27.393048 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:50:27.393048 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:50:27.403109 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:50:27.411224 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:50:27.413349 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:50:27.413349 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:50:27.413349 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:50:27.423512 (MainThread): Partial parsing not enabled
2021-06-03 18:50:27.443901 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:50:27.454104 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:50:27.454104 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:50:27.464267 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:50:27.464267 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:50:27.474518 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:50:27.474518 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:50:27.484854 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:50:27.484954 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:50:27.484954 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:50:27.495181 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:50:27.495181 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:50:27.503282 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:50:27.506904 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:50:27.506904 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:50:27.513520 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:50:27.515618 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:50:27.515618 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:50:27.525802 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:50:27.525802 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:50:27.533890 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:50:27.535984 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:50:27.546147 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:50:27.719944 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '931b0751-536b-43a5-af42-2f3d7c5dd86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CBBE8A288>]}
2021-06-03 18:50:27.730135 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '931b0751-536b-43a5-af42-2f3d7c5dd86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CBFADA6C8>]}
2021-06-03 18:50:27.730135 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:50:27.738769 (MainThread): 
2021-06-03 18:50:27.739758 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:50:27.740755 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:50:27.741750 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:50:28.840612 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:50:28.840612 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:50:28.847879 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:50:29.923978 (MainThread): 15:50:29 | Concurrency: 1 threads (target='dev')
2021-06-03 18:50:29.939314 (MainThread): 15:50:29 | 
2021-06-03 18:50:29.944315 (Thread-1): Began running node model.adventureworks.fact_sales_order
2021-06-03 18:50:29.945314 (Thread-1): 15:50:29 | 1 of 1 START table model dbt_arthur.fact_sales_order................. [RUN]
2021-06-03 18:50:29.946304 (Thread-1): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:50:29.947304 (Thread-1): Compiling model.adventureworks.fact_sales_order
2021-06-03 18:50:29.952281 (Thread-1): Writing injected SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:50:29.953278 (Thread-1): finished collecting timing info
2021-06-03 18:50:29.975205 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:50:29.980187 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:50:31.094491 (Thread-1): Writing runtime SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:50:31.094491 (Thread-1): On model.adventureworks.fact_sales_order: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.fact_sales_order"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
  
  
  OPTIONS()
  as (
    with 
    salesreason as ( 
        select distinct * from  `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    )
    ,creditcard as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    )
    ,customers as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    )
    , localization as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    )
    , products as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    )
    , sales_orders_sk as (
          select 
            orderheader.salesorderid  
            ,customers.customer_sk as customer_fk		
            ,creditcard.creditcard_sk as creditcard_fk
            ,localization.address_sk as address_fk
            ,orderheader.status	
            ,orderheader.totaldue
            ,orderheader.orderdate						
          from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheader` as orderheader
          left join localization on orderheader.addressid = localization.addressid
          left join customers on orderheader.customerid = customers.customerid
          left join creditcard on orderheader.creditcardid = creditcard.creditcardid

    )
    , sales_orders_details_sk as (
        select 
         orderdetail.salesorderdetailid
         ,orderdetail.salesorderid
         ,products.product_sk as product_fk
         ,orderdetail.specialofferid
         ,orderdetail.orderqty			
         ,orderdetail.unitprice			
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderdetail` as orderdetail
        left join products on orderdetail.productid = products.productid
    )
    , final as (
        select distinct
            sales_orders_sk.salesorderid 
            ,sales_orders_sk.customer_fk
            ,sales_orders_sk.creditcard_fk
            ,sales_orders_details_sk.product_fk
            ,sales_orders_sk.address_fk
            ,sales_orders_sk.status	
            ,sales_orders_sk.orderdate						
            ,sales_orders_details_sk.orderqty			
            ,sales_orders_details_sk.unitprice
            ,salesreason.salesreason_sk as salesreason_fk
						
        from sales_orders_sk 
        left join sales_orders_details_sk on sales_orders_sk.salesorderid = sales_orders_details_sk.salesorderid
        left join salesreason on sales_orders_sk.salesorderid = salesreason.salesorderid		
    )

select  distinct * from final
  );
    
2021-06-03 18:50:36.478919 (Thread-1): finished collecting timing info
2021-06-03 18:50:36.478919 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '931b0751-536b-43a5-af42-2f3d7c5dd86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CBDDEDB48>]}
2021-06-03 18:50:36.478919 (Thread-1): 15:50:36 | 1 of 1 OK created table model dbt_arthur.fact_sales_order............ [CREATE TABLE (131.9k rows, 7.8 MB processed) in 6.53s]
2021-06-03 18:50:36.486044 (Thread-1): Finished running node model.adventureworks.fact_sales_order
2021-06-03 18:50:36.526596 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:50:36.526596 (MainThread): 15:50:36 | 
2021-06-03 18:50:36.527988 (MainThread): 15:50:36 | Finished running 1 table model in 8.79s.
2021-06-03 18:50:36.528995 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:50:36.528995 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:50:36.528995 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:50:36.528995 (MainThread): Connection 'model.adventureworks.fact_sales_order' was properly closed.
2021-06-03 18:50:36.540990 (MainThread): 
2021-06-03 18:50:36.541948 (MainThread): Completed successfully
2021-06-03 18:50:36.542944 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:50:36.543942 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CBBE86888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CBBE86188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CBF9DFC48>]}
2021-06-03 18:50:36.543942 (MainThread): Flushing usage events
2021-06-03 18:54:00.242178 (MainThread): Running with dbt=0.19.1
2021-06-03 18:54:00.602117 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_sales_order'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:54:00.603123 (MainThread): Tracking: tracking
2021-06-03 18:54:00.603123 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E926693A48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92666DFC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E926698108>]}
2021-06-03 18:54:00.614192 (MainThread): Partial parsing not enabled
2021-06-03 18:54:00.615240 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:54:00.638616 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:54:00.644591 (MainThread): Parsing macros\etc.sql
2021-06-03 18:54:00.647581 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:54:00.652572 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:54:00.667472 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:54:00.671520 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:54:00.673524 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:54:00.684499 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:54:00.690444 (MainThread): Parsing macros\core.sql
2021-06-03 18:54:00.695437 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:54:00.742229 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:54:00.750541 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:54:00.750541 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:54:00.750541 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:54:00.750541 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:54:00.758686 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:54:00.760787 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:54:00.770002 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:54:00.784958 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:54:00.787870 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:54:00.793918 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:54:00.811962 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:54:00.843209 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:54:00.843209 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:54:00.866338 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:54:00.879454 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:54:00.889149 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:54:00.897785 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:54:00.902708 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:54:00.904742 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:54:00.906738 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:54:00.914584 (MainThread): Partial parsing not enabled
2021-06-03 18:54:00.941741 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:54:00.954762 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:54:00.959770 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:54:00.964728 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:54:00.969711 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:54:00.974637 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:54:00.982608 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:54:00.987665 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:54:00.992638 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:54:00.996625 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:54:01.002584 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:54:01.008030 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:54:01.012024 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:54:01.017136 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:54:01.022126 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:54:01.027175 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:54:01.032192 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:54:01.037133 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:54:01.041126 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:54:01.046041 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:54:01.051070 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:54:01.059511 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:54:01.074053 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:54:01.270936 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff3befd4-944d-4504-ad3f-fd5f15a28318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9266C0708>]}
2021-06-03 18:54:01.281107 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff3befd4-944d-4504-ad3f-fd5f15a28318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92A2AD4C8>]}
2021-06-03 18:54:01.281107 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:54:01.290431 (MainThread): 
2021-06-03 18:54:01.290929 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:54:01.293164 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:54:01.293164 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:54:02.453896 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:54:02.454407 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:54:02.460464 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:54:03.559001 (MainThread): 15:54:03 | Concurrency: 1 threads (target='dev')
2021-06-03 18:54:03.559001 (MainThread): 15:54:03 | 
2021-06-03 18:54:03.564294 (Thread-1): Began running node model.adventureworks.fact_sales_order
2021-06-03 18:54:03.564294 (Thread-1): 15:54:03 | 1 of 1 START table model dbt_arthur.fact_sales_order................. [RUN]
2021-06-03 18:54:03.564294 (Thread-1): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:54:03.567934 (Thread-1): Compiling model.adventureworks.fact_sales_order
2021-06-03 18:54:03.569323 (Thread-1): Writing injected SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:54:03.569323 (Thread-1): finished collecting timing info
2021-06-03 18:54:03.590912 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:54:03.599349 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:54:04.710917 (Thread-1): Writing runtime SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:54:04.717541 (Thread-1): On model.adventureworks.fact_sales_order: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.fact_sales_order"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
  
  
  OPTIONS()
  as (
    with 
    salesreason as ( 
        select distinct * from  `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    )
    ,creditcard as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    )
    ,customers as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    )
    , localization as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    )
    , products as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    )
    , sales_orders_sk as (
          select 
            orderheader.salesorderid  
            ,customers.customer_sk as customer_fk		
            ,creditcard.creditcard_sk as creditcard_fk
            ,localization.address_sk as address_fk
            ,orderheader.status	
            ,orderheader.totaldue
            ,orderheader.orderdate						
          from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheader` as orderheader
          left join localization on orderheader.addressid = localization.addressid
          left join customers on orderheader.customerid = customers.customerid
          left join creditcard on orderheader.creditcardid = creditcard.creditcardid

    )
    , sales_orders_details_sk as (
        select 
         orderdetail.salesorderdetailid
         ,orderdetail.salesorderid
         ,products.product_sk as product_fk
         ,orderdetail.specialofferid
         ,orderdetail.orderqty			
         ,orderdetail.unitprice			
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderdetail` as orderdetail
        left join products on orderdetail.productid = products.productid
    )
    , final as (
        select distinct
            sales_orders_sk.salesorderid 
            ,sales_orders_sk.customer_fk
            ,sales_orders_sk.creditcard_fk
            ,sales_orders_details_sk.product_fk
            ,sales_orders_sk.address_fk
            ,sales_orders_sk.status	
            ,sales_orders_sk.orderdate						
            ,sales_orders_details_sk.orderqty			
            ,sales_orders_details_sk.unitprice
            ,salesreason.salesreason_sk as salesreason_fk
						
        from sales_orders_sk 
        left join sales_orders_details_sk on sales_orders_sk.salesorderid = sales_orders_details_sk.salesorderid
        left join salesreason on sales_orders_sk.salesorderid = salesreason.salesorderid		
    )

select  distinct * from final
  );
    
2021-06-03 18:54:09.861271 (Thread-1): finished collecting timing info
2021-06-03 18:54:09.862266 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff3befd4-944d-4504-ad3f-fd5f15a28318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E926696548>]}
2021-06-03 18:54:09.862266 (Thread-1): 15:54:09 | 1 of 1 OK created table model dbt_arthur.fact_sales_order............ [CREATE TABLE (131.9k rows, 7.8 MB processed) in 6.30s]
2021-06-03 18:54:09.864729 (Thread-1): Finished running node model.adventureworks.fact_sales_order
2021-06-03 18:54:09.919056 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:54:09.919056 (MainThread): 15:54:09 | 
2021-06-03 18:54:09.920277 (MainThread): 15:54:09 | Finished running 1 table model in 8.63s.
2021-06-03 18:54:09.920277 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:54:09.920277 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:54:09.921286 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:54:09.921286 (MainThread): Connection 'model.adventureworks.fact_sales_order' was properly closed.
2021-06-03 18:54:09.931272 (MainThread): 
2021-06-03 18:54:09.932242 (MainThread): Completed successfully
2021-06-03 18:54:09.933239 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:54:09.934515 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92A09F308>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92A09FD88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92A09FDC8>]}
2021-06-03 18:54:09.934515 (MainThread): Flushing usage events
2021-06-03 18:54:17.638648 (MainThread): Running with dbt=0.19.1
2021-06-03 18:54:17.951058 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:54:17.951058 (MainThread): Tracking: tracking
2021-06-03 18:54:17.951058 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99F530D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99F530BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99F538CC8>]}
2021-06-03 18:54:17.961233 (MainThread): Partial parsing not enabled
2021-06-03 18:54:17.961233 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:54:17.981536 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:54:17.989606 (MainThread): Parsing macros\etc.sql
2021-06-03 18:54:17.991670 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:54:17.991670 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:54:18.001760 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:54:18.001760 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:54:18.009825 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:54:18.019993 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:54:18.022053 (MainThread): Parsing macros\core.sql
2021-06-03 18:54:18.022053 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:54:18.068444 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:54:18.076414 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:54:18.077398 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:54:18.079406 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:54:18.081567 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:54:18.083367 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:54:18.083367 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:54:18.092942 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:54:18.103146 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:54:18.103146 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:54:18.113346 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:54:18.134016 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:54:18.165385 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:54:18.165385 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:54:18.184218 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:54:18.186505 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:54:18.194793 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:54:18.197117 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:54:18.197117 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:54:18.205325 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:54:18.207583 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:54:18.207583 (MainThread): Partial parsing not enabled
2021-06-03 18:54:18.228571 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:54:18.239141 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:54:18.247219 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:54:18.249472 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:54:18.249472 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:54:18.257776 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:54:18.260082 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:54:18.268296 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:54:18.270321 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:54:18.270321 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:54:18.278414 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:54:18.280501 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:54:18.280501 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:54:18.290757 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:54:18.290979 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:54:18.290979 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:54:18.301551 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:54:18.301551 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:54:18.301551 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:54:18.311969 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:54:18.311969 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:54:18.311969 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:54:18.322539 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:54:18.490235 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81e7a070-677c-4578-a654-22be72262f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99F56B888>]}
2021-06-03 18:54:18.498306 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81e7a070-677c-4578-a654-22be72262f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A31D8308>]}
2021-06-03 18:54:18.500571 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:54:18.504418 (MainThread): 
2021-06-03 18:54:18.505679 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:54:18.508249 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:54:18.508249 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:54:19.687026 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:54:19.687026 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:54:19.687026 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:54:20.213857 (MainThread): 15:54:20 | Concurrency: 1 threads (target='dev')
2021-06-03 18:54:20.213857 (MainThread): 15:54:20 | 
2021-06-03 18:54:20.224560 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 18:54:20.225553 (Thread-1): 15:54:20 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 18:54:20.226552 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:54:20.227551 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 18:54:20.232875 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:54:20.234384 (Thread-1): finished collecting timing info
2021-06-03 18:54:20.256822 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:54:20.260808 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:54:21.374207 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:54:21.374207 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,reasontype
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct	
            salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.reasontype			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select distinct
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
  );
    
2021-06-03 18:54:22.408684 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/adventureworks-314121/queries/e6c745bf-b567-4ec2-9810-bfb805c99b80?maxResults=0&location=US&prettyPrint=false: Unrecognized name: salesreasonid at [33:36]')
2021-06-03 18:54:24.350709 (Thread-1): finished collecting timing info
2021-06-03 18:54:24.350709 (Thread-1): Database Error in model dim_salesreason (models\marts\dim_salesreason.sql)
  Unrecognized name: salesreasonid at [33:36]
  compiled SQL at target\run\adventureworks\models\marts\dim_salesreason.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/adventureworks-314121/queries/86ff3c97-3508-4043-8266-d02b44d7ec40?maxResults=0&location=US&prettyPrint=false: Unrecognized name: salesreasonid at [33:36]

(job ID: 86ff3c97-3508-4043-8266-d02b44d7ec40)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */
   2:
   3:
   4:  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with 
  10:    sourcesalesreason as (
  11:        select 
  12:         salesreasonid 
  13:         ,reasontype
  14:        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
  15:    )
  16:    , salesorderheadersalesreason as (
  17:        select distinct
  18:            salesorderid
  19:            ,salesreasonid
  20:    
  21:        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
  22:    )   
  23:    , selected as (
  24:        select distinct	
  25:            salesorderheadersalesreason.salesorderid
  26:            ,sourcesalesreason.reasontype			
  27:          
  28:        from salesorderheadersalesreason
  29:        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
  30:    )
  31:    , transformedsalesreason as (
  32:        select distinct
  33:        row_number() over(order by salesreasonid) as salesreason_sk
  34:        , * 
  35:        from selected
  36:    )
  37:select distinct * from transformedsalesreason
  38:  );
  39:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_salesreason (models\marts\dim_salesreason.sql)
  Unrecognized name: salesreasonid at [33:36]
  compiled SQL at target\run\adventureworks\models\marts\dim_salesreason.sql
2021-06-03 18:54:24.366391 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e7a070-677c-4578-a654-22be72262f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A2FC04C8>]}
2021-06-03 18:54:24.366391 (Thread-1): 15:54:24 | 1 of 1 ERROR creating table model dbt_arthur.dim_salesreason......... [ERROR in 4.14s]
2021-06-03 18:54:24.370982 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 18:54:24.427581 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:54:24.427581 (MainThread): 15:54:24 | 
2021-06-03 18:54:24.427581 (MainThread): 15:54:24 | Finished running 1 table model in 5.92s.
2021-06-03 18:54:24.427581 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:54:24.427581 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:54:24.427581 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:54:24.431641 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 18:54:24.432993 (MainThread): 
2021-06-03 18:54:24.432993 (MainThread): Completed with 1 error and 0 warnings:
2021-06-03 18:54:24.442280 (MainThread): 
2021-06-03 18:54:24.443276 (MainThread): Database Error in model dim_salesreason (models\marts\dim_salesreason.sql)
2021-06-03 18:54:24.444286 (MainThread):   Unrecognized name: salesreasonid at [33:36]
2021-06-03 18:54:24.444286 (MainThread):   compiled SQL at target\run\adventureworks\models\marts\dim_salesreason.sql
2021-06-03 18:54:24.445272 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-06-03 18:54:24.446267 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A2FA1DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A2FA1B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99F4FC948>]}
2021-06-03 18:54:24.447291 (MainThread): Flushing usage events
2021-06-03 18:55:01.071912 (MainThread): Running with dbt=0.19.1
2021-06-03 18:55:01.392917 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:55:01.392917 (MainThread): Tracking: tracking
2021-06-03 18:55:01.392917 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1C520D88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1C520708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1C528148>]}
2021-06-03 18:55:01.403444 (MainThread): Partial parsing not enabled
2021-06-03 18:55:01.403444 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:55:01.422087 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:55:01.424323 (MainThread): Parsing macros\etc.sql
2021-06-03 18:55:01.424323 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:55:01.435557 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:55:01.444626 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:55:01.444626 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:55:01.452721 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:55:01.454960 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:55:01.465438 (MainThread): Parsing macros\core.sql
2021-06-03 18:55:01.465438 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:55:01.506697 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:55:01.517094 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:55:01.517094 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:55:01.517094 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:55:01.517094 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:55:01.517094 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:55:01.525350 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:55:01.527628 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:55:01.546353 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:55:01.548637 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:55:01.548637 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:55:01.569483 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:55:01.600581 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:55:01.600581 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:55:01.621510 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:55:01.629817 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:55:01.632108 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:55:01.640245 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:55:01.642515 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:55:01.642515 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:55:01.642515 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:55:01.653102 (MainThread): Partial parsing not enabled
2021-06-03 18:55:01.674251 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:55:01.684571 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:55:01.684571 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:55:01.692872 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:55:01.695148 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:55:01.695148 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:55:01.705802 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:55:01.705802 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:55:01.705802 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:55:01.716310 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:55:01.716310 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:55:01.716310 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:55:01.726712 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:55:01.726712 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:55:01.726712 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:55:01.737268 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:55:01.737268 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:55:01.745434 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:55:01.747706 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:55:01.747706 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:55:01.755999 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:55:01.758254 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:55:01.768708 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:55:01.933838 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55054e5c-cbed-4586-98ab-ca0b15ef750e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1C550288>]}
2021-06-03 18:55:01.944170 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55054e5c-cbed-4586-98ab-ca0b15ef750e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B200F6408>]}
2021-06-03 18:55:01.944170 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:55:01.951779 (MainThread): 
2021-06-03 18:55:01.952710 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:55:01.955699 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:55:01.955699 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:55:03.197082 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:55:03.197082 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:55:03.197082 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:55:04.329014 (MainThread): 15:55:04 | Concurrency: 1 threads (target='dev')
2021-06-03 18:55:04.329014 (MainThread): 15:55:04 | 
2021-06-03 18:55:04.336660 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 18:55:04.337562 (Thread-1): 15:55:04 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 18:55:04.337562 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:55:04.337562 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 18:55:04.343505 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:55:04.343505 (Thread-1): finished collecting timing info
2021-06-03 18:55:04.366128 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:55:04.372055 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:55:05.470428 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 18:55:05.470428 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,reasontype
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct	
            salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.reasontype			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select distinct
        row_number() over(order by salesorderid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
  );
    
2021-06-03 18:55:09.093074 (Thread-1): finished collecting timing info
2021-06-03 18:55:09.093074 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55054e5c-cbed-4586-98ab-ca0b15ef750e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1FF703C8>]}
2021-06-03 18:55:09.093074 (Thread-1): 15:55:09 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (24.8k rows, 432.8 KB processed) in 4.76s]
2021-06-03 18:55:09.093074 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 18:55:09.140143 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:55:09.141184 (MainThread): 15:55:09 | 
2021-06-03 18:55:09.142141 (MainThread): 15:55:09 | Finished running 1 table model in 7.19s.
2021-06-03 18:55:09.142141 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:55:09.142141 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:55:09.143136 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:55:09.143136 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 18:55:09.153130 (MainThread): 
2021-06-03 18:55:09.154103 (MainThread): Completed successfully
2021-06-03 18:55:09.155098 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:55:09.157090 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1FF708C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B200F6448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B2017D4C8>]}
2021-06-03 18:55:09.157565 (MainThread): Flushing usage events
2021-06-03 18:55:25.087587 (MainThread): Running with dbt=0.19.1
2021-06-03 18:55:25.387600 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_sales_order'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 18:55:25.387600 (MainThread): Tracking: tracking
2021-06-03 18:55:25.387600 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5BBDF0C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5BC543C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5BC543A88>]}
2021-06-03 18:55:25.403226 (MainThread): Partial parsing not enabled
2021-06-03 18:55:25.403226 (MainThread): Parsing macros\adapters.sql
2021-06-03 18:55:25.418849 (MainThread): Parsing macros\catalog.sql
2021-06-03 18:55:25.436476 (MainThread): Parsing macros\etc.sql
2021-06-03 18:55:25.436476 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 18:55:25.436476 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 18:55:25.452101 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 18:55:25.452101 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 18:55:25.452101 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 18:55:25.452101 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 18:55:25.467725 (MainThread): Parsing macros\core.sql
2021-06-03 18:55:25.467725 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 18:55:25.514595 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 18:55:25.514595 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 18:55:25.514595 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 18:55:25.514595 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 18:55:25.514595 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 18:55:25.514595 (MainThread): Parsing macros\etc\query.sql
2021-06-03 18:55:25.514595 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 18:55:25.536782 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 18:55:25.548990 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 18:55:25.548990 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 18:55:25.557052 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 18:55:25.577332 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 18:55:25.607629 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 18:55:25.609687 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 18:55:25.619812 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 18:55:25.629904 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 18:55:25.629904 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 18:55:25.640020 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 18:55:25.640020 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 18:55:25.640020 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 18:55:25.648120 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 18:55:25.650180 (MainThread): Partial parsing not enabled
2021-06-03 18:55:25.674994 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 18:55:25.680688 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 18:55:25.688797 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 18:55:25.690862 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 18:55:25.690862 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 18:55:25.701004 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:55:25.701004 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 18:55:25.709121 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 18:55:25.711189 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 18:55:25.711189 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 18:55:25.719263 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 18:55:25.721331 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 18:55:25.721331 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 18:55:25.729478 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 18:55:25.731547 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 18:55:25.731547 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 18:55:25.739623 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 18:55:25.741693 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 18:55:25.741693 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 18:55:25.751880 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 18:55:25.751880 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 18:55:25.751880 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 18:55:25.762023 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 18:55:25.935351 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dca54b4-95d7-4766-b80b-25dead13f08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5BC57B988>]}
2021-06-03 18:55:25.943431 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dca54b4-95d7-4766-b80b-25dead13f08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5BE51AA08>]}
2021-06-03 18:55:25.943431 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 18:55:25.949382 (MainThread): 
2021-06-03 18:55:25.950379 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:55:25.953365 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 18:55:25.953365 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 18:55:27.083720 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 18:55:27.083720 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 18:55:27.083720 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:55:27.584494 (MainThread): 15:55:27 | Concurrency: 1 threads (target='dev')
2021-06-03 18:55:27.584494 (MainThread): 15:55:27 | 
2021-06-03 18:55:27.599011 (Thread-1): Began running node model.adventureworks.fact_sales_order
2021-06-03 18:55:27.599011 (Thread-1): 15:55:27 | 1 of 1 START table model dbt_arthur.fact_sales_order................. [RUN]
2021-06-03 18:55:27.599011 (Thread-1): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 18:55:27.602313 (Thread-1): Compiling model.adventureworks.fact_sales_order
2021-06-03 18:55:27.603632 (Thread-1): Writing injected SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:55:27.603632 (Thread-1): finished collecting timing info
2021-06-03 18:55:27.640326 (Thread-1): Opening a new connection, currently in state init
2021-06-03 18:55:27.645309 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 18:55:28.186572 (Thread-1): Writing runtime SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 18:55:28.186572 (Thread-1): On model.adventureworks.fact_sales_order: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.fact_sales_order"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
  
  
  OPTIONS()
  as (
    with 
    salesreason as ( 
        select distinct * from  `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    )
    ,creditcard as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    )
    ,customers as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    )
    , localization as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    )
    , products as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    )
    , sales_orders_sk as (
          select 
            orderheader.salesorderid  
            ,customers.customer_sk as customer_fk		
            ,creditcard.creditcard_sk as creditcard_fk
            ,localization.address_sk as address_fk
            ,orderheader.status	
            ,orderheader.totaldue
            ,orderheader.orderdate						
          from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheader` as orderheader
          left join localization on orderheader.addressid = localization.addressid
          left join customers on orderheader.customerid = customers.customerid
          left join creditcard on orderheader.creditcardid = creditcard.creditcardid

    )
    , sales_orders_details_sk as (
        select 
         orderdetail.salesorderdetailid
         ,orderdetail.salesorderid
         ,products.product_sk as product_fk
         ,orderdetail.specialofferid
         ,orderdetail.orderqty			
         ,orderdetail.unitprice			
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderdetail` as orderdetail
        left join products on orderdetail.productid = products.productid
    )
    , final as (
        select distinct
            sales_orders_sk.salesorderid 
            ,sales_orders_sk.customer_fk
            ,sales_orders_sk.creditcard_fk
            ,sales_orders_details_sk.product_fk
            ,sales_orders_sk.address_fk
            ,sales_orders_sk.status	
            ,sales_orders_sk.orderdate						
            ,sales_orders_details_sk.orderqty			
            ,sales_orders_details_sk.unitprice
            ,salesreason.salesreason_sk as salesreason_fk
						
        from sales_orders_sk 
        left join sales_orders_details_sk on sales_orders_sk.salesorderid = sales_orders_details_sk.salesorderid
        left join salesreason on sales_orders_sk.salesorderid = salesreason.salesorderid		
    )

select  distinct * from final
  );
    
2021-06-03 18:55:34.131217 (Thread-1): finished collecting timing info
2021-06-03 18:55:34.131217 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dca54b4-95d7-4766-b80b-25dead13f08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5BE340308>]}
2021-06-03 18:55:34.131217 (Thread-1): 15:55:34 | 1 of 1 OK created table model dbt_arthur.fact_sales_order............ [CREATE TABLE (126.8k rows, 7.5 MB processed) in 6.53s]
2021-06-03 18:55:34.131217 (Thread-1): Finished running node model.adventureworks.fact_sales_order
2021-06-03 18:55:34.178659 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 18:55:34.178659 (MainThread): 15:55:34 | 
2021-06-03 18:55:34.179656 (MainThread): 15:55:34 | Finished running 1 table model in 8.23s.
2021-06-03 18:55:34.180609 (MainThread): Connection 'master' was properly closed.
2021-06-03 18:55:34.180609 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 18:55:34.181607 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 18:55:34.181607 (MainThread): Connection 'model.adventureworks.fact_sales_order' was properly closed.
2021-06-03 18:55:34.190575 (MainThread): 
2021-06-03 18:55:34.191604 (MainThread): Completed successfully
2021-06-03 18:55:34.192621 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 18:55:34.193566 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5BFFF5D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5BC50FE48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5BC5B5148>]}
2021-06-03 18:55:34.193566 (MainThread): Flushing usage events
2021-06-03 19:03:41.661739 (MainThread): Running with dbt=0.19.1
2021-06-03 19:03:42.009082 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 19:03:42.009082 (MainThread): Tracking: tracking
2021-06-03 19:03:42.009082 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF59213A88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF591F0EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF59218808>]}
2021-06-03 19:03:42.019231 (MainThread): Partial parsing not enabled
2021-06-03 19:03:42.019231 (MainThread): Parsing macros\adapters.sql
2021-06-03 19:03:42.039661 (MainThread): Parsing macros\catalog.sql
2021-06-03 19:03:42.047727 (MainThread): Parsing macros\etc.sql
2021-06-03 19:03:42.049791 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 19:03:42.049791 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 19:03:42.067937 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 19:03:42.070000 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 19:03:42.070000 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 19:03:42.080163 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 19:03:42.088281 (MainThread): Parsing macros\core.sql
2021-06-03 19:03:42.090362 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 19:03:42.131225 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 19:03:42.143696 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 19:03:42.144693 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 19:03:42.146685 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 19:03:42.148680 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 19:03:42.150673 (MainThread): Parsing macros\etc\query.sql
2021-06-03 19:03:42.151669 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 19:03:42.160639 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 19:03:42.173945 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 19:03:42.173945 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 19:03:42.182085 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 19:03:42.202461 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 19:03:42.230852 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 19:03:42.230852 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 19:03:42.253005 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 19:03:42.261034 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 19:03:42.263101 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 19:03:42.271214 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 19:03:42.273329 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 19:03:42.273329 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 19:03:42.273329 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 19:03:42.283512 (MainThread): Partial parsing not enabled
2021-06-03 19:03:42.304010 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 19:03:42.314255 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 19:03:42.314255 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 19:03:42.324512 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 19:03:42.324512 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:03:42.332622 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 19:03:42.334758 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 19:03:42.334758 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 19:03:42.344963 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 19:03:42.344963 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 19:03:42.353273 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 19:03:42.355583 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 19:03:42.355583 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 19:03:42.363704 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 19:03:42.365935 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 19:03:42.365935 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 19:03:42.374244 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 19:03:42.376516 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 19:03:42.376516 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 19:03:42.386852 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 19:03:42.386852 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 19:03:42.395048 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 19:03:42.405441 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 19:03:42.583203 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddaa1bb4-19c7-4028-abea-ea003b328124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF59231208>]}
2021-06-03 19:03:42.593501 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddaa1bb4-19c7-4028-abea-ea003b328124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF591C1248>]}
2021-06-03 19:03:42.593501 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 19:03:42.600659 (MainThread): 
2021-06-03 19:03:42.600659 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:03:42.603645 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 19:03:42.603645 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 19:03:43.856202 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 19:03:43.856699 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 19:03:43.864623 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:03:44.971761 (MainThread): 16:03:44 | Concurrency: 1 threads (target='dev')
2021-06-03 19:03:44.971761 (MainThread): 16:03:44 | 
2021-06-03 19:03:44.988645 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 19:03:44.989681 (Thread-1): 16:03:44 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 19:03:44.991602 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:03:44.992518 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 19:03:44.996584 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:03:44.998600 (Thread-1): finished collecting timing info
2021-06-03 19:03:45.019507 (Thread-1): Opening a new connection, currently in state init
2021-06-03 19:03:45.024502 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:03:46.139393 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:03:46.139393 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct	
            salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select distinct
        row_number() over(order by salesorderid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
  );
    
2021-06-03 19:03:49.879225 (Thread-1): finished collecting timing info
2021-06-03 19:03:49.879225 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddaa1bb4-19c7-4028-abea-ea003b328124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF591C22C8>]}
2021-06-03 19:03:49.879225 (Thread-1): 16:03:49 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (27.6k rows, 432.8 KB processed) in 4.89s]
2021-06-03 19:03:49.892063 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 19:03:49.957042 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:03:49.957042 (MainThread): 16:03:49 | 
2021-06-03 19:03:49.957042 (MainThread): 16:03:49 | Finished running 1 table model in 7.36s.
2021-06-03 19:03:49.957042 (MainThread): Connection 'master' was properly closed.
2021-06-03 19:03:49.959736 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 19:03:49.959736 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 19:03:49.959736 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 19:03:49.969510 (MainThread): 
2021-06-03 19:03:49.970516 (MainThread): Completed successfully
2021-06-03 19:03:49.971446 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 19:03:49.973455 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF59247888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5CCB9848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5CCB9088>]}
2021-06-03 19:03:49.973455 (MainThread): Flushing usage events
2021-06-03 19:07:18.800394 (MainThread): Running with dbt=0.19.1
2021-06-03 19:07:19.114498 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 19:07:19.114498 (MainThread): Tracking: tracking
2021-06-03 19:07:19.114498 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48712DE08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B487134A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B487138148>]}
2021-06-03 19:07:19.125138 (MainThread): Partial parsing not enabled
2021-06-03 19:07:19.125138 (MainThread): Parsing macros\adapters.sql
2021-06-03 19:07:19.146171 (MainThread): Parsing macros\catalog.sql
2021-06-03 19:07:19.146171 (MainThread): Parsing macros\etc.sql
2021-06-03 19:07:19.154244 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 19:07:19.156478 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 19:07:19.167089 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 19:07:19.167089 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 19:07:19.167089 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 19:07:19.182859 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 19:07:19.188833 (MainThread): Parsing macros\core.sql
2021-06-03 19:07:19.192828 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 19:07:19.229611 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 19:07:19.239938 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 19:07:19.239938 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 19:07:19.239938 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 19:07:19.239938 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 19:07:19.239938 (MainThread): Parsing macros\etc\query.sql
2021-06-03 19:07:19.247990 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 19:07:19.250445 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 19:07:19.269005 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 19:07:19.269005 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 19:07:19.269005 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 19:07:19.291532 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 19:07:19.322405 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 19:07:19.330735 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 19:07:19.343385 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 19:07:19.353850 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 19:07:19.353850 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 19:07:19.364189 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 19:07:19.364189 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 19:07:19.364189 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 19:07:19.372455 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 19:07:19.374654 (MainThread): Partial parsing not enabled
2021-06-03 19:07:19.395483 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 19:07:19.405836 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 19:07:19.414093 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 19:07:19.416291 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 19:07:19.416291 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:07:19.426629 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 19:07:19.426629 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 19:07:19.437088 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 19:07:19.437088 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 19:07:19.445219 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 19:07:19.450871 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 19:07:19.455810 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 19:07:19.459866 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 19:07:19.464852 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 19:07:19.469763 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 19:07:19.473810 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 19:07:19.479746 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 19:07:19.484746 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 19:07:19.489628 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 19:07:19.494598 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 19:07:19.498571 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 19:07:19.504504 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 19:07:19.516117 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 19:07:19.705647 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63e9c22e-43a2-428d-8253-f5df174aa8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48715A308>]}
2021-06-03 19:07:19.716116 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63e9c22e-43a2-428d-8253-f5df174aa8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48ADC5748>]}
2021-06-03 19:07:19.716116 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 19:07:19.723140 (MainThread): 
2021-06-03 19:07:19.724138 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:07:19.726193 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 19:07:19.726193 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 19:07:20.904666 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 19:07:20.905162 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 19:07:20.911244 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:07:22.009670 (MainThread): 16:07:22 | Concurrency: 1 threads (target='dev')
2021-06-03 19:07:22.010674 (MainThread): 16:07:22 | 
2021-06-03 19:07:22.015552 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 19:07:22.016544 (Thread-1): 16:07:22 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 19:07:22.018549 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:07:22.018549 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 19:07:22.023582 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:07:22.024531 (Thread-1): finished collecting timing info
2021-06-03 19:07:22.043513 (Thread-1): Opening a new connection, currently in state init
2021-06-03 19:07:22.047960 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:07:23.170569 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:07:23.171567 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct	
            salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select distinct
        row_number() over(order by salesorderid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
where salereason <> 'Price' and salereason <> 'Manufacture'
  );
    
2021-06-03 19:07:26.925607 (Thread-1): finished collecting timing info
2021-06-03 19:07:26.925607 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e9c22e-43a2-428d-8253-f5df174aa8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48AC33348>]}
2021-06-03 19:07:26.925607 (Thread-1): 16:07:26 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (10.2k rows, 432.8 KB processed) in 4.91s]
2021-06-03 19:07:26.925607 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 19:07:26.941090 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:07:26.942207 (MainThread): 16:07:26 | 
2021-06-03 19:07:26.943211 (MainThread): 16:07:26 | Finished running 1 table model in 7.22s.
2021-06-03 19:07:26.944200 (MainThread): Connection 'master' was properly closed.
2021-06-03 19:07:26.944200 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 19:07:26.944200 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 19:07:26.944200 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 19:07:26.953694 (MainThread): 
2021-06-03 19:07:26.953694 (MainThread): Completed successfully
2021-06-03 19:07:26.954736 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 19:07:26.955671 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48AC33DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48ABDFA88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48ABDFEC8>]}
2021-06-03 19:07:26.956717 (MainThread): Flushing usage events
2021-06-03 19:07:37.537238 (MainThread): Running with dbt=0.19.1
2021-06-03 19:07:37.966221 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 19:07:37.966221 (MainThread): Tracking: tracking
2021-06-03 19:07:37.974289 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298633D1A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298633D1C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298633D8C48>]}
2021-06-03 19:07:37.976357 (MainThread): Partial parsing not enabled
2021-06-03 19:07:37.984443 (MainThread): Parsing macros\adapters.sql
2021-06-03 19:07:38.004822 (MainThread): Parsing macros\catalog.sql
2021-06-03 19:07:38.007048 (MainThread): Parsing macros\etc.sql
2021-06-03 19:07:38.007048 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 19:07:38.017488 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 19:07:38.027825 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 19:07:38.027825 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 19:07:38.027825 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 19:07:38.038289 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 19:07:38.048646 (MainThread): Parsing macros\core.sql
2021-06-03 19:07:38.048646 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 19:07:38.095372 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 19:07:38.105339 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 19:07:38.106339 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 19:07:38.108328 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 19:07:38.110324 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 19:07:38.112319 (MainThread): Parsing macros\etc\query.sql
2021-06-03 19:07:38.113336 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 19:07:38.120794 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 19:07:38.131237 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 19:07:38.131237 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 19:07:38.141556 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 19:07:38.162239 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 19:07:38.193273 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 19:07:38.193273 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 19:07:38.214273 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 19:07:38.222418 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 19:07:38.224597 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 19:07:38.232859 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 19:07:38.235056 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 19:07:38.235056 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 19:07:38.235056 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 19:07:38.245582 (MainThread): Partial parsing not enabled
2021-06-03 19:07:38.266366 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 19:07:38.276855 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 19:07:38.276855 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 19:07:38.287081 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 19:07:38.287081 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:07:38.295112 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 19:07:38.297212 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 19:07:38.305353 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 19:07:38.307451 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 19:07:38.307451 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 19:07:38.315574 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 19:07:38.317679 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 19:07:38.317679 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 19:07:38.328037 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 19:07:38.328037 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 19:07:38.336259 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 19:07:38.338479 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 19:07:38.338479 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 19:07:38.346830 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 19:07:38.349019 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 19:07:38.357121 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 19:07:38.359545 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 19:07:38.369782 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 19:07:38.544431 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2732e58-dfe4-4ee5-84e1-710e5c4e88c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298633FA588>]}
2021-06-03 19:07:38.546632 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2732e58-dfe4-4ee5-84e1-710e5c4e88c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029865369908>]}
2021-06-03 19:07:38.554659 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 19:07:38.559393 (MainThread): 
2021-06-03 19:07:38.560390 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:07:38.562386 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 19:07:38.563391 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 19:07:39.137744 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 19:07:39.137914 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 19:07:39.143375 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:07:40.231456 (MainThread): 16:07:40 | Concurrency: 1 threads (target='dev')
2021-06-03 19:07:40.231456 (MainThread): 16:07:40 | 
2021-06-03 19:07:40.250334 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 19:07:40.250334 (Thread-1): 16:07:40 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 19:07:40.251333 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:07:40.251333 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 19:07:40.254358 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:07:40.255356 (Thread-1): finished collecting timing info
2021-06-03 19:07:40.276297 (Thread-1): Opening a new connection, currently in state init
2021-06-03 19:07:40.284222 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:07:40.812148 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:07:40.812148 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct	
            salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select distinct
        row_number() over(order by salesorderid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
where salereason <> 'Price' and salereason <> 'Manufacturer'
  );
    
2021-06-03 19:07:44.692013 (Thread-1): finished collecting timing info
2021-06-03 19:07:44.692013 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2732e58-dfe4-4ee5-84e1-710e5c4e88c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029863381588>]}
2021-06-03 19:07:44.692013 (Thread-1): 16:07:44 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (8.4k rows, 432.8 KB processed) in 4.44s]
2021-06-03 19:07:44.692013 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 19:07:44.707701 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:07:44.708696 (MainThread): 16:07:44 | 
2021-06-03 19:07:44.708696 (MainThread): 16:07:44 | Finished running 1 table model in 6.15s.
2021-06-03 19:07:44.709694 (MainThread): Connection 'master' was properly closed.
2021-06-03 19:07:44.710696 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 19:07:44.710696 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 19:07:44.710696 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 19:07:44.718664 (MainThread): 
2021-06-03 19:07:44.719611 (MainThread): Completed successfully
2021-06-03 19:07:44.720613 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 19:07:44.721647 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298633DE388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029866FE7C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029866E289C8>]}
2021-06-03 19:07:44.722604 (MainThread): Flushing usage events
2021-06-03 19:07:55.808662 (MainThread): Running with dbt=0.19.1
2021-06-03 19:07:56.272148 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_sales_order'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 19:07:56.272148 (MainThread): Tracking: tracking
2021-06-03 19:07:56.272148 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2356FCCC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A235700B08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A235700988>]}
2021-06-03 19:07:56.282381 (MainThread): Partial parsing not enabled
2021-06-03 19:07:56.282381 (MainThread): Parsing macros\adapters.sql
2021-06-03 19:07:56.302819 (MainThread): Parsing macros\catalog.sql
2021-06-03 19:07:56.310954 (MainThread): Parsing macros\etc.sql
2021-06-03 19:07:56.313048 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 19:07:56.313048 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 19:07:56.323441 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 19:07:56.333662 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 19:07:56.333662 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 19:07:56.343937 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 19:07:56.343937 (MainThread): Parsing macros\core.sql
2021-06-03 19:07:56.352076 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 19:07:56.393140 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 19:07:56.403395 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 19:07:56.403395 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 19:07:56.405489 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 19:07:56.405489 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 19:07:56.405489 (MainThread): Parsing macros\etc\query.sql
2021-06-03 19:07:56.405489 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 19:07:56.415772 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 19:07:56.434172 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 19:07:56.434172 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 19:07:56.436316 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 19:07:56.456883 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 19:07:56.497746 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 19:07:56.497746 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 19:07:56.507923 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 19:07:56.518082 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 19:07:56.526187 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 19:07:56.528276 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 19:07:56.528276 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 19:07:56.536359 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 19:07:56.538445 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 19:07:56.538445 (MainThread): Partial parsing not enabled
2021-06-03 19:07:56.558747 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 19:07:56.569853 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 19:07:56.578159 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 19:07:56.580465 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 19:07:56.580465 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:07:56.590735 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 19:07:56.590735 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 19:07:56.599004 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 19:07:56.601284 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 19:07:56.601284 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 19:07:56.612126 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 19:07:56.615514 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 19:07:56.619547 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 19:07:56.622542 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 19:07:56.628546 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 19:07:56.632588 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 19:07:56.632588 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 19:07:56.640740 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 19:07:56.642903 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 19:07:56.642903 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 19:07:56.650993 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 19:07:56.653084 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 19:07:56.663311 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 19:07:56.827184 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '513ab686-3e30-4833-923c-50e57f2ab020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A23573B308>]}
2021-06-03 19:07:56.837509 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '513ab686-3e30-4833-923c-50e57f2ab020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A23933B708>]}
2021-06-03 19:07:56.837509 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 19:07:56.851563 (MainThread): 
2021-06-03 19:07:56.852617 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:07:56.854574 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 19:07:56.854574 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 19:07:57.412373 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 19:07:57.412637 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 19:07:57.419195 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:07:58.514272 (MainThread): 16:07:58 | Concurrency: 1 threads (target='dev')
2021-06-03 19:07:58.514272 (MainThread): 16:07:58 | 
2021-06-03 19:07:58.529175 (Thread-1): Began running node model.adventureworks.fact_sales_order
2021-06-03 19:07:58.530169 (Thread-1): 16:07:58 | 1 of 1 START table model dbt_arthur.fact_sales_order................. [RUN]
2021-06-03 19:07:58.530964 (Thread-1): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 19:07:58.530964 (Thread-1): Compiling model.adventureworks.fact_sales_order
2021-06-03 19:07:58.535310 (Thread-1): Writing injected SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 19:07:58.535310 (Thread-1): finished collecting timing info
2021-06-03 19:07:58.567633 (Thread-1): Opening a new connection, currently in state init
2021-06-03 19:07:58.572675 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:07:59.100282 (Thread-1): Writing runtime SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 19:07:59.100282 (Thread-1): On model.adventureworks.fact_sales_order: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.fact_sales_order"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
  
  
  OPTIONS()
  as (
    with 
    salesreason as ( 
        select distinct * from  `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    )
    ,creditcard as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    )
    ,customers as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    )
    , localization as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    )
    , products as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    )
    , sales_orders_sk as (
          select 
            orderheader.salesorderid  
            ,customers.customer_sk as customer_fk		
            ,creditcard.creditcard_sk as creditcard_fk
            ,localization.address_sk as address_fk
            ,orderheader.status	
            ,orderheader.totaldue
            ,orderheader.orderdate						
          from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheader` as orderheader
          left join localization on orderheader.addressid = localization.addressid
          left join customers on orderheader.customerid = customers.customerid
          left join creditcard on orderheader.creditcardid = creditcard.creditcardid

    )
    , sales_orders_details_sk as (
        select 
         orderdetail.salesorderdetailid
         ,orderdetail.salesorderid
         ,products.product_sk as product_fk
         ,orderdetail.specialofferid
         ,orderdetail.orderqty			
         ,orderdetail.unitprice			
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderdetail` as orderdetail
        left join products on orderdetail.productid = products.productid
    )
    , final as (
        select distinct
            sales_orders_sk.salesorderid 
            ,sales_orders_sk.customer_fk
            ,sales_orders_sk.creditcard_fk
            ,sales_orders_details_sk.product_fk
            ,sales_orders_sk.address_fk
            ,sales_orders_sk.status	
            ,sales_orders_sk.orderdate						
            ,sales_orders_details_sk.orderqty			
            ,sales_orders_details_sk.unitprice
            ,salesreason.salesreason_sk as salesreason_fk
						
        from sales_orders_sk 
        left join sales_orders_details_sk on sales_orders_sk.salesorderid = sales_orders_details_sk.salesorderid
        left join salesreason on sales_orders_sk.salesorderid = salesreason.salesorderid		
    )

select  distinct * from final
  );
    
2021-06-03 19:08:04.929275 (Thread-1): finished collecting timing info
2021-06-03 19:08:04.929275 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513ab686-3e30-4833-923c-50e57f2ab020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2389E9788>]}
2021-06-03 19:08:04.929275 (Thread-1): 16:08:04 | 1 of 1 OK created table model dbt_arthur.fact_sales_order............ [CREATE TABLE (121.9k rows, 7.2 MB processed) in 6.40s]
2021-06-03 19:08:04.929275 (Thread-1): Finished running node model.adventureworks.fact_sales_order
2021-06-03 19:08:04.976120 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:08:04.977117 (MainThread): 16:08:04 | 
2021-06-03 19:08:04.977117 (MainThread): 16:08:04 | Finished running 1 table model in 8.12s.
2021-06-03 19:08:04.978119 (MainThread): Connection 'master' was properly closed.
2021-06-03 19:08:04.978119 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 19:08:04.978119 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 19:08:04.979111 (MainThread): Connection 'model.adventureworks.fact_sales_order' was properly closed.
2021-06-03 19:08:04.989077 (MainThread): 
2021-06-03 19:08:04.990074 (MainThread): Completed successfully
2021-06-03 19:08:04.992066 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 19:08:04.993066 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2391A8288>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2391A8BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2391A8648>]}
2021-06-03 19:08:04.993066 (MainThread): Flushing usage events
2021-06-03 19:08:44.841938 (MainThread): Running with dbt=0.19.1
2021-06-03 19:08:45.153499 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 19:08:45.153499 (MainThread): Tracking: tracking
2021-06-03 19:08:45.154516 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A815C03DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A815C01B08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A815C017C8>]}
2021-06-03 19:08:45.162851 (MainThread): Partial parsing not enabled
2021-06-03 19:08:45.164972 (MainThread): Parsing macros\adapters.sql
2021-06-03 19:08:45.183317 (MainThread): Parsing macros\catalog.sql
2021-06-03 19:08:45.185414 (MainThread): Parsing macros\etc.sql
2021-06-03 19:08:45.185414 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 19:08:45.198224 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 19:08:45.211176 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 19:08:45.214169 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 19:08:45.216175 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 19:08:45.226378 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 19:08:45.226378 (MainThread): Parsing macros\core.sql
2021-06-03 19:08:45.234517 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 19:08:45.275429 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 19:08:45.285591 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 19:08:45.285621 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 19:08:45.287740 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 19:08:45.287740 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 19:08:45.287740 (MainThread): Parsing macros\etc\query.sql
2021-06-03 19:08:45.287740 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 19:08:45.298060 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 19:08:45.308268 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 19:08:45.316410 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 19:08:45.318512 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 19:08:45.339232 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 19:08:45.369956 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 19:08:45.369956 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 19:08:45.390352 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 19:08:45.400602 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 19:08:45.400602 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 19:08:45.410861 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 19:08:45.410861 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 19:08:45.410861 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 19:08:45.410861 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 19:08:45.421061 (MainThread): Partial parsing not enabled
2021-06-03 19:08:45.441731 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 19:08:45.451950 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 19:08:45.460082 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 19:08:45.462204 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 19:08:45.462204 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:08:45.472464 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 19:08:45.472464 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 19:08:45.482706 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 19:08:45.482706 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 19:08:45.490826 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 19:08:45.492950 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 19:08:45.492950 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 19:08:45.503088 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 19:08:45.503173 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 19:08:45.503173 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 19:08:45.513392 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 19:08:45.513392 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 19:08:45.521544 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 19:08:45.523649 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 19:08:45.523649 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 19:08:45.531790 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 19:08:45.533887 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 19:08:45.544120 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 19:08:45.726116 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57fde397-e24d-4127-a1d6-26eb6796ed45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A815C20108>]}
2021-06-03 19:08:45.737405 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57fde397-e24d-4127-a1d6-26eb6796ed45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8198C3048>]}
2021-06-03 19:08:45.738468 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 19:08:45.743388 (MainThread): 
2021-06-03 19:08:45.744383 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:08:45.746376 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 19:08:45.746376 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 19:08:47.022782 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 19:08:47.023276 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 19:08:47.030224 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:08:48.136931 (MainThread): 16:08:48 | Concurrency: 1 threads (target='dev')
2021-06-03 19:08:48.136931 (MainThread): 16:08:48 | 
2021-06-03 19:08:48.145967 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 19:08:48.146960 (Thread-1): 16:08:48 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 19:08:48.147952 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:08:48.148954 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 19:08:48.153016 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:08:48.153948 (Thread-1): finished collecting timing info
2021-06-03 19:08:48.173911 (Thread-1): Opening a new connection, currently in state init
2021-06-03 19:08:48.178900 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:08:49.308631 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:08:49.308631 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct	
            salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select distinct
        row_number() over(order by salesorderid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
where salereason <> 'Price' or salereason <> 'Manufacturer'
  );
    
2021-06-03 19:08:53.267369 (Thread-1): finished collecting timing info
2021-06-03 19:08:53.267369 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57fde397-e24d-4127-a1d6-26eb6796ed45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A818F29848>]}
2021-06-03 19:08:53.267369 (Thread-1): 16:08:53 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (27.6k rows, 432.8 KB processed) in 5.12s]
2021-06-03 19:08:53.267369 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 19:08:53.390754 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:08:53.390754 (MainThread): 16:08:53 | 
2021-06-03 19:08:53.390754 (MainThread): 16:08:53 | Finished running 1 table model in 7.65s.
2021-06-03 19:08:53.390754 (MainThread): Connection 'master' was properly closed.
2021-06-03 19:08:53.393350 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 19:08:53.393350 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 19:08:53.393350 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 19:08:53.405245 (MainThread): 
2021-06-03 19:08:53.405245 (MainThread): Completed successfully
2021-06-03 19:08:53.407436 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 19:08:53.408445 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A819277588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A817A2C888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81967BA48>]}
2021-06-03 19:08:53.408445 (MainThread): Flushing usage events
2021-06-03 19:09:14.568313 (MainThread): Running with dbt=0.19.1
2021-06-03 19:09:14.909805 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 19:09:14.909805 (MainThread): Tracking: tracking
2021-06-03 19:09:14.909805 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6859C548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A685C4B08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A685C4C48>]}
2021-06-03 19:09:14.909805 (MainThread): Partial parsing not enabled
2021-06-03 19:09:14.909805 (MainThread): Parsing macros\adapters.sql
2021-06-03 19:09:14.925532 (MainThread): Parsing macros\catalog.sql
2021-06-03 19:09:14.941139 (MainThread): Parsing macros\etc.sql
2021-06-03 19:09:14.941139 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 19:09:14.941139 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 19:09:14.956788 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 19:09:14.956788 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 19:09:14.956788 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 19:09:14.972388 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 19:09:14.972388 (MainThread): Parsing macros\core.sql
2021-06-03 19:09:14.972388 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 19:09:15.022662 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 19:09:15.032953 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 19:09:15.032953 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 19:09:15.032953 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 19:09:15.041049 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 19:09:15.041049 (MainThread): Parsing macros\etc\query.sql
2021-06-03 19:09:15.043161 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 19:09:15.051313 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 19:09:15.063685 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 19:09:15.063685 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 19:09:15.073932 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 19:09:15.092319 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 19:09:15.125143 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 19:09:15.125143 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 19:09:15.145640 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 19:09:15.153801 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 19:09:15.155920 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 19:09:15.164087 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 19:09:15.166213 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 19:09:15.166213 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 19:09:15.166213 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 19:09:15.176476 (MainThread): Partial parsing not enabled
2021-06-03 19:09:15.197051 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 19:09:15.207281 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 19:09:15.207281 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 19:09:15.217518 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 19:09:15.217518 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:09:15.217518 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 19:09:15.227815 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 19:09:15.227815 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 19:09:15.238125 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 19:09:15.238125 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 19:09:15.238125 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 19:09:15.248455 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 19:09:15.248455 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 19:09:15.256681 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 19:09:15.258891 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 19:09:15.258891 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 19:09:15.269173 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 19:09:15.269173 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 19:09:15.277328 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 19:09:15.279433 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 19:09:15.279433 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 19:09:15.289710 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 19:09:15.299987 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 19:09:15.481202 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eed261a5-ec61-4bd5-9f33-4b474bb9eb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A685EA5C8>]}
2021-06-03 19:09:15.481202 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eed261a5-ec61-4bd5-9f33-4b474bb9eb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6C25E588>]}
2021-06-03 19:09:15.481202 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 19:09:15.503148 (MainThread): 
2021-06-03 19:09:15.504207 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:09:15.507095 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 19:09:15.508090 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 19:09:16.070422 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 19:09:16.070919 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 19:09:16.077716 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:09:17.203195 (MainThread): 16:09:17 | Concurrency: 1 threads (target='dev')
2021-06-03 19:09:17.203195 (MainThread): 16:09:17 | 
2021-06-03 19:09:17.213897 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 19:09:17.214897 (Thread-1): 16:09:17 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 19:09:17.215890 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:09:17.216887 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 19:09:17.220879 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:09:17.221873 (Thread-1): finished collecting timing info
2021-06-03 19:09:17.242801 (Thread-1): Opening a new connection, currently in state init
2021-06-03 19:09:17.247783 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:09:18.352718 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:09:18.352718 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct	
            salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select distinct
        row_number() over(order by salesorderid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
where salereason <> 'Price' or salereason <> 'Manufacturer'
  );
    
2021-06-03 19:09:22.566933 (Thread-1): finished collecting timing info
2021-06-03 19:09:22.566933 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eed261a5-ec61-4bd5-9f33-4b474bb9eb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6C08C5C8>]}
2021-06-03 19:09:22.566933 (Thread-1): 16:09:22 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (27.6k rows, 432.8 KB processed) in 5.35s]
2021-06-03 19:09:22.575151 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 19:09:22.628166 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:09:22.629392 (MainThread): 16:09:22 | 
2021-06-03 19:09:22.630011 (MainThread): 16:09:22 | Finished running 1 table model in 7.13s.
2021-06-03 19:09:22.631011 (MainThread): Connection 'master' was properly closed.
2021-06-03 19:09:22.631011 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 19:09:22.631011 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 19:09:22.631011 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 19:09:22.639999 (MainThread): 
2021-06-03 19:09:22.640563 (MainThread): Completed successfully
2021-06-03 19:09:22.641286 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 19:09:22.642285 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6C08C8C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6C05FCC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6C05FD08>]}
2021-06-03 19:09:22.643285 (MainThread): Flushing usage events
2021-06-03 19:09:27.153344 (MainThread): Running with dbt=0.19.1
2021-06-03 19:09:27.551979 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_sales_order'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 19:09:27.552977 (MainThread): Tracking: tracking
2021-06-03 19:09:27.552977 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DE470A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DE443FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DE4730C8>]}
2021-06-03 19:09:27.565214 (MainThread): Partial parsing not enabled
2021-06-03 19:09:27.566198 (MainThread): Parsing macros\adapters.sql
2021-06-03 19:09:27.587126 (MainThread): Parsing macros\catalog.sql
2021-06-03 19:09:27.593086 (MainThread): Parsing macros\etc.sql
2021-06-03 19:09:27.595191 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 19:09:27.595191 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 19:09:27.613642 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 19:09:27.615751 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 19:09:27.615751 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 19:09:27.626057 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 19:09:27.626057 (MainThread): Parsing macros\core.sql
2021-06-03 19:09:27.636351 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 19:09:27.677396 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 19:09:27.685543 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 19:09:27.685543 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 19:09:27.687697 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 19:09:27.687697 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 19:09:27.687697 (MainThread): Parsing macros\etc\query.sql
2021-06-03 19:09:27.687697 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 19:09:27.698065 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 19:09:27.708319 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 19:09:27.717498 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 19:09:27.718560 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 19:09:27.739271 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 19:09:27.770231 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 19:09:27.770231 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 19:09:27.790724 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 19:09:27.800011 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 19:09:27.806054 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 19:09:27.813716 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 19:09:27.818638 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 19:09:27.820688 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 19:09:27.823677 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 19:09:27.831655 (MainThread): Partial parsing not enabled
2021-06-03 19:09:27.856571 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 19:09:27.862551 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 19:09:27.871862 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 19:09:27.871862 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 19:09:27.879949 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:09:27.882171 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 19:09:27.882171 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 19:09:27.892449 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 19:09:27.892449 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 19:09:27.901206 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 19:09:27.902881 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 19:09:27.902881 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 19:09:27.913146 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 19:09:27.913146 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 19:09:27.913146 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 19:09:27.923398 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 19:09:27.923398 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 19:09:27.931541 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 19:09:27.933662 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 19:09:27.933662 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 19:09:27.941850 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 19:09:27.943976 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 19:09:27.954235 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 19:09:28.126755 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f6e337d-4bdc-46d3-a470-27461888613d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DE422C48>]}
2021-06-03 19:09:28.139040 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f6e337d-4bdc-46d3-a470-27461888613d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DE43F908>]}
2021-06-03 19:09:28.139040 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 19:09:28.149483 (MainThread): 
2021-06-03 19:09:28.150475 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:09:28.153517 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 19:09:28.153517 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 19:09:29.289931 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 19:09:29.289931 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 19:09:29.296054 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:09:29.821798 (MainThread): 16:09:29 | Concurrency: 1 threads (target='dev')
2021-06-03 19:09:29.821798 (MainThread): 16:09:29 | 
2021-06-03 19:09:29.830532 (Thread-1): Began running node model.adventureworks.fact_sales_order
2021-06-03 19:09:29.831528 (Thread-1): 16:09:29 | 1 of 1 START table model dbt_arthur.fact_sales_order................. [RUN]
2021-06-03 19:09:29.832587 (Thread-1): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 19:09:29.832587 (Thread-1): Compiling model.adventureworks.fact_sales_order
2021-06-03 19:09:29.836512 (Thread-1): Writing injected SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 19:09:29.837509 (Thread-1): finished collecting timing info
2021-06-03 19:09:29.858490 (Thread-1): Opening a new connection, currently in state init
2021-06-03 19:09:29.863478 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:09:30.992852 (Thread-1): Writing runtime SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 19:09:30.992852 (Thread-1): On model.adventureworks.fact_sales_order: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.fact_sales_order"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
  
  
  OPTIONS()
  as (
    with 
    salesreason as ( 
        select distinct * from  `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    )
    ,creditcard as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    )
    ,customers as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    )
    , localization as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    )
    , products as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    )
    , sales_orders_sk as (
          select 
            orderheader.salesorderid  
            ,customers.customer_sk as customer_fk		
            ,creditcard.creditcard_sk as creditcard_fk
            ,localization.address_sk as address_fk
            ,orderheader.status	
            ,orderheader.totaldue
            ,orderheader.orderdate						
          from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheader` as orderheader
          left join localization on orderheader.addressid = localization.addressid
          left join customers on orderheader.customerid = customers.customerid
          left join creditcard on orderheader.creditcardid = creditcard.creditcardid

    )
    , sales_orders_details_sk as (
        select 
         orderdetail.salesorderdetailid
         ,orderdetail.salesorderid
         ,products.product_sk as product_fk
         ,orderdetail.specialofferid
         ,orderdetail.orderqty			
         ,orderdetail.unitprice			
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderdetail` as orderdetail
        left join products on orderdetail.productid = products.productid
    )
    , final as (
        select distinct
            sales_orders_sk.salesorderid 
            ,sales_orders_sk.customer_fk
            ,sales_orders_sk.creditcard_fk
            ,sales_orders_details_sk.product_fk
            ,sales_orders_sk.address_fk
            ,sales_orders_sk.status	
            ,sales_orders_sk.orderdate						
            ,sales_orders_details_sk.orderqty			
            ,sales_orders_details_sk.unitprice
            ,salesreason.salesreason_sk as salesreason_fk
						
        from sales_orders_sk 
        left join sales_orders_details_sk on sales_orders_sk.salesorderid = sales_orders_details_sk.salesorderid
        left join salesreason on sales_orders_sk.salesorderid = salesreason.salesorderid		
    )

select  distinct * from final
  );
    
2021-06-03 19:09:36.088927 (Thread-1): finished collecting timing info
2021-06-03 19:09:36.088927 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f6e337d-4bdc-46d3-a470-27461888613d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DE460548>]}
2021-06-03 19:09:36.088927 (Thread-1): 16:09:36 | 1 of 1 OK created table model dbt_arthur.fact_sales_order............ [CREATE TABLE (131.9k rows, 7.6 MB processed) in 6.26s]
2021-06-03 19:09:36.103488 (Thread-1): Finished running node model.adventureworks.fact_sales_order
2021-06-03 19:09:36.168716 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:09:36.168716 (MainThread): 16:09:36 | 
2021-06-03 19:09:36.168716 (MainThread): 16:09:36 | Finished running 1 table model in 8.02s.
2021-06-03 19:09:36.168716 (MainThread): Connection 'master' was properly closed.
2021-06-03 19:09:36.168716 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 19:09:36.171334 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 19:09:36.171334 (MainThread): Connection 'model.adventureworks.fact_sales_order' was properly closed.
2021-06-03 19:09:36.180976 (MainThread): 
2021-06-03 19:09:36.181935 (MainThread): Completed successfully
2021-06-03 19:09:36.182930 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 19:09:36.183928 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177E1EC1AC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DFE68148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177E1FB0AC8>]}
2021-06-03 19:09:36.184925 (MainThread): Flushing usage events
2021-06-03 19:10:38.897236 (MainThread): Running with dbt=0.19.1
2021-06-03 19:10:39.253379 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 19:10:39.261450 (MainThread): Tracking: tracking
2021-06-03 19:10:39.261450 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784C270BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784C250F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784C26CB08>]}
2021-06-03 19:10:39.263530 (MainThread): Partial parsing not enabled
2021-06-03 19:10:39.271651 (MainThread): Parsing macros\adapters.sql
2021-06-03 19:10:39.292265 (MainThread): Parsing macros\catalog.sql
2021-06-03 19:10:39.294362 (MainThread): Parsing macros\etc.sql
2021-06-03 19:10:39.294362 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 19:10:39.304521 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 19:10:39.314735 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 19:10:39.314735 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 19:10:39.314735 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 19:10:39.324903 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 19:10:39.335098 (MainThread): Parsing macros\core.sql
2021-06-03 19:10:39.335098 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 19:10:39.375935 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 19:10:39.386282 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 19:10:39.386282 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 19:10:39.386282 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 19:10:39.386282 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 19:10:39.394386 (MainThread): Parsing macros\etc\query.sql
2021-06-03 19:10:39.396479 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 19:10:39.404566 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 19:10:39.416823 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 19:10:39.416823 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 19:10:39.428331 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 19:10:39.448264 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 19:10:39.477566 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 19:10:39.477566 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 19:10:39.497890 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 19:10:39.505994 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 19:10:39.508081 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 19:10:39.516195 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 19:10:39.518281 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 19:10:39.518281 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 19:10:39.518281 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 19:10:39.528468 (MainThread): Partial parsing not enabled
2021-06-03 19:10:39.548668 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 19:10:39.566941 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 19:10:39.569029 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 19:10:39.569029 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 19:10:39.580536 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:10:39.588563 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 19:10:39.590584 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 19:10:39.600743 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 19:10:39.608763 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 19:10:39.610856 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 19:10:39.610856 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 19:10:39.621009 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 19:10:39.621009 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 19:10:39.629118 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 19:10:39.631233 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 19:10:39.631233 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 19:10:39.642978 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 19:10:39.642978 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 19:10:39.649587 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 19:10:39.651682 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 19:10:39.651682 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 19:10:39.661864 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 19:10:39.672070 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 19:10:39.835844 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c50b9ff-576d-4f73-8287-d3494d18a7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784C292548>]}
2021-06-03 19:10:39.849946 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c50b9ff-576d-4f73-8287-d3494d18a7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784FF46F88>]}
2021-06-03 19:10:39.849946 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 19:10:39.855668 (MainThread): 
2021-06-03 19:10:39.856674 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:10:39.858659 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 19:10:39.859656 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 19:10:41.000465 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 19:10:41.000465 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 19:10:41.007136 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:10:42.107627 (MainThread): 16:10:42 | Concurrency: 1 threads (target='dev')
2021-06-03 19:10:42.107627 (MainThread): 16:10:42 | 
2021-06-03 19:10:42.117699 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 19:10:42.117699 (Thread-1): 16:10:42 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 19:10:42.118670 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:10:42.118670 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 19:10:42.121661 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:10:42.122657 (Thread-1): finished collecting timing info
2021-06-03 19:10:42.145870 (Thread-1): Opening a new connection, currently in state init
2021-06-03 19:10:42.149855 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:10:43.257171 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:10:43.257171 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct	
            salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select distinct
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
where salereason <> 'Price' or salereason <> 'Manufacturer'
  );
    
2021-06-03 19:10:44.613356 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/adventureworks-314121/queries/39afd247-4375-4bc8-aa8d-901145d9de07?maxResults=0&location=US&prettyPrint=false: Unrecognized name: salesreasonid; Did you mean salereason? at [33:36]')
2021-06-03 19:10:46.032747 (Thread-1): finished collecting timing info
2021-06-03 19:10:46.032747 (Thread-1): Database Error in model dim_salesreason (models\marts\dim_salesreason.sql)
  Unrecognized name: salesreasonid; Did you mean salereason? at [33:36]
  compiled SQL at target\run\adventureworks\models\marts\dim_salesreason.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/adventureworks-314121/queries/0235c9e8-0e69-478e-89ac-50eb465f2ad7?maxResults=0&location=US&prettyPrint=false: Unrecognized name: salesreasonid; Did you mean salereason? at [33:36]

(job ID: 0235c9e8-0e69-478e-89ac-50eb465f2ad7)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */
   2:
   3:
   4:  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with 
  10:    sourcesalesreason as (
  11:        select 
  12:         salesreasonid 
  13:         ,salereason
  14:        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
  15:    )
  16:    , salesorderheadersalesreason as (
  17:        select distinct
  18:            salesorderid
  19:            ,salesreasonid
  20:    
  21:        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
  22:    )   
  23:    , selected as (
  24:        select distinct	
  25:            salesorderheadersalesreason.salesorderid
  26:            ,sourcesalesreason.salereason			
  27:          
  28:        from salesorderheadersalesreason
  29:        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
  30:    )
  31:    , transformedsalesreason as (
  32:        select distinct
  33:        row_number() over(order by salesreasonid) as salesreason_sk
  34:        , * 
  35:        from selected
  36:    )
  37:select distinct * from transformedsalesreason
  38:where salereason <> 'Price' or salereason <> 'Manufacturer'
  39:  );
  40:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_salesreason (models\marts\dim_salesreason.sql)
  Unrecognized name: salesreasonid; Did you mean salereason? at [33:36]
  compiled SQL at target\run\adventureworks\models\marts\dim_salesreason.sql
2021-06-03 19:10:46.032747 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c50b9ff-576d-4f73-8287-d3494d18a7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784F599A88>]}
2021-06-03 19:10:46.032747 (Thread-1): 16:10:46 | 1 of 1 ERROR creating table model dbt_arthur.dim_salesreason......... [ERROR in 3.91s]
2021-06-03 19:10:46.032747 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 19:10:46.094353 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:10:46.095437 (MainThread): 16:10:46 | 
2021-06-03 19:10:46.096464 (MainThread): 16:10:46 | Finished running 1 table model in 6.24s.
2021-06-03 19:10:46.097471 (MainThread): Connection 'master' was properly closed.
2021-06-03 19:10:46.097471 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 19:10:46.097471 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 19:10:46.097471 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 19:10:46.109006 (MainThread): 
2021-06-03 19:10:46.110021 (MainThread): Completed with 1 error and 0 warnings:
2021-06-03 19:10:46.110999 (MainThread): 
2021-06-03 19:10:46.111994 (MainThread): Database Error in model dim_salesreason (models\marts\dim_salesreason.sql)
2021-06-03 19:10:46.112992 (MainThread):   Unrecognized name: salesreasonid; Did you mean salereason? at [33:36]
2021-06-03 19:10:46.112992 (MainThread):   compiled SQL at target\run\adventureworks\models\marts\dim_salesreason.sql
2021-06-03 19:10:46.113987 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-06-03 19:10:46.113987 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784FEB50C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784FE2E608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002784FCF9CC8>]}
2021-06-03 19:10:46.115029 (MainThread): Flushing usage events
2021-06-03 19:11:40.619576 (MainThread): Running with dbt=0.19.1
2021-06-03 19:11:40.964600 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 19:11:40.964600 (MainThread): Tracking: tracking
2021-06-03 19:11:40.964600 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207A058FAC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207A0CE0B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207A0CE0A08>]}
2021-06-03 19:11:40.973794 (MainThread): Partial parsing not enabled
2021-06-03 19:11:40.973794 (MainThread): Parsing macros\adapters.sql
2021-06-03 19:11:41.002366 (MainThread): Parsing macros\catalog.sql
2021-06-03 19:11:41.004400 (MainThread): Parsing macros\etc.sql
2021-06-03 19:11:41.012435 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 19:11:41.014460 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 19:11:41.024823 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 19:11:41.032945 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 19:11:41.032945 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 19:11:41.043093 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 19:11:41.045171 (MainThread): Parsing macros\core.sql
2021-06-03 19:11:41.045171 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 19:11:41.085757 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 19:11:41.095940 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 19:11:41.095940 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 19:11:41.103958 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 19:11:41.106036 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 19:11:41.106036 (MainThread): Parsing macros\etc\query.sql
2021-06-03 19:11:41.106036 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 19:11:41.116233 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 19:11:41.126376 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 19:11:41.134481 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 19:11:41.136553 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 19:11:41.156861 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 19:11:41.187350 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 19:11:41.187350 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 19:11:41.207761 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 19:11:41.215861 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 19:11:41.217957 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 19:11:41.228092 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 19:11:41.228092 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 19:11:41.228092 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 19:11:41.228092 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 19:11:41.238185 (MainThread): Partial parsing not enabled
2021-06-03 19:11:41.256479 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 19:11:41.268604 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 19:11:41.278741 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 19:11:41.278741 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 19:11:41.288956 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:11:41.288956 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 19:11:41.297002 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 19:11:41.299048 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 19:11:41.299048 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 19:11:41.309189 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 19:11:41.309189 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 19:11:41.309189 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 19:11:41.319285 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 19:11:41.319285 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 19:11:41.319285 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 19:11:41.329463 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 19:11:41.329463 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 19:11:41.329463 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 19:11:41.339523 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 19:11:41.339523 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 19:11:41.339523 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 19:11:41.349751 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 19:11:41.359899 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 19:11:41.532996 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20a79c51-4500-4bb4-8517-9133a46a5d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207A4919048>]}
2021-06-03 19:11:41.543292 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20a79c51-4500-4bb4-8517-9133a46a5d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207A2CA9A88>]}
2021-06-03 19:11:41.543292 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 19:11:41.551315 (MainThread): 
2021-06-03 19:11:41.551811 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:11:41.553809 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 19:11:41.554854 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 19:11:42.685388 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 19:11:42.685883 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 19:11:42.692134 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:11:43.779953 (MainThread): 16:11:43 | Concurrency: 1 threads (target='dev')
2021-06-03 19:11:43.779953 (MainThread): 16:11:43 | 
2021-06-03 19:11:43.790656 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 19:11:43.791653 (Thread-1): 16:11:43 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 19:11:43.792649 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:11:43.793713 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 19:11:43.797728 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:11:43.798638 (Thread-1): finished collecting timing info
2021-06-03 19:11:43.818561 (Thread-1): Opening a new connection, currently in state init
2021-06-03 19:11:43.822547 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:11:44.950481 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:11:44.950481 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct	
            salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select distinct
        row_number() over(order by salesorderid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
where salereason <> 'Price' or salereason <> 'Manufacturer'
  );
    
2021-06-03 19:11:49.146267 (Thread-1): finished collecting timing info
2021-06-03 19:11:49.146267 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20a79c51-4500-4bb4-8517-9133a46a5d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207A2715A48>]}
2021-06-03 19:11:49.146267 (Thread-1): 16:11:49 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (27.6k rows, 432.8 KB processed) in 5.35s]
2021-06-03 19:11:49.146267 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 19:11:49.163076 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:11:49.163076 (MainThread): 16:11:49 | 
2021-06-03 19:11:49.164155 (MainThread): 16:11:49 | Finished running 1 table model in 7.61s.
2021-06-03 19:11:49.164155 (MainThread): Connection 'master' was properly closed.
2021-06-03 19:11:49.164155 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 19:11:49.165072 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 19:11:49.165072 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 19:11:49.173444 (MainThread): 
2021-06-03 19:11:49.174380 (MainThread): Completed successfully
2021-06-03 19:11:49.175379 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 19:11:49.176373 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207A4778A48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207A4778B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207A4778348>]}
2021-06-03 19:11:49.177373 (MainThread): Flushing usage events
2021-06-03 19:12:17.364390 (MainThread): Running with dbt=0.19.1
2021-06-03 19:12:17.677906 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 19:12:17.677906 (MainThread): Tracking: tracking
2021-06-03 19:12:17.677906 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B44BE61B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B44BE49808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B44BE5CE08>]}
2021-06-03 19:12:17.688139 (MainThread): Partial parsing not enabled
2021-06-03 19:12:17.688139 (MainThread): Parsing macros\adapters.sql
2021-06-03 19:12:17.706878 (MainThread): Parsing macros\catalog.sql
2021-06-03 19:12:17.708979 (MainThread): Parsing macros\etc.sql
2021-06-03 19:12:17.716839 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 19:12:17.720881 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 19:12:17.729756 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 19:12:17.729756 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 19:12:17.729756 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 19:12:17.740277 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 19:12:17.750752 (MainThread): Parsing macros\core.sql
2021-06-03 19:12:17.750752 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 19:12:17.798485 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 19:12:17.801571 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 19:12:17.801571 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 19:12:17.809706 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 19:12:17.811806 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 19:12:17.811806 (MainThread): Parsing macros\etc\query.sql
2021-06-03 19:12:17.811806 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 19:12:17.822014 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 19:12:17.832209 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 19:12:17.832209 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 19:12:17.842443 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 19:12:17.863052 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 19:12:17.893762 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 19:12:17.893762 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 19:12:17.914220 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 19:12:17.922247 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 19:12:17.924346 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 19:12:17.934473 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 19:12:17.934473 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 19:12:17.942530 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 19:12:17.942530 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 19:12:17.952666 (MainThread): Partial parsing not enabled
2021-06-03 19:12:17.973355 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 19:12:17.985589 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 19:12:17.986694 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 19:12:17.993849 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 19:12:17.995950 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:12:17.995950 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 19:12:18.006172 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 19:12:18.006172 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 19:12:18.014345 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 19:12:18.016476 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 19:12:18.016476 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 19:12:18.026740 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 19:12:18.026740 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 19:12:18.034854 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 19:12:18.037019 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 19:12:18.037019 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 19:12:18.045144 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 19:12:18.047242 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 19:12:18.047242 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 19:12:18.057495 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 19:12:18.057495 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 19:12:18.065658 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 19:12:18.067788 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 19:12:18.250514 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd707afca-7e55-4e3f-a0d6-73a1139da924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B44BE9B608>]}
2021-06-03 19:12:18.261471 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd707afca-7e55-4e3f-a0d6-73a1139da924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B44DE39B08>]}
2021-06-03 19:12:18.261471 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 19:12:18.264599 (MainThread): 
2021-06-03 19:12:18.264599 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:12:18.264599 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 19:12:18.264599 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 19:12:19.386537 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 19:12:19.386537 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 19:12:19.394423 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:12:19.926217 (MainThread): 16:12:19 | Concurrency: 1 threads (target='dev')
2021-06-03 19:12:19.926217 (MainThread): 16:12:19 | 
2021-06-03 19:12:19.931227 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 19:12:19.931227 (Thread-1): 16:12:19 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 19:12:19.932219 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:12:19.933216 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 19:12:19.936205 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:12:19.937201 (Thread-1): finished collecting timing info
2021-06-03 19:12:19.961404 (Thread-1): Opening a new connection, currently in state init
2021-06-03 19:12:19.966385 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:12:20.525745 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:12:20.525745 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct	
            salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
          
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select distinct
        row_number() over(order by salesorderid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
where salereason <> 'Price' or salereason <> 'Manufacturer' or salereason <> 'Other'
  );
    
2021-06-03 19:12:24.110709 (Thread-1): finished collecting timing info
2021-06-03 19:12:24.110709 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd707afca-7e55-4e3f-a0d6-73a1139da924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B44BE17A48>]}
2021-06-03 19:12:24.110709 (Thread-1): 16:12:24 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (27.6k rows, 432.8 KB processed) in 4.18s]
2021-06-03 19:12:24.114697 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 19:12:24.158727 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:12:24.158727 (MainThread): 16:12:24 | 
2021-06-03 19:12:24.160097 (MainThread): 16:12:24 | Finished running 1 table model in 5.89s.
2021-06-03 19:12:24.161100 (MainThread): Connection 'master' was properly closed.
2021-06-03 19:12:24.161100 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 19:12:24.161100 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 19:12:24.161100 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 19:12:24.173060 (MainThread): 
2021-06-03 19:12:24.173060 (MainThread): Completed successfully
2021-06-03 19:12:24.175055 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 19:12:24.176049 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B448F8AD08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B44FA40588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B44FA40388>]}
2021-06-03 19:12:24.176049 (MainThread): Flushing usage events
2021-06-03 19:14:02.185747 (MainThread): Running with dbt=0.19.1
2021-06-03 19:14:02.495585 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 19:14:02.497644 (MainThread): Tracking: tracking
2021-06-03 19:14:02.497644 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ECE313A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ECE2F0F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ECE3180C8>]}
2021-06-03 19:14:02.506798 (MainThread): Partial parsing not enabled
2021-06-03 19:14:02.508367 (MainThread): Parsing macros\adapters.sql
2021-06-03 19:14:02.518124 (MainThread): Parsing macros\catalog.sql
2021-06-03 19:14:02.528216 (MainThread): Parsing macros\etc.sql
2021-06-03 19:14:02.528216 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 19:14:02.536284 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 19:14:02.549072 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 19:14:02.552062 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 19:14:02.554055 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 19:14:02.564022 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 19:14:02.569005 (MainThread): Parsing macros\core.sql
2021-06-03 19:14:02.571995 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 19:14:02.618171 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 19:14:02.620317 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 19:14:02.620317 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 19:14:02.628346 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 19:14:02.630411 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 19:14:02.630411 (MainThread): Parsing macros\etc\query.sql
2021-06-03 19:14:02.630411 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 19:14:02.640541 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 19:14:02.650709 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 19:14:02.650709 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 19:14:02.660836 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 19:14:02.681141 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 19:14:02.709530 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 19:14:02.711592 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 19:14:02.721723 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 19:14:02.731937 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 19:14:02.731937 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 19:14:02.742062 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 19:14:02.742062 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 19:14:02.742062 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 19:14:02.752197 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 19:14:02.760332 (MainThread): Partial parsing not enabled
2021-06-03 19:14:02.782684 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 19:14:02.790711 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 19:14:02.792779 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 19:14:02.792779 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 19:14:02.802921 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:14:02.802921 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 19:14:02.811045 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 19:14:02.813112 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 19:14:02.813112 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 19:14:02.821186 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 19:14:02.823252 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 19:14:02.823252 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 19:14:02.833360 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 19:14:02.833360 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 19:14:02.833360 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 19:14:02.843506 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 19:14:02.843506 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 19:14:02.843506 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 19:14:02.853688 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 19:14:02.853688 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 19:14:02.853688 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 19:14:02.863826 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 19:14:02.874001 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 19:14:03.037180 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81d437c5-0670-4561-ac6b-67ebf4129c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ECE33A588>]}
2021-06-03 19:14:03.047266 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81d437c5-0670-4561-ac6b-67ebf4129c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ED1F66D48>]}
2021-06-03 19:14:03.047266 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 19:14:03.055982 (MainThread): 
2021-06-03 19:14:03.055982 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:14:03.058975 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 19:14:03.058975 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 19:14:04.310193 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 19:14:04.325813 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 19:14:04.326078 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:14:05.429544 (MainThread): 16:14:05 | Concurrency: 1 threads (target='dev')
2021-06-03 19:14:05.429544 (MainThread): 16:14:05 | 
2021-06-03 19:14:05.437374 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 19:14:05.437374 (Thread-1): 16:14:05 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 19:14:05.438742 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:14:05.438742 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 19:14:05.443057 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:14:05.443324 (Thread-1): finished collecting timing info
2021-06-03 19:14:05.463475 (Thread-1): Opening a new connection, currently in state init
2021-06-03 19:14:05.468464 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:14:06.569823 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:14:06.569823 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct	
            salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
            ,sourcesalesreason.salesreasonid
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select distinct
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
where salereason <> 'Price' or salereason <> 'Manufacturer' or salereason <> 'Other'
  );
    
2021-06-03 19:14:11.242904 (Thread-1): finished collecting timing info
2021-06-03 19:14:11.242904 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81d437c5-0670-4561-ac6b-67ebf4129c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ED1DDCF48>]}
2021-06-03 19:14:11.242904 (Thread-1): 16:14:11 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (27.6k rows, 432.8 KB processed) in 5.80s]
2021-06-03 19:14:11.251494 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 19:14:11.321830 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:14:11.322328 (MainThread): 16:14:11 | 
2021-06-03 19:14:11.322858 (MainThread): 16:14:11 | Finished running 1 table model in 8.27s.
2021-06-03 19:14:11.323354 (MainThread): Connection 'master' was properly closed.
2021-06-03 19:14:11.323354 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 19:14:11.323851 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 19:14:11.323851 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 19:14:11.340181 (MainThread): 
2021-06-03 19:14:11.340676 (MainThread): Completed successfully
2021-06-03 19:14:11.342267 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 19:14:11.343440 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ECE3A4D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ED1E00908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ED19BC048>]}
2021-06-03 19:14:11.343440 (MainThread): Flushing usage events
2021-06-03 19:15:29.478283 (MainThread): Running with dbt=0.19.1
2021-06-03 19:15:29.802205 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 19:15:29.803238 (MainThread): Tracking: tracking
2021-06-03 19:15:29.803299 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216234C1E88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216234F3C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216234F8148>]}
2021-06-03 19:15:29.811072 (MainThread): Partial parsing not enabled
2021-06-03 19:15:29.811072 (MainThread): Parsing macros\adapters.sql
2021-06-03 19:15:29.831732 (MainThread): Parsing macros\catalog.sql
2021-06-03 19:15:29.831732 (MainThread): Parsing macros\etc.sql
2021-06-03 19:15:29.831732 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 19:15:29.841985 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 19:15:29.852482 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 19:15:29.852482 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 19:15:29.852482 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 19:15:29.862956 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 19:15:29.871190 (MainThread): Parsing macros\core.sql
2021-06-03 19:15:29.873399 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 19:15:29.915032 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 19:15:29.923186 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 19:15:29.923186 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 19:15:29.925274 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 19:15:29.925274 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 19:15:29.925274 (MainThread): Parsing macros\etc\query.sql
2021-06-03 19:15:29.925274 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 19:15:29.935812 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 19:15:29.954462 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 19:15:29.956737 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 19:15:29.956737 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 19:15:29.977559 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 19:15:30.015156 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 19:15:30.017418 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 19:15:30.029854 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 19:15:30.037913 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 19:15:30.037913 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 19:15:30.050063 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 19:15:30.050063 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 19:15:30.050063 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 19:15:30.050063 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 19:15:30.060184 (MainThread): Partial parsing not enabled
2021-06-03 19:15:30.080395 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 19:15:30.090572 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 19:15:30.090572 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 19:15:30.100699 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 19:15:30.100699 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:15:30.100699 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 19:15:30.110893 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 19:15:30.110893 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 19:15:30.118961 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 19:15:30.121021 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 19:15:30.121021 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 19:15:30.129153 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 19:15:30.131213 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 19:15:30.131213 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 19:15:30.139280 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 19:15:30.141341 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 19:15:30.141341 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 19:15:30.151519 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 19:15:30.151519 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 19:15:30.151519 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 19:15:30.161648 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 19:15:30.161648 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 19:15:30.171819 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 19:15:30.333981 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e006b83c-8abd-414b-8650-59eb334011a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021623510808>]}
2021-06-03 19:15:30.344167 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e006b83c-8abd-414b-8650-59eb334011a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021627106448>]}
2021-06-03 19:15:30.344167 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 19:15:30.349718 (MainThread): 
2021-06-03 19:15:30.350712 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:15:30.352713 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 19:15:30.353736 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 19:15:31.455247 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 19:15:31.455247 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 19:15:31.464289 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:15:32.553551 (MainThread): 16:15:32 | Concurrency: 1 threads (target='dev')
2021-06-03 19:15:32.553551 (MainThread): 16:15:32 | 
2021-06-03 19:15:32.567276 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 19:15:32.567276 (Thread-1): 16:15:32 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 19:15:32.569265 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:15:32.570265 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 19:15:32.575282 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:15:32.576241 (Thread-1): finished collecting timing info
2021-06-03 19:15:32.595219 (Thread-1): Opening a new connection, currently in state init
2021-06-03 19:15:32.600196 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:15:33.708817 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:15:33.708817 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct	
            salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
            ,sourcesalesreason.salesreasonid
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select distinct
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
where salereason 'Quality' or salereason = 'On Promotion'
  );
    
2021-06-03 19:15:34.310177 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/adventureworks-314121/queries/38dc0907-a7c2-4980-87d2-2d26293c9f49?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got string literal \'Quality\' at [38:18]')
2021-06-03 19:15:35.857055 (Thread-1): finished collecting timing info
2021-06-03 19:15:35.857055 (Thread-1): Database Error in model dim_salesreason (models\marts\dim_salesreason.sql)
  Syntax error: Expected ")" but got string literal 'Quality' at [38:18]
  compiled SQL at target\run\adventureworks\models\marts\dim_salesreason.sql
Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/adventureworks-314121/queries/0f307ace-7a64-41a4-ad03-8198edfb5ccd?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got string literal 'Quality' at [38:18]

(job ID: 0f307ace-7a64-41a4-ad03-8198edfb5ccd)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */
   2:
   3:
   4:  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with 
  10:    sourcesalesreason as (
  11:        select 
  12:         salesreasonid 
  13:         ,salereason
  14:        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
  15:    )
  16:    , salesorderheadersalesreason as (
  17:        select distinct
  18:            salesorderid
  19:            ,salesreasonid
  20:    
  21:        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
  22:    )   
  23:    , selected as (
  24:        select distinct	
  25:            salesorderheadersalesreason.salesorderid
  26:            ,sourcesalesreason.salereason			
  27:            ,sourcesalesreason.salesreasonid
  28:        from salesorderheadersalesreason
  29:        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
  30:    )
  31:    , transformedsalesreason as (
  32:        select distinct
  33:        row_number() over(order by salesreasonid) as salesreason_sk
  34:        , * 
  35:        from selected
  36:    )
  37:select distinct * from transformedsalesreason
  38:where salereason 'Quality' or salereason = 'On Promotion'
  39:  );
  40:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\arthu\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_salesreason (models\marts\dim_salesreason.sql)
  Syntax error: Expected ")" but got string literal 'Quality' at [38:18]
  compiled SQL at target\run\adventureworks\models\marts\dim_salesreason.sql
2021-06-03 19:15:35.857055 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e006b83c-8abd-414b-8650-59eb334011a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021626FA18C8>]}
2021-06-03 19:15:35.857055 (Thread-1): 16:15:35 | 1 of 1 ERROR creating table model dbt_arthur.dim_salesreason......... [ERROR in 3.29s]
2021-06-03 19:15:35.865687 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 19:15:35.949284 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:15:35.949284 (MainThread): 16:15:35 | 
2021-06-03 19:15:35.949284 (MainThread): 16:15:35 | Finished running 1 table model in 5.60s.
2021-06-03 19:15:35.949284 (MainThread): Connection 'master' was properly closed.
2021-06-03 19:15:35.949284 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 19:15:35.953204 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 19:15:35.953204 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 19:15:35.963853 (MainThread): 
2021-06-03 19:15:35.964809 (MainThread): Completed with 1 error and 0 warnings:
2021-06-03 19:15:35.965806 (MainThread): 
2021-06-03 19:15:35.966846 (MainThread): Database Error in model dim_salesreason (models\marts\dim_salesreason.sql)
2021-06-03 19:15:35.968898 (MainThread):   Syntax error: Expected ")" but got string literal 'Quality' at [38:18]
2021-06-03 19:15:35.969793 (MainThread):   compiled SQL at target\run\adventureworks\models\marts\dim_salesreason.sql
2021-06-03 19:15:35.970790 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-06-03 19:15:35.972782 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216270EF608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021626F74188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021626F74488>]}
2021-06-03 19:15:35.972782 (MainThread): Flushing usage events
2021-06-03 19:15:49.994263 (MainThread): Running with dbt=0.19.1
2021-06-03 19:15:50.307780 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_salesreason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 19:15:50.307780 (MainThread): Tracking: tracking
2021-06-03 19:15:50.307780 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96E720C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96EE73C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96EE73AC8>]}
2021-06-03 19:15:50.317893 (MainThread): Partial parsing not enabled
2021-06-03 19:15:50.319496 (MainThread): Parsing macros\adapters.sql
2021-06-03 19:15:50.337813 (MainThread): Parsing macros\catalog.sql
2021-06-03 19:15:50.343761 (MainThread): Parsing macros\etc.sql
2021-06-03 19:15:50.345755 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 19:15:50.349741 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 19:15:50.361702 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 19:15:50.363695 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 19:15:50.365688 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 19:15:50.368908 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 19:15:50.379127 (MainThread): Parsing macros\core.sql
2021-06-03 19:15:50.379127 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 19:15:50.418455 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 19:15:50.430804 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 19:15:50.430804 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 19:15:50.430804 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 19:15:50.438867 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 19:15:50.438867 (MainThread): Parsing macros\etc\query.sql
2021-06-03 19:15:50.440925 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 19:15:50.448948 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 19:15:50.461176 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 19:15:50.469243 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 19:15:50.471279 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 19:15:50.491464 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 19:15:50.521770 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 19:15:50.521770 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 19:15:50.541958 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 19:15:50.552120 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 19:15:50.552158 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 19:15:50.562326 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 19:15:50.562326 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 19:15:50.562326 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 19:15:50.562326 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 19:15:50.572478 (MainThread): Partial parsing not enabled
2021-06-03 19:15:50.592759 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 19:15:50.602879 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 19:15:50.602879 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 19:15:50.612987 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 19:15:50.612987 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:15:50.612987 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 19:15:50.623112 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 19:15:50.623112 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 19:15:50.631220 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 19:15:50.633280 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 19:15:50.633280 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 19:15:50.641351 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 19:15:50.643413 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 19:15:50.643413 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 19:15:50.653607 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 19:15:50.653607 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 19:15:50.661676 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 19:15:50.663749 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 19:15:50.663749 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 19:15:50.671844 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 19:15:50.673891 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 19:15:50.673891 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 19:15:50.684049 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 19:15:50.846271 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f07c5175-cb21-4c9c-8b91-f128057a2956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E972947108>]}
2021-06-03 19:15:50.856450 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f07c5175-cb21-4c9c-8b91-f128057a2956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96EE30288>]}
2021-06-03 19:15:50.856450 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 19:15:50.862866 (MainThread): 
2021-06-03 19:15:50.863260 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:15:50.864256 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 19:15:50.864256 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 19:15:51.973435 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 19:15:51.973736 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 19:15:51.979631 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:15:53.139532 (MainThread): 16:15:53 | Concurrency: 1 threads (target='dev')
2021-06-03 19:15:53.140529 (MainThread): 16:15:53 | 
2021-06-03 19:15:53.144052 (Thread-1): Began running node model.adventureworks.dim_salesreason
2021-06-03 19:15:53.144052 (Thread-1): 16:15:53 | 1 of 1 START table model dbt_arthur.dim_salesreason.................. [RUN]
2021-06-03 19:15:53.144923 (Thread-1): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:15:53.144923 (Thread-1): Compiling model.adventureworks.dim_salesreason
2021-06-03 19:15:53.148915 (Thread-1): Writing injected SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:15:53.149958 (Thread-1): finished collecting timing info
2021-06-03 19:15:53.171875 (Thread-1): Opening a new connection, currently in state init
2021-06-03 19:15:53.176865 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:15:54.296412 (Thread-1): Writing runtime SQL for node "model.adventureworks.dim_salesreason"
2021-06-03 19:15:54.296412 (Thread-1): On model.adventureworks.dim_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.dim_salesreason"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
  
  
  OPTIONS()
  as (
    with 
    sourcesalesreason as (
        select 
         salesreasonid 
         ,salereason
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesreason`
    )
    , salesorderheadersalesreason as (
        select distinct
            salesorderid
            ,salesreasonid
    
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheadersalesreason` 
    )   
    , selected as (
        select distinct	
            salesorderheadersalesreason.salesorderid
            ,sourcesalesreason.salereason			
            ,sourcesalesreason.salesreasonid
        from salesorderheadersalesreason
        left join sourcesalesreason on salesorderheadersalesreason.salesreasonid =  sourcesalesreason.salesreasonid
    )
    , transformedsalesreason as (
        select distinct
        row_number() over(order by salesreasonid) as salesreason_sk
        , * 
        from selected
    )
select distinct * from transformedsalesreason
where salereason = 'Quality' or salereason = 'On Promotion'
  );
    
2021-06-03 19:15:58.110977 (Thread-1): finished collecting timing info
2021-06-03 19:15:58.110977 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07c5175-cb21-4c9c-8b91-f128057a2956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E970C3E4C8>]}
2021-06-03 19:15:58.110977 (Thread-1): 16:15:58 | 1 of 1 OK created table model dbt_arthur.dim_salesreason............. [CREATE TABLE (5.1k rows, 432.8 KB processed) in 4.97s]
2021-06-03 19:15:58.110977 (Thread-1): Finished running node model.adventureworks.dim_salesreason
2021-06-03 19:15:58.204354 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:15:58.204354 (MainThread): 16:15:58 | 
2021-06-03 19:15:58.204354 (MainThread): 16:15:58 | Finished running 1 table model in 7.34s.
2021-06-03 19:15:58.204354 (MainThread): Connection 'master' was properly closed.
2021-06-03 19:15:58.207883 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 19:15:58.207883 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 19:15:58.207883 (MainThread): Connection 'model.adventureworks.dim_salesreason' was properly closed.
2021-06-03 19:15:58.210854 (MainThread): 
2021-06-03 19:15:58.210854 (MainThread): Completed successfully
2021-06-03 19:15:58.221055 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 19:15:58.221055 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96EEA2EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96EEA2AC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96EEA2848>]}
2021-06-03 19:15:58.222053 (MainThread): Flushing usage events
2021-06-03 19:19:12.332097 (MainThread): Running with dbt=0.19.1
2021-06-03 19:19:12.643367 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_sales_order'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-03 19:19:12.643367 (MainThread): Tracking: tracking
2021-06-03 19:19:12.643367 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F466F43A48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F466F20FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F466F3CC88>]}
2021-06-03 19:19:12.653538 (MainThread): Partial parsing not enabled
2021-06-03 19:19:12.653538 (MainThread): Parsing macros\adapters.sql
2021-06-03 19:19:12.673845 (MainThread): Parsing macros\catalog.sql
2021-06-03 19:19:12.681931 (MainThread): Parsing macros\etc.sql
2021-06-03 19:19:12.684017 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 19:19:12.684017 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 19:19:12.704286 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 19:19:12.704286 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 19:19:12.704286 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 19:19:12.714452 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 19:19:12.722515 (MainThread): Parsing macros\core.sql
2021-06-03 19:19:12.724571 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 19:19:12.765092 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 19:19:12.773198 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 19:19:12.775299 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 19:19:12.775299 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 19:19:12.775299 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 19:19:12.775299 (MainThread): Parsing macros\etc\query.sql
2021-06-03 19:19:12.775299 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 19:19:12.785418 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 19:19:12.803695 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 19:19:12.803695 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 19:19:12.805757 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 19:19:12.826018 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 19:19:12.856439 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 19:19:12.856439 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 19:19:12.878411 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 19:19:12.885386 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 19:19:12.890372 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 19:19:12.897346 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 19:19:12.899341 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 19:19:12.901336 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 19:19:12.903634 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 19:19:12.908710 (MainThread): Partial parsing not enabled
2021-06-03 19:19:12.928405 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 19:19:12.938885 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 19:19:12.938885 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 19:19:12.946988 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 19:19:12.949232 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:19:12.949232 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 19:19:12.959799 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 19:19:12.959799 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 19:19:12.967937 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 19:19:12.970131 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 19:19:12.970131 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 19:19:12.978384 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 19:19:12.980585 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 19:19:12.980585 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 19:19:12.990977 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 19:19:12.990977 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 19:19:12.990977 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 19:19:13.001566 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 19:19:13.001566 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 19:19:13.001566 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 19:19:13.012175 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 19:19:13.012175 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 19:19:13.022718 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 19:19:13.190130 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff3b8fac-3b18-4863-9c9b-8a22822bb184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F466F7DCC8>]}
2021-06-03 19:19:13.200368 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff3b8fac-3b18-4863-9c9b-8a22822bb184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F466EAB2C8>]}
2021-06-03 19:19:13.200368 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 19:19:13.205591 (MainThread): 
2021-06-03 19:19:13.206533 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:19:13.209573 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_adventureworks-314121".
2021-06-03 19:19:13.209573 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-03 19:19:13.865423 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 19:19:13.865423 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 19:19:13.872354 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:19:14.422846 (MainThread): 16:19:14 | Concurrency: 1 threads (target='dev')
2021-06-03 19:19:14.422846 (MainThread): 16:19:14 | 
2021-06-03 19:19:14.428931 (Thread-1): Began running node model.adventureworks.fact_sales_order
2021-06-03 19:19:14.428931 (Thread-1): 16:19:14 | 1 of 1 START table model dbt_arthur.fact_sales_order................. [RUN]
2021-06-03 19:19:14.430927 (Thread-1): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 19:19:14.430927 (Thread-1): Compiling model.adventureworks.fact_sales_order
2021-06-03 19:19:14.438530 (Thread-1): Writing injected SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 19:19:14.440555 (Thread-1): finished collecting timing info
2021-06-03 19:19:14.465873 (Thread-1): Opening a new connection, currently in state init
2021-06-03 19:19:14.473587 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:19:15.571051 (Thread-1): Writing runtime SQL for node "model.adventureworks.fact_sales_order"
2021-06-03 19:19:15.586766 (Thread-1): On model.adventureworks.fact_sales_order: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "model.adventureworks.fact_sales_order"} */


  create or replace table `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
  
  
  OPTIONS()
  as (
    with 
    salesreason as ( 
        select distinct * from  `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    )
    ,creditcard as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    )
    ,customers as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    )
    , localization as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    )
    , products as (
        select  * from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    )
    , sales_orders_sk as (
          select 
            orderheader.salesorderid  
            ,customers.customer_sk as customer_fk		
            ,creditcard.creditcard_sk as creditcard_fk
            ,localization.address_sk as address_fk
            ,orderheader.status	
            ,orderheader.totaldue
            ,orderheader.orderdate						
          from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderheader` as orderheader
          left join localization on orderheader.addressid = localization.addressid
          left join customers on orderheader.customerid = customers.customerid
          left join creditcard on orderheader.creditcardid = creditcard.creditcardid

    )
    , sales_orders_details_sk as (
        select 
         orderdetail.salesorderdetailid
         ,orderdetail.salesorderid
         ,products.product_sk as product_fk
         ,orderdetail.specialofferid
         ,orderdetail.orderqty			
         ,orderdetail.unitprice			
        from `adventureworks-314121`.`dbt_arthur`.`stg_salesorderdetail` as orderdetail
        left join products on orderdetail.productid = products.productid
    )
    , final as (
        select distinct
            sales_orders_sk.salesorderid 
            ,sales_orders_sk.customer_fk
            ,sales_orders_sk.creditcard_fk
            ,sales_orders_details_sk.product_fk
            ,sales_orders_sk.address_fk
            ,sales_orders_sk.status	
            ,sales_orders_sk.orderdate						
            ,sales_orders_details_sk.orderqty			
            ,sales_orders_details_sk.unitprice
            ,salesreason.salesreason_sk as salesreason_fk
						
        from sales_orders_sk 
        left join sales_orders_details_sk on sales_orders_sk.salesorderid = sales_orders_details_sk.salesorderid
        left join salesreason on sales_orders_sk.salesorderid = salesreason.salesorderid		
    )

select  distinct * from final
  );
    
2021-06-03 19:19:20.839751 (Thread-1): finished collecting timing info
2021-06-03 19:19:20.840741 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff3b8fac-3b18-4863-9c9b-8a22822bb184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F468EBA788>]}
2021-06-03 19:19:20.840741 (Thread-1): 16:19:20 | 1 of 1 OK created table model dbt_arthur.fact_sales_order............ [CREATE TABLE (121.3k rows, 7.1 MB processed) in 6.41s]
2021-06-03 19:19:20.842635 (Thread-1): Finished running node model.adventureworks.fact_sales_order
2021-06-03 19:19:20.908825 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:19:20.909821 (MainThread): 16:19:20 | 
2021-06-03 19:19:20.910539 (MainThread): 16:19:20 | Finished running 1 table model in 7.70s.
2021-06-03 19:19:20.911542 (MainThread): Connection 'master' was properly closed.
2021-06-03 19:19:20.911542 (MainThread): Connection 'list_adventureworks-314121' was properly closed.
2021-06-03 19:19:20.911542 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 19:19:20.911542 (MainThread): Connection 'model.adventureworks.fact_sales_order' was properly closed.
2021-06-03 19:19:20.922133 (MainThread): 
2021-06-03 19:19:20.922133 (MainThread): Completed successfully
2021-06-03 19:19:20.924148 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-03 19:19:20.925123 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46AB9E288>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46AB0B0C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F466EF0648>]}
2021-06-03 19:19:20.925123 (MainThread): Flushing usage events
2021-06-03 19:19:53.958182 (MainThread): Running with dbt=0.19.1
2021-06-03 19:19:54.266064 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\arthu\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-03 19:19:54.266064 (MainThread): Tracking: tracking
2021-06-03 19:19:54.266064 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4B307A988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4B3190DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4B3190D08>]}
2021-06-03 19:19:54.276297 (MainThread): Partial parsing not enabled
2021-06-03 19:19:54.276297 (MainThread): Parsing macros\adapters.sql
2021-06-03 19:19:54.296761 (MainThread): Parsing macros\catalog.sql
2021-06-03 19:19:54.296761 (MainThread): Parsing macros\etc.sql
2021-06-03 19:19:54.305014 (MainThread): Parsing macros\materializations\copy.sql
2021-06-03 19:19:54.307304 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-03 19:19:54.317656 (MainThread): Parsing macros\materializations\seed.sql
2021-06-03 19:19:54.317656 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-03 19:19:54.325954 (MainThread): Parsing macros\materializations\table.sql
2021-06-03 19:19:54.328210 (MainThread): Parsing macros\materializations\view.sql
2021-06-03 19:19:54.338575 (MainThread): Parsing macros\core.sql
2021-06-03 19:19:54.338575 (MainThread): Parsing macros\adapters\common.sql
2021-06-03 19:19:54.385362 (MainThread): Parsing macros\etc\datetime.sql
2021-06-03 19:19:54.390324 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-03 19:19:54.390324 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-03 19:19:54.398352 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-03 19:19:54.400524 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-03 19:19:54.400524 (MainThread): Parsing macros\etc\query.sql
2021-06-03 19:19:54.400524 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-03 19:19:54.410670 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-03 19:19:54.421072 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-03 19:19:54.429380 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-03 19:19:54.431656 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-03 19:19:54.452596 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-03 19:19:54.491348 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-03 19:19:54.493438 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-03 19:19:54.513760 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-03 19:19:54.521858 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-03 19:19:54.524029 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-03 19:19:54.532267 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-03 19:19:54.534388 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-03 19:19:54.539675 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-03 19:19:54.542955 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-03 19:19:54.544555 (MainThread): Partial parsing not enabled
2021-06-03 19:19:54.565465 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_creditcard".
2021-06-03 19:19:54.575909 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_customer".
2021-06-03 19:19:54.584212 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_localization".
2021-06-03 19:19:54.586468 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_product".
2021-06-03 19:19:54.586468 (MainThread): Acquiring new bigquery connection "model.adventureworks.dim_salesreason".
2021-06-03 19:19:54.596859 (MainThread): Acquiring new bigquery connection "model.adventureworks.fact_sales_order".
2021-06-03 19:19:54.596859 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_address".
2021-06-03 19:19:54.605174 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_businessentitycontact".
2021-06-03 19:19:54.607458 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_countryregion".
2021-06-03 19:19:54.607458 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_creditcard".
2021-06-03 19:19:54.617805 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_customer".
2021-06-03 19:19:54.617805 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_person".
2021-06-03 19:19:54.617805 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_personcreditcard".
2021-06-03 19:19:54.628398 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_product".
2021-06-03 19:19:54.628398 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_productlistpricehistory".
2021-06-03 19:19:54.628398 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderdetail".
2021-06-03 19:19:54.638787 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheader".
2021-06-03 19:19:54.638787 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesorderheadersalesreason".
2021-06-03 19:19:54.647144 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesreason".
2021-06-03 19:19:54.649412 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_salesterritory".
2021-06-03 19:19:54.649412 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_stateprovince".
2021-06-03 19:19:54.657548 (MainThread): Acquiring new bigquery connection "model.adventureworks.stg_store".
2021-06-03 19:19:54.668170 (MainThread): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 19:19:54.834305 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25e8266f-224f-4582-8a15-f26cc0c01dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4B6DC4F48>]}
2021-06-03 19:19:54.844555 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25e8266f-224f-4582-8a15-f26cc0c01dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4B6E2D308>]}
2021-06-03 19:19:54.844654 (MainThread): Found 22 models, 17 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 17 sources, 0 exposures
2021-06-03 19:19:54.850328 (MainThread): 
2021-06-03 19:19:54.851328 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:19:54.855128 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_adventureworks-314121_dbt_arthur".
2021-06-03 19:19:54.856129 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-03 19:19:54.860114 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-03 19:19:55.410448 (MainThread): 16:19:55 | Concurrency: 1 threads (target='dev')
2021-06-03 19:19:55.410448 (MainThread): 16:19:55 | 
2021-06-03 19:19:55.414843 (Thread-1): Began running node test.adventureworks.not_null_dim_creditcard_creditcard_sk
2021-06-03 19:19:55.415341 (Thread-1): 16:19:55 | 1 of 17 START test not_null_dim_creditcard_creditcard_sk............. [RUN]
2021-06-03 19:19:55.416212 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_creditcard_creditcard_sk".
2021-06-03 19:19:55.416710 (Thread-1): Compiling test.adventureworks.not_null_dim_creditcard_creditcard_sk
2021-06-03 19:19:55.430538 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_creditcard_creditcard_sk"
2021-06-03 19:19:55.431901 (Thread-1): finished collecting timing info
2021-06-03 19:19:55.431901 (Thread-1): Opening a new connection, currently in state init
2021-06-03 19:19:55.440295 (Thread-1): On test.adventureworks.not_null_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
where creditcard_sk is null



2021-06-03 19:19:57.984784 (Thread-1): finished collecting timing info
2021-06-03 19:19:57.984784 (Thread-1): 16:19:57 | 1 of 17 PASS not_null_dim_creditcard_creditcard_sk................... [PASS in 2.57s]
2021-06-03 19:19:57.984784 (Thread-1): Finished running node test.adventureworks.not_null_dim_creditcard_creditcard_sk
2021-06-03 19:19:57.999135 (Thread-1): Began running node test.adventureworks.not_null_dim_customer_customer_sk
2021-06-03 19:19:57.999135 (Thread-1): 16:19:57 | 2 of 17 START test not_null_dim_customer_customer_sk................. [RUN]
2021-06-03 19:19:58.001128 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_customer_customer_sk".
2021-06-03 19:19:58.001128 (Thread-1): Compiling test.adventureworks.not_null_dim_customer_customer_sk
2021-06-03 19:19:58.002125 (Thread-1): unclosed <socket.socket fd=1164, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59754), raddr=('172.217.162.106', 443)>
2021-06-03 19:19:58.003121 (Thread-1): unclosed <socket.socket fd=1176, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59755), raddr=('172.217.162.106', 443)>
2021-06-03 19:19:58.007108 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_customer_customer_sk"
2021-06-03 19:19:58.008151 (Thread-1): finished collecting timing info
2021-06-03 19:19:58.009102 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 19:19:58.015120 (Thread-1): On test.adventureworks.not_null_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
where customer_sk is null



2021-06-03 19:20:00.574662 (Thread-1): finished collecting timing info
2021-06-03 19:20:00.574662 (Thread-1): 16:20:00 | 2 of 17 PASS not_null_dim_customer_customer_sk....................... [PASS in 2.57s]
2021-06-03 19:20:00.574662 (Thread-1): Finished running node test.adventureworks.not_null_dim_customer_customer_sk
2021-06-03 19:20:00.583293 (Thread-1): Began running node test.adventureworks.not_null_dim_localization_address_sk
2021-06-03 19:20:00.583293 (Thread-1): 16:20:00 | 3 of 17 START test not_null_dim_localization_address_sk.............. [RUN]
2021-06-03 19:20:00.584291 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_localization_address_sk".
2021-06-03 19:20:00.584291 (Thread-1): Compiling test.adventureworks.not_null_dim_localization_address_sk
2021-06-03 19:20:00.591287 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_localization_address_sk"
2021-06-03 19:20:00.593261 (Thread-1): finished collecting timing info
2021-06-03 19:20:00.593261 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 19:20:00.597244 (Thread-1): On test.adventureworks.not_null_dim_localization_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_localization_address_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
where address_sk is null



2021-06-03 19:20:02.694303 (Thread-1): finished collecting timing info
2021-06-03 19:20:02.694303 (Thread-1): 16:20:02 | 3 of 17 PASS not_null_dim_localization_address_sk.................... [PASS in 2.11s]
2021-06-03 19:20:02.694303 (Thread-1): Finished running node test.adventureworks.not_null_dim_localization_address_sk
2021-06-03 19:20:02.706233 (Thread-1): Began running node test.adventureworks.not_null_dim_product_product_sk
2021-06-03 19:20:02.706233 (Thread-1): 16:20:02 | 4 of 17 START test not_null_dim_product_product_sk................... [RUN]
2021-06-03 19:20:02.707231 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_product_product_sk".
2021-06-03 19:20:02.708225 (Thread-1): Compiling test.adventureworks.not_null_dim_product_product_sk
2021-06-03 19:20:02.714271 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_product_product_sk"
2021-06-03 19:20:02.715237 (Thread-1): finished collecting timing info
2021-06-03 19:20:02.715237 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 19:20:02.720239 (Thread-1): On test.adventureworks.not_null_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_product`
where product_sk is null



2021-06-03 19:20:05.304541 (Thread-1): finished collecting timing info
2021-06-03 19:20:05.304541 (Thread-1): 16:20:05 | 4 of 17 PASS not_null_dim_product_product_sk......................... [PASS in 2.60s]
2021-06-03 19:20:05.304541 (Thread-1): Finished running node test.adventureworks.not_null_dim_product_product_sk
2021-06-03 19:20:05.309411 (Thread-1): Began running node test.adventureworks.not_null_dim_salesreason_salesreason_sk
2021-06-03 19:20:05.309411 (Thread-1): 16:20:05 | 5 of 17 START test not_null_dim_salesreason_salesreason_sk........... [RUN]
2021-06-03 19:20:05.311404 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_dim_salesreason_salesreason_sk".
2021-06-03 19:20:05.311404 (Thread-1): Compiling test.adventureworks.not_null_dim_salesreason_salesreason_sk
2021-06-03 19:20:05.313397 (Thread-1): unclosed <socket.socket fd=1212, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59760), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:05.313397 (Thread-1): unclosed <socket.socket fd=1316, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59761), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:05.318432 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_dim_salesreason_salesreason_sk"
2021-06-03 19:20:05.320375 (Thread-1): finished collecting timing info
2021-06-03 19:20:05.320375 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 19:20:05.325429 (Thread-1): On test.adventureworks.not_null_dim_salesreason_salesreason_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_dim_salesreason_salesreason_sk"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
where salesreason_sk is null



2021-06-03 19:20:07.377729 (Thread-1): finished collecting timing info
2021-06-03 19:20:07.377729 (Thread-1): 16:20:07 | 5 of 17 PASS not_null_dim_salesreason_salesreason_sk................. [PASS in 2.07s]
2021-06-03 19:20:07.393351 (Thread-1): Finished running node test.adventureworks.not_null_dim_salesreason_salesreason_sk
2021-06-03 19:20:07.393351 (Thread-1): Began running node test.adventureworks.not_null_fact_sales_order_salesorderid
2021-06-03 19:20:07.393351 (Thread-1): 16:20:07 | 6 of 17 START test not_null_fact_sales_order_salesorderid............ [RUN]
2021-06-03 19:20:07.394772 (Thread-1): Acquiring new bigquery connection "test.adventureworks.not_null_fact_sales_order_salesorderid".
2021-06-03 19:20:07.394772 (Thread-1): Compiling test.adventureworks.not_null_fact_sales_order_salesorderid
2021-06-03 19:20:07.399802 (Thread-1): Writing injected SQL for node "test.adventureworks.not_null_fact_sales_order_salesorderid"
2021-06-03 19:20:07.400800 (Thread-1): finished collecting timing info
2021-06-03 19:20:07.400800 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 19:20:07.407775 (Thread-1): On test.adventureworks.not_null_fact_sales_order_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.not_null_fact_sales_order_salesorderid"} */

    
    



select count(*) as validation_errors
from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
where salesorderid is null



2021-06-03 19:20:07.412730 (Thread-1): unclosed <socket.socket fd=1216, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59756), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:07.413766 (Thread-1): unclosed <socket.socket fd=1220, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59757), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:07.414773 (Thread-1): unclosed <socket.socket fd=1256, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59759), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:07.415773 (Thread-1): unclosed <socket.socket fd=1260, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59758), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:07.417696 (Thread-1): unclosed <socket.socket fd=1304, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59762), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:07.418693 (Thread-1): unclosed <socket.socket fd=744, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59763), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:09.483330 (Thread-1): finished collecting timing info
2021-06-03 19:20:09.498816 (Thread-1): 16:20:09 | 6 of 17 PASS not_null_fact_sales_order_salesorderid.................. [PASS in 2.10s]
2021-06-03 19:20:09.498816 (Thread-1): Finished running node test.adventureworks.not_null_fact_sales_order_salesorderid
2021-06-03 19:20:09.501082 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_
2021-06-03 19:20:09.501082 (Thread-1): 16:20:09 | 7 of 17 START test relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_ [RUN]
2021-06-03 19:20:09.502119 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_".
2021-06-03 19:20:09.503116 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_
2021-06-03 19:20:09.512088 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_"
2021-06-03 19:20:09.513087 (Thread-1): finished collecting timing info
2021-06-03 19:20:09.513087 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 19:20:09.520064 (Thread-1): On test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_"} */

    
    




select count(*) as validation_errors
from (
    select address_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select address_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 19:20:13.077613 (Thread-1): finished collecting timing info
2021-06-03 19:20:13.093054 (Thread-1): 16:20:13 | 7 of 17 PASS relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_ [PASS in 3.59s]
2021-06-03 19:20:13.093054 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_address_fk__address_sk__ref_dim_localization_
2021-06-03 19:20:13.095372 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-06-03 19:20:13.095372 (Thread-1): 16:20:13 | 8 of 17 START test relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [RUN]
2021-06-03 19:20:13.096418 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_".
2021-06-03 19:20:13.097368 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-06-03 19:20:13.104384 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_"
2021-06-03 19:20:13.105389 (Thread-1): finished collecting timing info
2021-06-03 19:20:13.105389 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 19:20:13.110363 (Thread-1): On test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_"} */

    
    




select count(*) as validation_errors
from (
    select creditcard_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select creditcard_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 19:20:15.798656 (Thread-1): finished collecting timing info
2021-06-03 19:20:15.798656 (Thread-1): 16:20:15 | 8 of 17 PASS relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [PASS in 2.70s]
2021-06-03 19:20:15.798656 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-06-03 19:20:15.811065 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_
2021-06-03 19:20:15.811065 (Thread-1): 16:20:15 | 9 of 17 START test relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_ [RUN]
2021-06-03 19:20:15.812065 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_".
2021-06-03 19:20:15.812065 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_
2021-06-03 19:20:15.814097 (Thread-1): unclosed <socket.socket fd=1324, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59768), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:15.815053 (Thread-1): unclosed <socket.socket fd=480, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59769), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:15.821066 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_"
2021-06-03 19:20:15.822029 (Thread-1): finished collecting timing info
2021-06-03 19:20:15.822029 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 19:20:15.827069 (Thread-1): On test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_"} */

    
    




select count(*) as validation_errors
from (
    select customer_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select customer_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 19:20:19.117319 (Thread-1): finished collecting timing info
2021-06-03 19:20:19.117319 (Thread-1): 16:20:19 | 9 of 17 PASS relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_ [PASS in 3.31s]
2021-06-03 19:20:19.117319 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_customer_fk__customer_sk__ref_dim_customer_
2021-06-03 19:20:19.122161 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_
2021-06-03 19:20:19.122161 (Thread-1): 16:20:19 | 10 of 17 START test relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_ [RUN]
2021-06-03 19:20:19.123159 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_".
2021-06-03 19:20:19.123159 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_
2021-06-03 19:20:19.130133 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_"
2021-06-03 19:20:19.131162 (Thread-1): finished collecting timing info
2021-06-03 19:20:19.131162 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 19:20:19.135116 (Thread-1): On test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_"} */

    
    




select count(*) as validation_errors
from (
    select product_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select product_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_product`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 19:20:21.394089 (Thread-1): finished collecting timing info
2021-06-03 19:20:21.394089 (Thread-1): 16:20:21 | 10 of 17 PASS relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_ [PASS in 2.27s]
2021-06-03 19:20:21.403668 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_product_fk__product_sk__ref_dim_product_
2021-06-03 19:20:21.403668 (Thread-1): Began running node test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_
2021-06-03 19:20:21.404671 (Thread-1): 16:20:21 | 11 of 17 START test relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_ [RUN]
2021-06-03 19:20:21.405667 (Thread-1): Acquiring new bigquery connection "test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_".
2021-06-03 19:20:21.405667 (Thread-1): Compiling test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_
2021-06-03 19:20:21.407659 (Thread-1): unclosed <socket.socket fd=964, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59772), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:21.408656 (Thread-1): unclosed <socket.socket fd=1452, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59773), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:21.415629 (Thread-1): Writing injected SQL for node "test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_"
2021-06-03 19:20:21.416625 (Thread-1): finished collecting timing info
2021-06-03 19:20:21.416625 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 19:20:21.421608 (Thread-1): On test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_"} */

    
    




select count(*) as validation_errors
from (
    select salesreason_fk as id from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order`
) as child
left join (
    select salesreason_sk as id from `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-06-03 19:20:23.484261 (Thread-1): finished collecting timing info
2021-06-03 19:20:23.484261 (Thread-1): 16:20:23 | 11 of 17 PASS relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_ [PASS in 2.08s]
2021-06-03 19:20:23.484261 (Thread-1): Finished running node test.adventureworks.relationships_fact_sales_order_salesreason_fk__salesreason_sk__ref_dim_salesreason_
2021-06-03 19:20:23.491670 (Thread-1): Began running node test.adventureworks.sum_qty_test
2021-06-03 19:20:23.491670 (Thread-1): 16:20:23 | 12 of 17 START test sum_qty_test..................................... [RUN]
2021-06-03 19:20:23.492725 (Thread-1): Acquiring new bigquery connection "test.adventureworks.sum_qty_test".
2021-06-03 19:20:23.493670 (Thread-1): Compiling test.adventureworks.sum_qty_test
2021-06-03 19:20:23.506709 (Thread-1): Writing injected SQL for node "test.adventureworks.sum_qty_test"
2021-06-03 19:20:23.507665 (Thread-1): finished collecting timing info
2021-06-03 19:20:23.508612 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 19:20:23.512646 (Thread-1): On test.adventureworks.sum_qty_test: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.sum_qty_test"} */

with dbt__CTE__INTERNAL_test as (
with 
   validation as (
    select sum(orderqty) as sum_qty
    from `adventureworks-314121`.`dbt_arthur`.`fact_sales_order` 
   )
select * from validation where sum_qty != 274914
)select count(*) from dbt__CTE__INTERNAL_test
2021-06-03 19:20:26.418478 (Thread-1): finished collecting timing info
2021-06-03 19:20:26.418478 (Thread-1): 16:20:26 | 12 of 17 PASS sum_qty_test........................................... [PASS in 2.93s]
2021-06-03 19:20:26.432650 (Thread-1): Finished running node test.adventureworks.sum_qty_test
2021-06-03 19:20:26.432650 (Thread-1): Began running node test.adventureworks.unique_dim_creditcard_creditcard_sk
2021-06-03 19:20:26.433658 (Thread-1): 16:20:26 | 13 of 17 START test unique_dim_creditcard_creditcard_sk.............. [RUN]
2021-06-03 19:20:26.434652 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_creditcard_creditcard_sk".
2021-06-03 19:20:26.434652 (Thread-1): Compiling test.adventureworks.unique_dim_creditcard_creditcard_sk
2021-06-03 19:20:26.443615 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_creditcard_creditcard_sk"
2021-06-03 19:20:26.444612 (Thread-1): finished collecting timing info
2021-06-03 19:20:26.444612 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 19:20:26.450593 (Thread-1): On test.adventureworks.unique_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        creditcard_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_creditcard`
    where creditcard_sk is not null
    group by creditcard_sk
    having count(*) > 1

) validation_errors



2021-06-03 19:20:28.975406 (Thread-1): finished collecting timing info
2021-06-03 19:20:28.975406 (Thread-1): 16:20:28 | 13 of 17 PASS unique_dim_creditcard_creditcard_sk.................... [PASS in 2.54s]
2021-06-03 19:20:28.975406 (Thread-1): Finished running node test.adventureworks.unique_dim_creditcard_creditcard_sk
2021-06-03 19:20:28.983630 (Thread-1): Began running node test.adventureworks.unique_dim_customer_customer_sk
2021-06-03 19:20:28.983630 (Thread-1): 16:20:28 | 14 of 17 START test unique_dim_customer_customer_sk.................. [RUN]
2021-06-03 19:20:28.984625 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_customer_customer_sk".
2021-06-03 19:20:28.984625 (Thread-1): Compiling test.adventureworks.unique_dim_customer_customer_sk
2021-06-03 19:20:28.986625 (Thread-1): unclosed <socket.socket fd=844, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59766), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:28.987623 (Thread-1): unclosed <socket.socket fd=956, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59767), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:28.989611 (Thread-1): unclosed <socket.socket fd=780, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59770), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:28.990621 (Thread-1): unclosed <socket.socket fd=1420, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59771), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:28.991645 (Thread-1): unclosed <socket.socket fd=1388, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59774), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:28.992643 (Thread-1): unclosed <socket.socket fd=1104, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59776), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:28.992643 (Thread-1): unclosed <socket.socket fd=1168, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59778), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:28.992643 (Thread-1): unclosed <socket.socket fd=1468, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 59777), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:28.992643 (Thread-1): unclosed <socket.socket fd=1116, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 65448), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:28.992643 (Thread-1): unclosed <socket.socket fd=1108, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 65449), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:28.995589 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_customer_customer_sk"
2021-06-03 19:20:28.996699 (Thread-1): finished collecting timing info
2021-06-03 19:20:28.997592 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 19:20:29.003510 (Thread-1): On test.adventureworks.unique_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_customer`
    where customer_sk is not null
    group by customer_sk
    having count(*) > 1

) validation_errors



2021-06-03 19:20:31.179612 (Thread-1): finished collecting timing info
2021-06-03 19:20:31.179612 (Thread-1): 16:20:31 | 14 of 17 PASS unique_dim_customer_customer_sk........................ [PASS in 2.20s]
2021-06-03 19:20:31.179612 (Thread-1): Finished running node test.adventureworks.unique_dim_customer_customer_sk
2021-06-03 19:20:31.187559 (Thread-1): Began running node test.adventureworks.unique_dim_localization_address_sk
2021-06-03 19:20:31.187559 (Thread-1): 16:20:31 | 15 of 17 START test unique_dim_localization_address_sk............... [RUN]
2021-06-03 19:20:31.189552 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_localization_address_sk".
2021-06-03 19:20:31.189552 (Thread-1): Compiling test.adventureworks.unique_dim_localization_address_sk
2021-06-03 19:20:31.196550 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_localization_address_sk"
2021-06-03 19:20:31.197547 (Thread-1): finished collecting timing info
2021-06-03 19:20:31.197547 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 19:20:31.202529 (Thread-1): On test.adventureworks.unique_dim_localization_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_localization_address_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        address_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_localization`
    where address_sk is not null
    group by address_sk
    having count(*) > 1

) validation_errors



2021-06-03 19:20:33.239362 (Thread-1): finished collecting timing info
2021-06-03 19:20:33.239362 (Thread-1): 16:20:33 | 15 of 17 PASS unique_dim_localization_address_sk..................... [PASS in 2.05s]
2021-06-03 19:20:33.239362 (Thread-1): Finished running node test.adventureworks.unique_dim_localization_address_sk
2021-06-03 19:20:33.254040 (Thread-1): Began running node test.adventureworks.unique_dim_product_product_sk
2021-06-03 19:20:33.254040 (Thread-1): 16:20:33 | 16 of 17 START test unique_dim_product_product_sk.................... [RUN]
2021-06-03 19:20:33.256033 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_product_product_sk".
2021-06-03 19:20:33.256033 (Thread-1): Compiling test.adventureworks.unique_dim_product_product_sk
2021-06-03 19:20:33.263046 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_product_product_sk"
2021-06-03 19:20:33.264066 (Thread-1): finished collecting timing info
2021-06-03 19:20:33.264066 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 19:20:33.269039 (Thread-1): On test.adventureworks.unique_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        product_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_product`
    where product_sk is not null
    group by product_sk
    having count(*) > 1

) validation_errors



2021-06-03 19:20:35.307121 (Thread-1): finished collecting timing info
2021-06-03 19:20:35.307121 (Thread-1): 16:20:35 | 16 of 17 PASS unique_dim_product_product_sk.......................... [PASS in 2.05s]
2021-06-03 19:20:35.307121 (Thread-1): Finished running node test.adventureworks.unique_dim_product_product_sk
2021-06-03 19:20:35.315598 (Thread-1): Began running node test.adventureworks.unique_dim_salesreason_salesreason_sk
2021-06-03 19:20:35.315598 (Thread-1): 16:20:35 | 17 of 17 START test unique_dim_salesreason_salesreason_sk............ [RUN]
2021-06-03 19:20:35.317591 (Thread-1): Acquiring new bigquery connection "test.adventureworks.unique_dim_salesreason_salesreason_sk".
2021-06-03 19:20:35.317591 (Thread-1): Compiling test.adventureworks.unique_dim_salesreason_salesreason_sk
2021-06-03 19:20:35.318631 (Thread-1): unclosed <socket.socket fd=1624, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 65454), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:35.319628 (Thread-1): unclosed <socket.socket fd=1636, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.104', 65455), raddr=('172.217.162.106', 443)>
2021-06-03 19:20:35.324489 (Thread-1): Writing injected SQL for node "test.adventureworks.unique_dim_salesreason_salesreason_sk"
2021-06-03 19:20:35.325946 (Thread-1): finished collecting timing info
2021-06-03 19:20:35.325946 (Thread-1): Opening a new connection, currently in state closed
2021-06-03 19:20:35.331053 (Thread-1): On test.adventureworks.unique_dim_salesreason_salesreason_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "adventureworks", "target_name": "dev", "node_id": "test.adventureworks.unique_dim_salesreason_salesreason_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        salesreason_sk

    from `adventureworks-314121`.`dbt_arthur`.`dim_salesreason`
    where salesreason_sk is not null
    group by salesreason_sk
    having count(*) > 1

) validation_errors



2021-06-03 19:20:38.282882 (Thread-1): finished collecting timing info
2021-06-03 19:20:38.282882 (Thread-1): 16:20:38 | 17 of 17 PASS unique_dim_salesreason_salesreason_sk.................. [PASS in 2.97s]
2021-06-03 19:20:38.282882 (Thread-1): Finished running node test.adventureworks.unique_dim_salesreason_salesreason_sk
2021-06-03 19:20:38.369835 (MainThread): Acquiring new bigquery connection "master".
2021-06-03 19:20:38.369835 (MainThread): 16:20:38 | 
2021-06-03 19:20:38.371702 (MainThread): 16:20:38 | Finished running 17 tests in 43.52s.
2021-06-03 19:20:38.372215 (MainThread): Connection 'master' was properly closed.
2021-06-03 19:20:38.372944 (MainThread): Connection 'list_adventureworks-314121_dbt_arthur' was properly closed.
2021-06-03 19:20:38.372944 (MainThread): Connection 'test.adventureworks.unique_dim_salesreason_salesreason_sk' was properly closed.
2021-06-03 19:20:38.383536 (MainThread): 
2021-06-03 19:20:38.383536 (MainThread): Completed successfully
2021-06-03 19:20:38.384532 (MainThread): 
Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
2021-06-03 19:20:38.386528 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4B7F1DB08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4B7F1DAC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4B6C0A0C8>]}
2021-06-03 19:20:38.386528 (MainThread): Flushing usage events
